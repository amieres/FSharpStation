(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,_do,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d0;a=self;b=a.FsRoot=a.FsRoot||{};c=b.Library=b.Library||{};d=c.Dict=c.Dict||{};e=c.ResultMessage=c.ResultMessage||{};f=c.ResultMessageHelpers=c.ResultMessageHelpers||{};g=c.Monads=c.Monads||{};h=g.Seq=g.Seq||{};i=g.Option=g.Option||{};j=g.Async=g.Async||{};k=a.WebSharper;l=k&&k.Obj;m=g.Result=g.Result||{};n=m.Builder=m.Builder||{};o=m.Operators=m.Operators||{};p=g.FusionM=g.FusionM||{};q=p.Operators=p.Operators||{};r=p.Builder=p.Builder||{};s=r.Builder=r.Builder||{};t=g.Eff=g.Eff||{};u=t.Eff=t.Eff||{};v=t.Done=t.Done||{};w=u.LambdaT=u.LambdaT||{};x=t.Operators=t.Operators||{};y=t.EffBuilder=t.EffBuilder||{};z=t.Reader=t.Reader||{};A=z.Ask=z.Ask||{};B=t.Rsl=t.Rsl||{};C=B.Fail=B.Fail||{};D=g.FusionAsyncM=g.FusionAsyncM||{};E=D.Operators=D.Operators||{};F=D.Builder=D.Builder||{};G=F.Builder=F.Builder||{};H=g.ResultM=g.ResultM||{};I=H.Builder=H.Builder||{};J=H.Operators=H.Operators||{};K=g.ResultMAutoOpen=g.ResultMAutoOpen||{};L=g.AsyncResult=g.AsyncResult||{};M=g.AsyncResultBuilder=g.AsyncResultBuilder||{};N=g.AsyncResultBuilderP=g.AsyncResultBuilderP||{};O=g.Extensions=g.Extensions||{};P=g.AsyncResultM=g.AsyncResultM||{};Q=P.AsyncResultMBuilder=P.AsyncResultMBuilder||{};R=g.AsyncResultMAutoOpen=g.AsyncResultMAutoOpen||{};S=c.String=c.String||{};T=c.Array=c.Array||{};U=c.ParseO=c.ParseO||{};V=c.MailboxProcessorExt=c.MailboxProcessorExt||{};W=c.Mailbox=c.Mailbox||{};X=W.StateFull=W.StateFull||{};Y=c.Hole=c.Hole||{};Z=c.TreeEff=c.TreeEff||{};_0=Z.Node=Z.Node||{};_1=b.LibraryJS=b.LibraryJS||{};_2=_1.View=_1.View||{};_3=_1.Var=_1.Var||{};_4=_1.ListModel=_1.ListModel||{};_5=_1.LoadFiles=_1.LoadFiles||{};_6=_1.REGEX=_1.REGEX||{};_7=_1.ResizeObserver=_1.ResizeObserver||{};_8=_1.Monaco=_1.Monaco||{};_9=_8.Position=_8.Position||{};_=_8.Range=_8.Range||{};$=_8.Uri=_8.Uri||{};ba=_8.Location=_8.Location||{};bb=_8.FindMatch=_8.FindMatch||{};bc=_8.WordAtPosition=_8.WordAtPosition||{};bd=_8.Model=_8.Model||{};be=_8.MarkDownString=_8.MarkDownString||{};bf=_8.MarkerData=_8.MarkerData||{};bg=_8.CompletionItem=_8.CompletionItem||{};bh=_8.Hover=_8.Hover||{};bi=_8.Editor=_8.Editor||{};bj=_8.MonacoConfig=_8.MonacoConfig||{};bk=b.Library2=b.Library2||{};bl=bk.WebSockets=bk.WebSockets||{};bm=bl.Address=bl.Address||{};bn=bl.BrokerRequest=bl.BrokerRequest||{};bo=bl.MessageType=bl.MessageType||{};bp=bl.BrokerMessage=bl.BrokerMessage||{};bq=bl.Replier=bl.Replier||{};br=bl.MessageGeneric=bl.MessageGeneric||{};bs=bk.FsAutoComplete=bk.FsAutoComplete||{};bt=bs.CommTypes=bs.CommTypes||{};bu=bt.ResponseError=bt.ResponseError||{};bv=bt.Location=bt.Location||{};bw=bt.CompletionResponse=bt.CompletionResponse||{};bx=bt.OverloadDescription=bt.OverloadDescription||{};by=bt.OverloadParameter=bt.OverloadParameter||{};bz=bt.Overload=bt.Overload||{};bA=bt.Parameter=bt.Parameter||{};bB=bt.SignatureData=bt.SignatureData||{};bC=bt.MethodResponse=bt.MethodResponse||{};bD=bt.SymbolUseRange=bt.SymbolUseRange||{};bE=bt.SymbolUseResponse=bt.SymbolUseResponse||{};bF=bt.HelpTextResponse=bt.HelpTextResponse||{};bG=bt.CompilerLocationResponse=bt.CompilerLocationResponse||{};bH=bt.FSharpErrorInfo=bt.FSharpErrorInfo||{};bI=bt.ErrorResponse=bt.ErrorResponse||{};bJ=bt.Colorization=bt.Colorization||{};bK=bt.Declaration=bt.Declaration||{};bL=bt.DeclarationResponse=bt.DeclarationResponse||{};bM=bt.OpenNamespace=bt.OpenNamespace||{};bN=bt.QualifySymbol=bt.QualifySymbol||{};bO=bt.ResolveNamespaceResponse=bt.ResolveNamespaceResponse||{};bP=bt.UnionCaseResponse=bt.UnionCaseResponse||{};bQ=bs.MsgTypes=bs.MsgTypes||{};bR=bQ.ParseRequest=bQ.ParseRequest||{};bS=bQ.DeclarationsRequest=bQ.DeclarationsRequest||{};bT=bQ.CompletionRequest=bQ.CompletionRequest||{};bU=bQ.PositionRequest=bQ.PositionRequest||{};bV=bQ.ProjectRequest=bQ.ProjectRequest||{};bW=bQ.LintRequest=bQ.LintRequest||{};bX=bQ.HelptextRequest=bQ.HelptextRequest||{};bY=bQ.WorkspacePeekRequest=bQ.WorkspacePeekRequest||{};bZ=bs.Calls=bs.Calls||{};b0=b.RuleEditor=b.RuleEditor||{};b1=b0.Templating=b0.Templating||{};b2=b0.CalculationModel=b0.CalculationModel||{};b3=b2.DimType=b2.DimType||{};b4=b2.CubeType=b2.CubeType||{};b5=b2.AttType=b2.AttType||{};b6=b2.ElmType=b2.ElmType||{};b7=b2.ModId=b2.ModId||{};b8=b2.AttId=b2.AttId||{};b9=b2.ElmId=b2.ElmId||{};b_=b2.CubId=b2.CubId||{};b$=b2.DimId=b2.DimId||{};ca=b2.CalId=b2.CalId||{};cb=b2.TotId=b2.TotId||{};cc=b2.ForId=b2.ForId||{};cd=b2.RulId=b2.RulId||{};ce=b2.Attribute=b2.Attribute||{};cf=b2.Element=b2.Element||{};cg=b2.Dimension=b2.Dimension||{};ch=b2.UnaryOp=b2.UnaryOp||{};ci=b2.Operator=b2.Operator||{};cj=b2.ExpressionText=b2.ExpressionText||{};ck=b2.ExpressionNumber=b2.ExpressionNumber||{};cl=b2.ExpressionAny=b2.ExpressionAny||{};cm=b2.Slice=b2.Slice||{};cn=b2.ForType=b2.ForType||{};co=b2.Formula=b2.Formula||{};cp=b2.Calculation=b2.Calculation||{};cq=b2.Total=b2.Total||{};cr=b2.RuleKey=b2.RuleKey||{};cs=b2.Cube=b2.Cube||{};ct=b2.Rule=b2.Rule||{};cu=b2.RuleMsg=b2.RuleMsg||{};cv=b2.Model=b2.Model||{};cw=b2.HelperTypeN=b2.HelperTypeN||{};cx=b2.HelperTypeT=b2.HelperTypeT||{};cy=b2.HelperTypeA=b2.HelperTypeA||{};cz=b2.Model0=b2.Model0||{};cA=b2.ElementModule=b2.ElementModule||{};cB=b2.ElmReferenceModule=b2.ElmReferenceModule||{};cC=b2.SliceModule=b2.SliceModule||{};cD=b2.DimensionModule=b2.DimensionModule||{};cE=b2.CubeModule=b2.CubeModule||{};cF=b2.CalculationModule=b2.CalculationModule||{};cG=b2.TotalModule=b2.TotalModule||{};cH=b2.ModelModule=b2.ModelModule||{};cI=b2.FormulaModule=b2.FormulaModule||{};cJ=b2.RuleModule=b2.RuleModule||{};cK=b2.AttributeModule=b2.AttributeModule||{};cL=b0.Tree=b0.Tree||{};cM=cL.Weight=cL.Weight||{};cN=cL.TreeNode=cL.TreeNode||{};cO=cL.TreeCollection=cL.TreeCollection||{};cP=b0.TreeNode=b0.TreeNode||{};cQ=b0.Monaco=b0.Monaco||{};cR=cQ.HoverProvider=cQ.HoverProvider||{};cS=cQ.CompletionItemProvider=cQ.CompletionItemProvider||{};cT=cQ.DefinitionProvider=cQ.DefinitionProvider||{};cU=b0.Version=b0.Version||{};cV=b0.VersionModule=b0.VersionModule||{};cW=b0.ModelUI=b0.ModelUI||{};cX=b0.MsgModel=b0.MsgModel||{};cY=b0.ModelUIModule=b0.ModelUIModule||{};cZ=b0.Global=b0.Global||{};c0=b0.FSCode=b0.FSCode||{};c1=c0.LocationDet=c0.LocationDet||{};c2=c0.MsgLocation=c0.MsgLocation||{};c3=b0.ParseFS=b0.ParseFS||{};c4=b0.Render=b0.Render||{};c5=b0.DragDrop=b0.DragDrop||{};c6=c5.DragInfo=c5.DragInfo||{};c7=b0.TableDimensions=b0.TableDimensions||{};c8=b0.TableCalculations=b0.TableCalculations||{};c9=b0.MainProgram=b0.MainProgram||{};c_=b0.UpdateModelUI=b0.UpdateModelUI||{};c$=a.StartupCode$RuleEditor$RuleEditor=a.StartupCode$RuleEditor$RuleEditor||{};da=a.RuleEditor_GeneratedPrintf=a.RuleEditor_GeneratedPrintf||{};db=a.RuleEditor_Templates=a.RuleEditor_Templates||{};dc=a.IntelliFactory;dd=dc&&dc.Runtime;de=k&&k.Utils;df=k&&k.Strings;dg=k&&k.Seq;dh=k&&k.List;di=k&&k.Arrays;dj=k&&k.Concurrency;dk=k&&k.Enumerator;dl=k&&k.Result;dm=k&&k.Operators;dn=k&&k.Unchecked;_do=k&&k.Slice;dp=k&&k.Control;dq=dp&&dp.MailboxProcessor;dr=a.console;ds=k&&k.CancellationTokenSource;dt=k&&k.UI;du=dt&&dt.View;dv=dt&&dt.Var;dw=dt&&dt.FromView;dx=dt&&dt.Doc;dy=dt&&dt.Var$1;dz=dt&&dt.AttrProxy;dA=k&&k.Remoting;dB=dA&&dA.AjaxRemotingProvider;dC=a.System;dD=dC&&dC.Guid;dE=k&&k.Collections;dF=dE&&dE.FSharpMap;dG=dE&&dE.FSharpSet;dH=dE&&dE.Set;dI=dE&&dE.Map;dJ=a.Date;dK=dt&&dt.Templating;dL=dK&&dK.Runtime;dM=dL&&dL.Server;dN=dM&&dM.ProviderBuilder;dO=dM&&dM.Handler;dP=dM&&dM.TemplateInstance;dQ=_1&&_1.AppFramework;dR=dQ&&dQ.PlugIn;dS=k&&k.Lazy;dT=_1&&_1.LayoutEngineModule;dU=dt&&dt.AttrModule;dV=k&&k.DateUtil;dW=k&&k.Numeric;dX=dt&&dt.ListModel;dY=dE&&dE.Dictionary;dZ=dt&&dt.Client;d0=dZ&&dZ.Templates;d.add=function(d1,d2,d3){if(d3.ContainsKey(d1))d3.set_Item(d1,d2);else d3.Add(d1,d2);};e=c.ResultMessage=dd.Class({toString:function(){return this.$==1?(function(d1){return function(d2){return d1("Error    : "+de.toSafe(d2));};}(a.id))(this.$0):this.$==2?(function(d1){return function(d2){return d1("Warning  : "+de.toSafe(d2));};}(a.id))(this.$0):this.$==3?this.$0:this.$==4?(function(d1){return function(d2){return d1(a.String(d2));};}(a.id))(this.$0):this.$==5?(((dd.Curried3(function(d1,d2,d3){return d1("Exception: "+de.toSafe(d2)+", "+de.toSafe(d3));}))(a.id))(this.$0))(this.$1):this.$==6?df.concat("\n",dg.map(a.String,dg.filter(function(d1){return d1.$!=0;},this.$0))):"";}},null,e);e.NoMsg=new e({$:0});f.infof=function(d1){return d1(function(d2){return new e({$:3,$0:d2});});};f.warningf=function(d1){return d1(function(d2){return new e({$:2,$0:d2});});};f.errorMsgf=function(d1){return d1(function(d2){return new e({$:1,$0:d2});});};e.summarizedI=function(d1){return e.summarizedF(function(){return[0,0,1];},d1);};e.summarizedW=function(d1){return e.summarizedF(function(){return[0,1,0];},d1);};e.summarized=function(d1){return e.summarizedF(function(){return[1,0,0];},d1);};e.summarizedF=function(d1,d2){return df.concat("\n",dg.filter(function(d3){return""!==d3;},dh.ofArray([a.String(d2),e.summaryF(d1,d2)])));};e.summaryF=function(d1,d2){var d3,d4;d4=e.countF(d1,d2);switch(d4[0]===0?d4[1]===0?0:d4[1]===1?d4[2]===0?0:(d3=d4[1],2):(d3=d4[1],2):d4[0]===1?d4[1]===0?d4[2]===0?0:(d3=d4[0],1):(d3=[d4[0],d4[1]],3):d4[1]===0?(d3=d4[0],1):(d3=[d4[0],d4[1]],3)){case 0:return"";case 1:return(function(d5){return function(d6){return d5("Errors   : "+a.String(d6)+"\n");};}(a.id))(d3);case 2:return(function(d5){return function(d6){return d5("Warnings : "+a.String(d6)+"\n");};}(a.id))(d3);case 3:return(((dd.Curried3(function(d5,d6,d7){return d5("Errors   : "+a.String(d6)+", Warnings: "+a.String(d7)+"\n");}))(a.id))(d3[0]))(d3[1]);}};e.reduceMsgs=function(d1){return dg.fold(e.addMsg,e.NoMsg,d1);};e.addMsg=function(d1,d2){return d1.$==0?d2:d1.$==6?d2.$==0?d1:d2.$==6?new e({$:6,$0:d1.$0.concat(d2.$0)}):new e({$:6,$0:d1.$0.concat([d2])}):d2.$==0?d1:d2.$==6?new e({$:6,$0:[d1].concat(d2.$0)}):new e({$:6,$0:[d1,d2]});};e.countI=function(d1){return e.countF(function(){return[0,0,1];},d1);};e.countW=function(d1){return e.countF(function(){return[0,1,0];},d1);};e.count=function(d1){return e.countF(function(){return[1,0,0];},d1);};e.countF=function(d1,d2){function d3(d4,d5,d6){return function(d7){return[d4+d7[0],d5+d7[1],d6+d7[2]];};}return d2.$==0?[0,0,0]:d2.$==3?[0,0,1]:d2.$==2?[0,1,0]:d2.$==4?d1(d2.$0):d2.$==6?dg.fold(function(d4,d5){return(function(d6){return d3(d6[0],d6[1],d6[2]);}(d4))(d5);},[0,0,0],dg.map(function(d4){return e.countF(d1,d4);},e.exclnoMsg(d2.$0))):[1,0,0];};e.isFatalW=function(d1){return e.isFatalF(function(){return false;},d1);};e.isFatal=function(d1){return e.isFatalF(function(){return true;},d1);};e.isFatalF=function(d1,d2){return d2.$==0?false:d2.$==3?false:d2.$==2?false:d2.$==4?d1(d2.$0):d2.$==6?dg.exists(function(d3){return e.isFatalF(d1,d3);},d2.$0):true;};e.isWarningOrInfoW=function(d1){return e.isWarningOrInfoF(function(){return true;},d1);};e.isWarningOrInfo=function(d1){return e.isWarningOrInfoF(function(){return false;},d1);};e.isWarningOrInfoF=function(d1,d2){return d2.$==2||(d2.$==4?d1(d2.$0):d2.$==6&&dg.forall(function(d3){return e.isWarningOrInfoF(d1,d3)||e.isInfoF(d1,d3);},e.exclnoMsg(d2.$0)));};e.isInfoI=function(d1){return e.isInfoF(function(){return true;},d1);};e.isInfo=function(d1){return e.isInfoF(function(){return false;},d1);};e.isInfoF=function(d1,d2){return d2.$==3||(d2.$==4?d1(d2.$0):d2.$==6&&dg.forall(function(d3){return e.isInfoF(d1,d3);},e.exclnoMsg(d2.$0)));};e.freeMessageI=function(d1){var d2;function d3(d4){return new e({$:3,$0:d4});}return e.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};e.freeMessageW=function(d1){var d2;function d3(d4){return new e({$:2,$0:d4});}return e.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};e.freeMessage=function(d1){var d2;function d3(d4){return new e({$:1,$0:d4});}return e.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};e.freeMessageF=function(d1,d2){return e.bindMessage(d1,d2);};e.bindMessage=function(d1,d2){return d2.$==4?d1(d2.$0):d2.$==1?new e({$:1,$0:d2.$0}):d2.$==3?new e({$:3,$0:d2.$0}):d2.$==2?new e({$:2,$0:d2.$0}):d2.$==5?new e({$:5,$0:d2.$0,$1:d2.$1}):d2.$==6?new e({$:6,$0:di.map(function(d3){return e.bindMessage(d1,d3);},d2.$0)}):e.NoMsg;};e.exclnoMsg=function(d1){function d2(d3){return!d3;}return dg.filter(function(d3){return d2(e.noMsg(d3));},d1);};e.noMsg=function(d1){return d1.$==0;};h.absorbR=function(d1){return dg.choose(function(d2){return d2.$==0?{$:1,$0:d2.$0}:null;},d1);};h.absorbO=function(d1){return dg.choose(a.id,d1);};h.insertR=function(d1){return d1.$==0?dg.map(function(d2){return{$:0,$0:d2};},d1.$0):(h.rtn())(c.Error$1(d1.$0));};h.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:dg.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?(h.rtn())(null):d2.$0;};h.rtn=function(){c$.$cctor();return c$.rtn;};i.absorbR=function(d1){var d2,d3;return d1!=null&&d1.$==1&&(d3=d1.$0,d3.$==0&&(d2=d3.$0,true))?{$:1,$0:d2}:null;};i.insertR=function(d1){var d2;return d1.$==0?(d2=d1.$0,d2==null?null:{$:1,$0:{$:0,$0:d2.$0}}):i.rtn(c.Error$1(d1.$0));};i.sequenceSeq=function(d1){return i.traverseSeq(a.id,d1);};i.traverseSeq=function(d1,d2){var d3;d3=di.foldBack(function(d4,d5){return i.op_GreaterGreaterEquals(d1(d4),function(d6){return i.op_GreaterGreaterEquals(d5,function(d7){return i.rtn(new dh.T({$:1,$0:d6,$1:d7}));});});},di.ofSeq(d2),i.rtn(dh.T.Empty));return d3==null?null:{$:1,$0:d3.$0};};i.op_GreaterGreaterEquals=function(d1,d2){return d1==null?null:d2(d1.$0);};i.bindNone=function(d1,d2){return d2!=null&&d2.$==1?{$:1,$0:d2.$0}:d1();};i.mapNone=function(d1,d2){return d2==null?d1():d2.$0;};i.apply=function(d1,d2){var d3;return d1!=null&&d1.$==1&&(d2!=null&&d2.$==1&&(d3=[d1.$0,d2.$0],true))?{$:1,$0:d3[0](d3[1])}:null;};i.join=function(d1){return d1==null?null:d1.$0;};i.iter=function(d1){function d2(d4){return d4==null?null:{$:1,$0:d1(d4.$0)};}function d3(d4){if(d4==null);}return function(d4){return d3(d2(d4));};};i.rtn=function(d1){return{$:1,$0:d1};};j.insertR=function(d1){function d2(d4){return{$:0,$0:d4};}function d3(d4){return dj.Return(d4);}return d1.$==0?dj.Bind(d1.$0,function(d4){return d3(d2(d4));}):dj.Return(c.Error$1(d1.$0));};j.insertO=function(d1){var d2;function d3(d5){return{$:1,$0:d5};}function d4(d5){return dj.Return(d5);}d2=d1==null?null:{$:1,$0:dj.Bind(d1.$0,function(d5){return d4(d3(d5));})};return d2==null?dj.Return(null):d2.$0;};j.sequenceSeq=function(d1){return j.traverseSeq(a.id,d1);};j.traverseSeq=function(d1,d2){function d3(d4){return dj.Return(d4);}return dj.Bind(di.foldBack(function(d4,d5){return j.op_GreaterGreaterEquals(d1(d4),function(d6){return j.op_GreaterGreaterEquals(d5,function(d7){return dj.Return(new dh.T({$:1,$0:d6,$1:d7}));});});},di.ofSeq(d2),dj.Return(dh.T.Empty)),function(d4){return d3(a.id(d4));});};j.op_GreaterGreaterEquals=function(d1,d2){return dj.Bind(d1,d2);};j.sleepThen=function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.Bind(dj.Sleep(d2),function(){return dj.Return(d1());});});};j.apply=function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.Bind(dj.StartChild(d1,null),function(d4){return dj.Bind(dj.StartChild(d2,null),function(d5){return dj.Bind(d4,function(d6){return dj.Bind(d5,function(d7){return dj.Return(d6(d7));});});});});});};n=m.Builder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},While:function(d1,d2){function d3(d4,d5){return d4()?dl.Bind(function(){return d3(d4,d5);},d5()):m.rtn();}return d3(d1,d2);},Using:function(d1,d2){try{return d2(d1);}finally{d1.Dispose();}},TryFinally:function(d1,d2){try{return d1();}finally{d2();}},TryWith:function(d1,d2){try{return d1();}catch(d3){return d2(d3);}},Run:function(d1){return m.bindP(d1,{$:0,$0:null});},Combine:function(d1,d2){return dl.Bind(d2,d1);},Delay:a.id,Zero:function(){return m.rtn();},Bind:function(d1,d2){return dl.Bind(d2,d1);},ReturnFrom:a.id,Return:function(d1){return m.rtn(d1);}},l,n);n.New=dd.Ctor(function(){l.New.call(this);},n);o.result=function(){c$.$cctor();return c$.result$1;};o.rtn=function(d1){return m.rtn(d1);};o.op_GreaterEqualsGreater=function(d1,d2,d3){return o.op_GreaterGreaterEquals(d1(d3),d2);};o.op_RightShift=function(d1,d2,d3){return o.op_BarGreaterGreater(d1(d3),d2);};o.op_GreaterGreaterEquals=function(d1,d2){return m.bindP(d2,d1);};o.op_BarGreaterGreater=function(d1,d2){return m.mapP(d2,d1);};m.result=function(){c$.$cctor();return c$.result;};m.sequenceSeq=function(d1){return m.traverseSeq(a.id,d1);};m.traverseSeq=function(d1,d2){return dl.Map(a.id,di.foldBack(function(d3,d4){return m.op_GreaterGreaterEquals(d1(d3),function(d5){return m.op_GreaterGreaterEquals(d4,function(d6){return m.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),m.rtn(dh.T.Empty)));};m.op_GreaterGreaterEquals=function(d1,d2){return dl.Bind(d2,d1);};m.absorbO=function(d1,d2){return m.bindP(function(d3){return m.ofOption(d1,d3);},d2);};m.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:dl.Map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?{$:0,$0:null}:d2.$0;};m.ofOption=function(d1,d2){var d3;d3=d2==null?null:{$:1,$0:{$:0,$0:d2.$0}};return d3==null?function(d4){return c.Error$1(d1(d4));}():d3.$0;};m.get=function(d1){return m.defaultWith(function(d2){return dm.FailWith(a.String(d2));},d1);};m.iter=function(d1,d2,d3){m.defaultWith(d1,m.mapP(d2,d3));};m.mapP=function(d1,d2){return m.bindP(function(d3){return m.rtn(d1(d3));},d2);};m.bindP=function(d1,d2){if(d2.$==1)return c.Error$1(d2.$0);else try{return d1(d2.$0);}catch(d3){return c.Error$1(new e({$:5,$0:d3.message,$1:d3.stack}));}};m.failIfFalse=function(d1,d2){return!d2?c.Error$1(d1):{$:0,$0:null};};m.failIfTrue=function(d1,d2){return d2?c.Error$1(d1):{$:0,$0:null};};m.defaultValue=function(d1,d2){return d2.$==1?d1:d2.$0;};m.defaultWith=function(d1,d2){return d2.$==1?d1(d2.$0):d2.$0;};m.toOption=function(d1){return d1.$==0?{$:1,$0:d1.$0}:null;};m.rtn=function(d1){return{$:0,$0:d1};};m.freeMessage=function(d1){return d1.$==1?c.Error$1(e.freeMessage(d1.$0)):{$:0,$0:d1.$0};};q.rtn=function(d1){return p.rtn(d1);};q.op_GreaterEqualsGreater=function(d1,d2,d3){return q.op_GreaterGreaterEquals(d1(d3),d2);};q.op_RightShift=function(d1,d2,d3){return q.op_BarGreaterGreater(d1(d3),d2);};q.op_GreaterGreaterEquals=function(d1,d2){return p.bind(d2,d1);};q.op_BarGreaterGreater=function(d1,d2){return p.map(d2,d1);};q.op_LessMultiplyGreater=function(d1,d2){return p.apply(d1,d2);};s=r.Builder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},Using:function(d1,d2){return this.TryFinally(function(){return d2(d1);},function(){if(!dn.Equals(d1,null))d1.Dispose();});},TryFinally:function(d1,d2){return p.wrap(function(d3){try{return(p.getFun(d1()))(d3);}finally{d2();}});},TryWith:function(d1,d2){return p.wrap(function(d3){try{return(p.getFun(d1()))(d3);}catch(d4){return d2(d4);}});},While:function(d1,d2){function d3(d4,d5){return d4()?p.bind(function(){return d3(d4,d5);},d5()):p.rtn();}return d3(d1,d2);},Run:function(d1){return p.wrap(function(d2){return(p.getFun(d1()))(d2);});},Combine:function(d1,d2){return p.bind(d2,d1);},Delay:a.id,Zero:function(){return p.rtn();},Bind:function(d1,d2){return p.bind(d2,d1);},ReturnFrom:function(d1){return p.from(d1);},Return:function(d1){return p.rtn(d1);}},l,s);s.New=dd.Ctor(function(){l.New.call(this);},s);p.fusion=function(){c$.$cctor();return c$.fusion;};p.absorbO=function(d1,d2){return p.absorbR(p.map(function(d3){return m.ofOption(d1,d3);},d2));};p.absorbR=function(d1){return p.bind(p.ofResultRM,d1);};p.insertSnd=function(d1,d2){return p.map(function(d3){return[d3,d2];},d1);};p.insertFst=function(d1,d2){return p.map(function(d3){return[d1,d3];},d2);};p.insertR=function(d1){return d1.$==0?p.map(function(d2){return{$:0,$0:d2};},d1.$0):p.rtn(c.Error$1(d1.$0));};p.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:p.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?p.rtn(null):d2.$0;};p.iterResultPrint=function(d1){function d2(d3){c.print$1(d3);}p.iterReader(function(d3){return d2(e.summarized(d3));},function(d3){c.print$1(d3);},null,d1);};p.iterResult=function(d1,d2,d3){p.iterReader(d1,d2,null,d3);};p.runResult=function(d1){return p.runReader(null,d1);};p.runReader=function(d1,d2){var d3,d4,d5;d3=p.run(d1,d2);d4=d3[2];return m.ofOption(function(){return d4;},(d5=d3[0],d5==null?null:{$:1,$0:[d5.$0,d4]}));};p.mapReader=function(d1,d2){return p.mapState(function(){return d1;},a.id,d2);};p.readerFun=function(d1){return p.map(d1,p.getS());};p.sequenceSeq=function(d1){return p.traverseSeq(a.id,d1);};p.traverseSeq=function(d1,d2){return p.map(a.id,di.foldBack(function(d3,d4){return p.op_GreaterGreaterEquals(d1(d3),function(d5){return p.op_GreaterGreaterEquals(d4,function(d6){return p.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),p.rtn(dh.T.Empty)));};p.op_GreaterGreaterEquals=function(d1,d2){return p.bind(d2,d1);};p.apply=function(d1,d2){return p.bind(function(d3){return p.map(d3,d2);},d1);};p.memoizeRm=function(d1,d2,d3){return{$:0,$0:function(d4){var d5,d6,d7,d8,d9;function d_(d$,ea){return(d7(d$))(function(){return ea;});}d5=d4[0];d6=d1(d5);d7=d6[1];return p.run(d5,(d8=(d9=d6[0](d3),d9==null?null:{$:1,$0:p.rtn(d9.$0)}),d8==null?p.map(function(d$){return d_(d3,d$);},d2(d3)):d8.$0));}};};p.iterReader=function(d1,d2,d3,d4){var d5,d6;d5=p.run(d3,p.map(d2,d4));d6=d5[2];(i.iter(a.ignore))(d5[0]);d6.$!==0?d1(d6):void 0;};p.mapState=function(d1,d2,d3){return{$:0,$0:function(d4){var d5,d6;d5=d4[0];d6=(p.getFun(d3))([d1(d5),d4[1]]);return[d6[0],d2(d5,d6[1]),d6[2]];}};};p.freeMessageW=function(d1){var d2;function d3(d4){return new e({$:2,$0:d4});}return p.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};p.freeMessage=function(d1){var d2;function d3(d4){return new e({$:1,$0:d4});}return p.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};p.freeMessageF=function(d1,d2){return{$:0,$0:function(d3){var d4,d5,d6;d4=d3[0];d5=d3[1];try{d6=d2.$0([d4,e.freeMessage(d5)]);return[d6[0],d6[1],e.freeMessageF(d1,d6[2])];}catch(d7){return[null,d4,e.freeMessage(e.addMsg(d5,new e({$:5,$0:d7.message,$1:d7.stack})))];}}};};p.ofFusionM=function(d1){return p.from(d1);};p.ofResultMessage=function(d1){return p.OkFMsg(null,d1);};p.ofMessage=function(d1){return p.OkFMsg(null,new e({$:4,$0:d1}));};p.ofOption=function(d1,d2){return d2==null?p.ErrorF(d1()):p.OkF(d2.$0);};p.ofResult=function(d1){return d1.$==1?p.ErrorF(new e({$:1,$0:(function(d2){return function(d3){return d2(de.prettyPrint(d3));};}(a.id))(d1.$0)})):p.OkF(d1.$0);};p.ofResultS=function(d1){return d1.$==1?p.ErrorF(new e({$:1,$0:d1.$0})):p.OkF(d1.$0);};p.ofResultM=function(d1){return d1.$==1?p.ErrorF(new e({$:4,$0:d1.$0})):p.OkF(d1.$0);};p.ofResultRM=function(d1){return d1.$==1?p.ErrorF(d1.$0):p.OkF(d1.$0);};p.inling=function(d1,d2){return{$:0,$0:function(d3){var d4,d5,d6;d4=d3[0];d5=d3[1];try{d6=d2.$0([d4,d5]);return[{$:1,$0:d6[0]},d6[1],d6[2]];}catch(d7){return[null,d4,e.addMsg(d5,new e({$:5,$0:d7.message,$1:d7.stack}))];}}};};p.check=function(){return{$:0,$0:function(d1){return[e.isFatal(d1[1])?null:{$:1,$0:null},d1[0],e.NoMsg];}};};p.putS=function(d1){return{$:0,$0:function(){return[{$:1,$0:null},d1,e.NoMsg];}};};p.getR=function(){return{$:0,$0:function(d1){return[{$:1,$0:d1[1]},d1[0],e.NoMsg];}};};p.getS=function(){return{$:0,$0:function(d1){var d2;d2=d1[0];return[{$:1,$0:d2},d2,e.NoMsg];}};};p.ErrorF=function(d1){return{$:0,$0:function(d2){return[null,d2[0],d1];}};};p.OkFMsg=function(d1,d2){return{$:0,$0:function(d3){return[{$:1,$0:d1},d3[0],d2];}};};p.OkF=function(d1){return{$:0,$0:function(d2){return[{$:1,$0:d1},d2[0],e.NoMsg];}};};p.run=function(d1,d2){return(p.getFun(d2))([d1,e.NoMsg]);};p.from=a.id;p.getFun=function(d1){return d1.$0;};p.wrap=function(d1){return{$:0,$0:d1};};p.map=function(d1,d2){return p.bind(function(d3){return p.rtn(d1(d3));},d2);};p.bind=function(d1,d2){return{$:0,$0:function(d3){var d4,d5,d6,d7,d8,d9,d_;d4=d3[0];d5=d3[1];try{d6=d2.$0([d4,d5]);d7=d6[0];d8=d6[1];d9=d6[2];return d7!=null&&d7.$==1?(d_=d1(d7.$0).$0([d8,e.addMsg(d5,d9)]),[d_[0],d_[1],e.addMsg(d9,d_[2])]):[null,d8,d9];}catch(d$){return[null,d4,e.addMsg(d5,new e({$:5,$0:d$.message,$1:d$.stack}))];}}};};p.rtn=function(d1){return{$:0,$0:function(d2){return[{$:1,$0:d1},d2[0],e.NoMsg];}};};u=t.Eff=dd.Class({get_Cont:function(){return this.$0;}},null,u);v=t.Done=dd.Class({get_Value:function(){return this.v;},FsRoot_Library_Monads_Eff_Effect$UnPack:function(d1){return this;}},l,v);v.New=dd.Ctor(function(d1){l.New.call(this);this.v=d1;},v);w=u.LambdaT=dd.Class({FsRoot_Library_Monads_Eff_Lambda$Invoke:function(d1){var d2;d2=this.loop;return function(d3){return d2(d1(d3));};}},l,w);w.New=dd.Ctor(function(d1){l.New.call(this);this.loop=d1;},w);u.runResult=function(d1){var d2;try{d2=(d1.get_Cont())(u["done'"]);return d2 instanceof v?{$:0,$0:d2.get_Value()}:c.Error$1((f.errorMsgf(function(d3){return function(d4){return d3("Unhandled effect "+de.prettyPrint(d4)+" expecting");};}))(d2));}catch(d3){return c.Error$1(new e({$:5,$0:d3.message,$1:d3.stack}));}};u.run=function(d1){var d2;d2=(d1.get_Cont())(u["done'"]);return d2 instanceof v?d2.get_Value():(function(d3){return function(d4){return d3("Unhandled effect "+de.prettyPrint(d4));};}(dm.FailWith))(d2);};u["return'"]=function(d1){return new u({$:0,$0:function(){return u["done'"](d1);}});};u["done'"]=function(d1){return new v.New(d1);};u.unpack=function(d1,d2){return d2.FsRoot_Library_Monads_Eff_Effect$UnPack(new w.New(d1));};x.rtn=function(d1){return t.rtn(d1);};x.op_GreaterEqualsGreater=function(d1,d2,d3){return x.op_GreaterGreaterEquals(d1(d3),d2);};x.op_RightShift=function(d1,d2,d3){return x.op_BarGreaterGreater(d1(d3),d2);};x.op_GreaterGreaterEquals=function(d1,d2){return t.bind(d2,d1);};x.op_BarGreaterGreater=function(d1,d2){return t.map(d2,d1);};x.op_LessMultiplyGreater=function(d1,d2){return t.apply(d1,d2);};y=t.EffBuilder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},function(){return d3.Delay(function(){return d2(d4.Current());});});});},Using:function(d1,d2){return this.TryFinally(function(){return d2(d1);},function(){if(!dn.Equals(d1,null))d1.Dispose();});},TryFinally:function(d1,d2){return new u({$:0,$0:function(d3){try{return d1().$0(d3);}finally{d2();}}});},TryWith:function(d1,d2){return new u({$:0,$0:function(d3){try{return d1().$0(d3);}catch(d4){return d2(d4).$0(d3);}}});},While:function(d1,d2){function d3(d4,d5){return d4()?t.bind(function(){return d3(d4,d5);},d5()):x.rtn();}return d3(d1,d2);},Delay:function(d1){return new u({$:0,$0:function(d2){return d1().$0(d2);}});},Combine:function(d1,d2){return this.Bind(d1,function(){return d2;});},Bind:function(d1,d2){return t.bind(d2,d1);},ReturnFrom:a.id,Return:function(d1){return x.rtn(d1);},Zero:function(){return x.rtn();}},l,y);y.New=dd.Ctor(function(){l.New.call(this);},y);A=z.Ask=dd.Class({get_K:function(){return this.k;},FsRoot_Library_Monads_Eff_Effect$UnPack:function(d1){return new A.New(d1.FsRoot_Library_Monads_Eff_Lambda$Invoke(this.k));}},l,A);A.New=dd.Ctor(function(d1){l.New.call(this);this.k=d1;},A);z.readerFun=function(d1){return t.map(d1,z.ask());};z.readerHandler=function(d1,d2){function d3(d4){return d4 instanceof A?d3((d4.get_K())(d1)):u.unpack(d3,d4);}return new u({$:0,$0:function(){return d3((d2.get_Cont())(u["done'"]));}});};z.ask=function(){return new u({$:0,$0:function(d1){return new A.New(d1);}});};C=B.Fail=dd.Class({get_K:function(){return this.k;},get_Value:function(){return this.v;},FsRoot_Library_Monads_Eff_Effect$UnPack:function(d1){return new C.New(this.v,d1.FsRoot_Library_Monads_Eff_Lambda$Invoke(this.k));}},l,C);C.New=dd.Ctor(function(d1,d2){l.New.call(this);this.v=d1;this.k=d2;},C);B.absorbO=function(d1,d2){return B.absorbR(t.map(function(d3){return m.ofOption(d1,d3);},d2));};B.absorbR=function(d1){return t.bind(B.ofResult,d1);};B.RslHandler=function(d1){function d2(d3,d4){return d4 instanceof v?d3({$:0,$0:d4.get_Value()}):d4 instanceof C?d3(c.Error$1(d4.get_Value())):u.unpack(function(d5){return d2(d3,d5);},d4);}return new u({$:0,$0:function(d3){return d2(d3,(d1.get_Cont())(u["done'"]));}});};B.ofResult=function(d1){var d2;d2=t.eff();return d2.Delay(function(){return d1.$==1?d2.Bind(B.fail(d1.$0),function(){return d2.Return(null);}):d2.Return(d1.$0);});};B.fail=function(d1){return new u({$:0,$0:function(d2){return new C.New(d1,d2);}});};t.eff=function(){c$.$cctor();return c$.eff;};t.insertSnd=function(d1,d2){return t.map(function(d3){return[d3,d2];},d1);};t.insertFst=function(d1,d2){return t.map(function(d3){return[d1,d3];},d2);};t.insertR=function(d1){return d1.$==0?t.map(function(d2){return{$:0,$0:d2};},d1.$0):x.rtn(c.Error$1(d1.$0));};t.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:t.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?x.rtn(null):d2.$0;};t.sequenceSeq=function(d1){return t.traverseSeq(a.id,d1);};t.traverseSeq=function(d1,d2){return t.map(a.id,di.foldBack(function(d3,d4){return x.op_GreaterGreaterEquals(d1(d3),function(d5){return x.op_GreaterGreaterEquals(d4,function(d6){return x.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),x.rtn(dh.T.Empty)));};t.apply=function(d1,d2){return t.bind(function(d3){return t.map(d3,d2);},d1);};t.map=function(d1,d2){return t.bind(function(d3){return t.rtn(d1(d3));},d2);};t.bind=function(d1,d2){return new u({$:0,$0:function(d3){return d2.$0(function(d4){return d1(d4).$0(d3);});}});};t.rtn=function(d1){return new u({$:0,$0:function(d2){return d2(d1);}});};E.rtn=function(d1){return D.rtn(d1);};E.op_GreaterEqualsGreater=function(d1,d2,d3){return E.op_GreaterGreaterEquals(d1(d3),d2);};E.op_RightShift=function(d1,d2,d3){return E.op_BarGreaterGreater(d1(d3),d2);};E.op_GreaterGreaterEquals=function(d1,d2){return D.bind(d2,d1);};E.op_BarGreaterGreater=function(d1,d2){return D.map(d2,d1);};E.op_LessMultiplyGreater=function(d1,d2){return D.apply(d1,d2);};G=F.Builder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},Using:function(d1,d2){function d3(d4,d5){return dj.Using(d1,function(d6){return(D.getFun(d2(d6)))([d4,d5]);});}return D.wrap(function(d4){return d3(d4[0],d4[1]);});},TryFinally:function(d1,d2){function d3(d4,d5){return dj.TryFinally((D.getFun(d1()))([d4,d5]),d2);}return D.wrap(function(d4){return d3(d4[0],d4[1]);});},TryWith:function(d1,d2){function d3(d4,d5){return dj.TryWith((D.getFun(d1()))([d4,d5]),d2);}return D.wrap(function(d4){return d3(d4[0],d4[1]);});},While:function(d1,d2){function d3(d4,d5){return d4()?D.bind(function(){return d3(d4,d5);},d5()):D.rtn();}return d3(d1,d2);},Run:function(d1){return D.wrap(function(d2){return(D.getFun(d1()))(d2);});},Combine:function(d1,d2){return D.bind(d2,d1);},Delay:a.id,Zero:function(){return D.rtn();},Bind:function(d1,d2){return D.bind(d2,d1);},ReturnFrom:function(d1){return D.from(d1);},Return:function(d1){return D.rtn(d1);}},l,G);G.New=dd.Ctor(function(){l.New.call(this);},G);D.fusion=function(){c$.$cctor();return c$.fusion$1;};D.iterResultPrintA=function(d1){function d2(d3){c.print$1(d3);}D.iterReaderA(function(d3){return d2(e.summarized(d3));},function(d3){c.print$1(d3);},null,d1);};D.iterResultPrint=function(d1){function d2(d3){c.print$1(d3);}D.iterReader(function(d3){return d2(e.summarized(d3));},function(d3){c.print$1(d3);},null,d1);};D.iterResultA=function(d1,d2,d3){D.iterReaderA(d1,d2,null,d3);};D.iterResult=function(d1,d2,d3){D.iterReader(d1,d2,null,d3);};D.runResult=function(d1){return D.runReader(null,d1);};D.runReader=function(d1,d2){function d3(d5,d6,d7){return m.ofOption(function(){return d7;},d5==null?null:{$:1,$0:[d5.$0,d7]});}function d4(d5){return dj.Return(d5);}return dj.Bind(D.run(d1,d2),function(d5){return d4(d3.apply(null,d5));});};D.mapReader=function(d1,d2){return D.mapState(function(){return d1;},a.id,d2);};D.absorbO=function(d1,d2){return D.absorbR(D.map(function(d3){return m.ofOption(d1,d3);},d2));};D.absorbR=function(d1){return D.bind(D.ofResultRM,d1);};D.insertSnd=function(d1,d2){return D.map(function(d3){return[d3,d2];},d1);};D.insertFst=function(d1,d2){return D.map(function(d3){return[d1,d3];},d2);};D.insertR=function(d1){return d1.$==0?D.map(function(d2){return{$:0,$0:d2};},d1.$0):D.rtn(c.Error$1(d1.$0));};D.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:D.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?D.rtn(null):d2.$0;};D.readerFun=function(d1){return D.map(d1,D.getS());};D.freeMessageW=function(d1){var d2;function d3(d4){return new e({$:2,$0:d4});}return D.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};D.freeMessage=function(d1){var d2;function d3(d4){return new e({$:1,$0:d4});}return D.freeMessageF((d2=function(d4){return function(d5){return d4(a.String(d5));};}(a.id),function(d4){return d3(d2(d4));}),d1);};D.sequenceSeq=function(d1){return D.traverseSeq(a.id,d1);};D.traverseSeq=function(d1,d2){return D.map(a.id,di.foldBack(function(d3,d4){return D.op_GreaterGreaterEquals(d1(d3),function(d5){return D.op_GreaterGreaterEquals(d4,function(d6){return D.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),D.rtn(dh.T.Empty)));};D.op_GreaterGreaterEquals=function(d1,d2){return D.bind(d2,d1);};D.apply=function(d1,d2){return D.bind(function(d3){return D.map(d3,d2);},d1);};D.memoizeRm=function(d1,d2,d3){return{$:0,$0:function(d4){var d5,d6;d5=d4[0];d6=null;return dj.Delay(function(){var d7,d8,d9,d_;function d$(ea,eb){return(d8(ea))(function(){return eb;});}d7=d1(d5);d8=d7[1];return D.run(d5,(d9=(d_=d7[0](d3),d_==null?null:{$:1,$0:D.rtn(d_.$0)}),d9==null?D.map(function(ea){return d$(d3,ea);},d2(d3)):d9.$0));});}};};D.iterReaderA=function(d1,d2,d3,d4){function d5(d7,d8,d9){(i.iter(a.ignore))(d7);d9.$!==0?d1(d9):void 0;}function d6(d7){return dj.Return(d7);}dj.Start(dj.Bind(D.run(d3,D.map(d2,d4)),function(d7){return d6(d5.apply(null,d7));}),null);};D.iterReader=function(d1,d2,d3,d4){var d5;d5=D.run(d3,D.map(d2,d4));throw"iterS cannot be used in JavaScript!";};D.mapState=function(d1,d2,d3){return{$:0,$0:function(d4){var d5,d6,d7;d5=d4[0];d6=d4[1];d7=null;return dj.Delay(function(){return dj.Bind((D.getFun(d3))([d1(d5),d6]),function(d8){return dj.Return([d8[0],d2(d5,d8[1]),d8[2]]);});});}};};D.freeMessageF=function(d1,d2){return{$:0,$0:function(d3){var d4,d5,d6;d4=d3[0];d5=d3[1];d6=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d2.$0([d4,e.freeMessage(d5)]),function(d7){return dj.Return([d7[0],d7[1],e.freeMessageF(d1,d7[2])]);});}),function(d7){return dj.Return([null,d4,e.freeMessage(e.addMsg(d5,new e({$:5,$0:d7.message,$1:d7.stack})))]);});});}};};D.ofFusionM=function(d1){var d2;d2=d1.$0;return{$:0,$0:function(d3){return dj.Return(d2([d3[0],d3[1]]));}};};D.ofAsyncResultRM=function(d1){return D.bind(D.ofResultRM,D.ofAsync(d1));};D.ofAsync=function(d1){return{$:0,$0:function(d2){var d3;function d4(d6){return[{$:1,$0:d6},d3,e.NoMsg];}function d5(d6){return dj.Return(d6);}d3=d2[0];return dj.Bind(d1,function(d6){return d5(d4(d6));});}};};D.ofResultMessage=function(d1){return D.OkFMsg(null,d1);};D.ofMessage=function(d1){return D.OkFMsg(null,new e({$:4,$0:d1}));};D.ofOption=function(d1,d2){var d3;d3=d2==null?null:{$:1,$0:D.OkF(d2.$0)};return d3==null?function(d4){return D.ErrorF(d1(d4));}():d3.$0;};D.ofResult=function(d1){return d1.$==1?D.ErrorF(new e({$:1,$0:(function(d2){return function(d3){return d2(de.prettyPrint(d3));};}(a.id))(d1.$0)})):D.OkF(d1.$0);};D.ofResultS=function(d1){return d1.$==1?D.ErrorF(new e({$:1,$0:d1.$0})):D.OkF(d1.$0);};D.ofResultM=function(d1){return d1.$==1?D.ErrorF(new e({$:4,$0:d1.$0})):D.OkF(d1.$0);};D.ofResultRM=function(d1){return d1.$==1?D.ErrorF(d1.$0):D.OkF(d1.$0);};D.getOption=function(d1){return{$:0,$0:function(d2){var d3,d4,d5;d3=d2[0];d4=d2[1];d5=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d1.$0([d3,d4]),function(d6){return dj.Return([{$:1,$0:d6[0]},d6[1],d6[2]]);});}),function(d6){return dj.Return([null,d3,e.addMsg(d4,new e({$:5,$0:d6.message,$1:d6.stack}))]);});});}};};D.check=function(){return{$:0,$0:function(d1){return dj.Return([e.isFatal(d1[1])?null:{$:1,$0:null},d1[0],e.NoMsg]);}};};D.putS=function(d1){return{$:0,$0:function(){return dj.Return([{$:1,$0:null},d1,e.NoMsg]);}};};D.getR=function(){return{$:0,$0:function(d1){return dj.Return([{$:1,$0:d1[1]},d1[0],e.NoMsg]);}};};D.getS=function(){return{$:0,$0:function(d1){var d2;d2=d1[0];return dj.Return([{$:1,$0:d2},d2,e.NoMsg]);}};};D.ErrorF=function(d1){return{$:0,$0:function(d2){return dj.Return([null,d2[0],d1]);}};};D.OkFMsg=function(d1,d2){return{$:0,$0:function(d3){return dj.Return([{$:1,$0:d1},d3[0],d2]);}};};D.OkF=function(d1){return{$:0,$0:function(d2){return dj.Return([{$:1,$0:d1},d2[0],e.NoMsg]);}};};D.run=function(d1,d2){return(D.getFun(d2))([d1,e.NoMsg]);};D.from=a.id;D.getFun=function(d1){return d1.$0;};D.wrap=function(d1){return{$:0,$0:d1};};D.map=function(d1,d2){return D.bind(function(d3){return D.rtn(d1(d3));},d2);};D.bind=function(d1,d2){return{$:0,$0:function(d3){var d4,d5,d6;d4=d3[0];d5=d3[1];d6=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d2.$0([d4,d5]),function(d7){var d8,d9,d_;d8=d7[0];d9=d7[1];d_=d7[2];return d8!=null&&d8.$==1?dj.Bind(d1(d8.$0).$0([d9,e.addMsg(d5,d_)]),function(d$){return dj.Return([d$[0],d$[1],e.addMsg(d_,d$[2])]);}):dj.Return([null,d9,d_]);});}),function(d7){return dj.Return([null,d4,e.addMsg(d5,new e({$:5,$0:d7.message,$1:d7.stack}))]);});});}};};D.rtn=function(d1){return{$:0,$0:function(d2){return dj.Return([{$:1,$0:d1},d2[0],e.NoMsg]);}};};I=H.Builder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},While:function(d1,d2){function d3(d4,d5){return d4()?H.bind(function(){return d3(d4,d5);},d5()):H.rtn();}return d3(d1,d2);},Using:function(d1,d2){try{return d2(d1);}finally{d1.Dispose();}},TryFinally:function(d1,d2){try{return d1();}finally{d2();}},TryWith:function(d1,d2){try{return d1();}catch(d3){return d2(d3);}},Run:function(d1){return H.bindP(d1,g.OkM$1());},Combine:function(d1,d2){return H.bind(d2,d1);},Delay:a.id,Zero:function(){return H.rtn();},Bind:function(d1,d2){return H.bindM(d2,d1);},Bind$1:function(d1,d2){return H.bindP(d2,d1);},ReturnFrom:function(d1){return H.rtnM(d1);},ReturnFrom$1:a.id,Return:function(d1){return H.rtn(d1);}},l,I);I.New=dd.Ctor(function(){l.New.call(this);},I);J.rtn=function(d1){return H.rtn(d1);};J.op_GreaterEqualsGreater=function(d1,d2,d3){return J.op_GreaterGreaterEquals(d1(d3),d2);};J.op_RightShift=function(d1,d2,d3){return J.op_BarGreaterGreater(d1(d3),d2);};J.op_GreaterGreaterEquals=function(d1,d2){return H.bindP(d2,d1);};J.op_BarGreaterGreater=function(d1,d2){return H.mapP(d2,d1);};H.sequenceSeq=function(d1){return H.traverseSeq(a.id,d1);};H.traverseSeq=function(d1,d2){return H.map(a.id,di.foldBack(function(d3,d4){return H.op_GreaterGreaterEquals(d1(d3),function(d5){return H.op_GreaterGreaterEquals(d4,function(d6){return H.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),H.rtn(dh.T.Empty)));};H.op_GreaterGreaterEquals=function(d1,d2){return H.bind(d2,d1);};H.failIfFatalMsgW=function(d1){var d2;d2=g.OkM(d1);return d2.$==0?e.isFatalW(d2.$0[1])?g.ErrorM(d2.$0[1]):d1:d1;};H.failIfFatalMsg=function(d1){var d2;d2=g.OkM(d1);return d2.$==0?e.isFatal(d2.$0[1])?g.ErrorM(d2.$0[1]):d1:d1;};H.failIfFatalMsgF=function(d1,d2){var d3;d3=g.OkM(d2);return d3.$==0?e.isFatalF(d1,d3.$0[1])?g.ErrorM(d3.$0[1]):d2:d2;};H.addMsg=function(d1,d2){return H.mapMessage(function(d3){return e.addMsg(d1,d3);},d2);};H.absorbO=function(d1,d2){return H.bindP(function(d3){return H.ofOption(d1,d3);},d2);};H.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:H.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?g.OkM$1(null):d2.$0;};H.ofResult=function(d1){return H.rtnr(d1);};H.ofOption=function(d1,d2){var d3;d3=d2==null?null:{$:1,$0:g.OkM$1(d2.$0)};return d3==null?function(d4){return g.ErrorM(d1(d4));}():d3.$0;};H.get=function(d1){return H.defaultWith(function(d2){return dm.FailWith(a.String(d2));},d1);};H.iter=function(d1,d2,d3){var d4,d5;d4=H.mapP(d2,d3);d4.$0==null?d5=d4.$1:d5=d4.$1;d1(d5);};H.mapP=function(d1,d2){return H.bindP(function(d3){return H.rtn(d1(d3));},d2);};H.check=function(d1,d2){var d3;return(d3=d2.$0,d3!=null&&d3.$==1)?e.isFatalF(d1.$0,d2.$1)?g.ErrorM(d2.$1):d2:d2;};H.bindM=function(d1,d2){return H.bindP(d1,H.rtnM(d2));};H.bindP=function(d1,d2){var d3;if(d2.$0==null)return{$:0,$0:null,$1:d2.$1};else{d3=d2.$1;try{return H.mapMessage(function(d4){return e.addMsg(d3,d4);},d1(d2.$0.$0));}catch(d4){return g.ErrorM(new e({$:5,$0:d4.message,$1:d4.stack}));}}};H.bind=function(d1,d2){var d3;return d2.$0==null?{$:0,$0:null,$1:d2.$1}:(d3=d2.$1,H.mapMessage(function(d4){return e.addMsg(d3,d4);},d1(d2.$0.$0)));};H.mapMessage=function(d1,d2){return{$:0,$0:d2.$0,$1:d1(d2.$1)};};H.map=function(d1,d2){var d3;return{$:0,$0:(d3=d2.$0,d3==null?null:{$:1,$0:d1(d3.$0)}),$1:d2.$1};};H.defaultValue=function(d1,d2){return m.defaultValue(d1,H.toResult(d2));};H.defaultWith=function(d1,d2){return m.defaultWith(d1,H.toResult(d2));};H.toOption=function(d1){return d1.$0;};H.toResultD=function(d1){return d1.$0==null?c.Error$1(d1.$1):{$:0,$0:[d1.$0.$0,d1.$1]};};H.toResult=function(d1){return d1.$0==null?c.Error$1(d1.$1):{$:0,$0:d1.$0.$0};};H.freeMessage=function(d1){return d1.$==1?c.Error$1(e.freeMessage(d1.$0)):{$:0,$0:d1.$0};};H.rtnr=function(d1){return m.defaultWith(g.ErrorM,dl.Map(g.OkM$1,d1));};H.rtnM=function(d1){return g.OkMWithMsg(null,d1);};H.rtn=function(d1){return g.OkM$1(d1);};H.checkErrorW=function(){return{$:0,$0:function(){return false;}};};H.checkError=function(){return{$:0,$0:function(){return true;}};};K.resultM=function(){c$.$cctor();return c$.resultM;};L.absorbO=function(d1,d2){function d3(d5){return m.absorbO(d1,d5);}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};L.absorbR=function(d1){var d2;function d3(d4){return dj.Return(d4);}return dj.Bind(d1,(d2=function(d4){return m.bindP(a.id,d4);},function(d4){return d3(d2(d4));}));};L.insertR=function(d1){return d1.$==0?L.map(function(d2){return{$:0,$0:d2};},d1.$0):L.rtn(c.Error$1(d1.$0));};L.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:L.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?L.rtn(null):d2.$0;};L.sequenceSeq=function(d1){return L.traverseSeq(a.id,d1);};L.traverseSeq=function(d1,d2){return L.map(a.id,di.foldBack(function(d3,d4){return L.op_GreaterGreaterEquals(d1(d3),function(d5){return L.op_GreaterGreaterEquals(d4,function(d6){return L.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),L.rtn(dh.T.Empty)));};L.op_GreaterGreaterEquals=function(d1,d2){return L.bind(d2,d1);};L.whileLoop=function(d1,d2){return d1()?L.bind(function(){return L.whileLoop(d1,d2);},d2()):L.rtn();};L.mapP=function(d1,d2){return L.bindP(function(d3){return L.rtn(d1(d3));},d2);};L.map=function(d1,d2){return L.bind(function(d3){return L.rtn(d1(d3));},d2);};L.bindP=function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d2,function(d4){return d4.$==1?dj.Return(c.Error$1(d4.$0)):d1(d4.$0);});}),function(d4){return dj.Return(c.Error$1(new e({$:5,$0:d4.message,$1:d4.stack})));});});};L.bind=function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.Bind(d2,function(d4){var d5,d6;return d4.$==1?(d5=d4.$0,(d6=null,dj.Delay(function(){return dj.Return(c.Error$1(d5));}))):d1(d4.$0);});});};L.iterA=function(d1,d2,d3){function d4(d6){m.iter(d1,d2,d6);}function d5(d6){return dj.Return(d6);}dj.Start(dj.Bind(d3,function(d6){return d5(d4(d6));}),null);};L.iterS=function(d1,d2,d3){throw"iterS cannot be used in JavaScript!";};L.rtnR=function(d1){return dj.Return(d1);};L.rtn=function(d1){return dj.Return({$:0,$0:d1});};L.freeMessage=function(d1){function d2(d3){return dj.Return(d3);}return dj.Bind(d1,function(d3){return d2(m.freeMessage(d3));});};L.mapError=function(d1,d2){function d3(d5){return dl.MapError(d1,d5);}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};M=g.AsyncResultBuilder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},While:function(d1,d2){return L.whileLoop(d1,d2);},Using:function(d1,d2){return dj.Using(d1,d2);},TryFinally:function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryFinally(dj.Delay(function(){return d1();}),function(){d2();});});},TryWith:function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return d1();}),function(d4){return d2(d4);});});},Run:function(d1){return d1();},Delay:a.id,Combine:function(d1,d2){return L.bind(d2,L.rtnR(d1));},Combine$1:function(d1,d2){return L.bind(d2,d1);},Bind:function(d1,d2){return L.bind(d2,L.rtnR(d1));},Bind$1:function(d1,d2){return L.bind(d2,d1);},Zero:function(){return L.rtn();},Return:function(d1){return L.rtn(d1);},ReturnFrom:function(d1){return L.rtnR(d1);},ReturnFrom$1:a.id},l,M);M.New=dd.Ctor(function(){l.New.call(this);},M);N=g.AsyncResultBuilderP=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},While:function(d1,d2){return L.whileLoop(d1,d2);},Using:function(d1,d2){return dj.Using(d1,d2);},TryFinally:function(d1,d2){var d3;d3=null;return dj.Delay(function(){try{return d1();}finally{d2();}});},TryWith:function(d1,d2){var d3;d3=null;return dj.Delay(function(){try{return d1();}catch(d4){return d2(d4);}});},Run:function(d1){return L.bindP(d1,L.rtn());},Delay:a.id,Combine:function(d1,d2){return L.bindP(d2,L.rtnR(d1));},Combine$1:function(d1,d2){return L.bindP(d2,d1);},Bind:function(d1,d2){return L.bindP(d2,L.rtnR(d1));},Bind$1:function(d1,d2){return L.bindP(d2,d1);},Zero:function(){return L.rtn();},Return:function(d1){return L.rtn(d1);},ReturnFrom:function(d1){return L.rtnR(d1);},ReturnFrom$1:a.id},l,N);N.New=dd.Ctor(function(){l.New.call(this);},N);O["AsyncResultBuilderP.Combine"]=function(d1,d2,d3){function d4(d6){return{$:0,$0:d6};}function d5(d6){return dj.Return(d6);}return L.bindP(d3,dj.Bind(d2,function(d6){return d5(d4(d6));}));};O["AsyncResultBuilderP.Bind"]=function(d1,d2,d3){function d4(d6){return{$:0,$0:d6};}function d5(d6){return dj.Return(d6);}return L.bindP(d3,dj.Bind(d2,function(d6){return d5(d4(d6));}));};O["AsyncResultBuilderP.ReturnFrom"]=function(d1,d2){function d3(d5){return{$:0,$0:d5};}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};O["AsyncResultBuilder.Combine"]=function(d1,d2,d3){function d4(d6){return{$:0,$0:d6};}function d5(d6){return dj.Return(d6);}return L.bind(d3,dj.Bind(d2,function(d6){return d5(d4(d6));}));};O["AsyncResultBuilder.Bind"]=function(d1,d2,d3){function d4(d6){return{$:0,$0:d6};}function d5(d6){return dj.Return(d6);}return L.bind(d3,dj.Bind(d2,function(d6){return d5(d4(d6));}));};O["AsyncResultBuilder.ReturnFrom"]=function(d1,d2){function d3(d5){return{$:0,$0:d5};}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};Q=P.AsyncResultMBuilder=dd.Class({For:function(d1,d2){var d3;d3=this;return this.Using(dk.Get(d1),function(d4){return d3.While(function(){return d4.MoveNext();},d3.Delay(function(){return d2(d4.Current());}));});},While:function(d1,d2){return P.whileLoop(d1,d2);},Using:function(d1,d2){return dj.Using(d1,d2);},TryFinally:function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryFinally(dj.Delay(function(){return d1();}),function(){d2();});});},TryWith:function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return d1();}),function(d4){return d2(d4);});});},Run:function(d1){return d1();},Delay:a.id,Combine:function(d1,d2){return P.bind(d2,P.rtnR(d1));},Combine$1:function(d1,d2){return P.bind(d2,d1);},Bind:function(d1,d2){return P.bindrA(d2,d1);},Bind$1:function(d1,d2){return P.bindR(d2,d1);},Bind$2:function(d1,d2){return P.bindM(d2,d1);},Bind$3:function(d1,d2){return P.bindr(d2,d1);},Bind$4:function(d1,d2){return P.bind(d2,d1);},Zero:function(){return P.rtn();},Return:function(d1){return P.rtn(d1);},ReturnFrom:function(d1){return P.rtnrA(d1);},ReturnFrom$1:function(d1){return P.rtnR(d1);},ReturnFrom$2:function(d1){return P.rtnM(d1);},ReturnFrom$3:function(d1){return P.rtnr(d1);},ReturnFrom$4:a.id},l,Q);Q.New=dd.Ctor(function(){l.New.call(this);},Q);P.absorbO=function(d1,d2){function d3(d5){return m.absorbO(d1,d5);}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};P.absorbR=function(d1){var d2;function d3(d4){return dj.Return(d4);}return dj.Bind(d1,(d2=function(d4){return m.bindP(a.id,d4);},function(d4){return d3(d2(d4));}));};P.insertR=function(d1){return d1.$==0?P.map(function(d2){return{$:0,$0:d2};},d1.$0):P.rtn(c.Error$1(d1.$0));};P.insertO=function(d1){var d2;d2=d1==null?null:{$:1,$0:P.map(function(d3){return{$:1,$0:d3};},d1.$0)};return d2==null?P.rtn(null):d2.$0;};P.sequenceSeq=function(d1){return P.traverseSeq(a.id,d1);};P.traverseSeq=function(d1,d2){return P.map(a.id,di.foldBack(function(d3,d4){return P.op_GreaterGreaterEquals(d1(d3),function(d5){return P.op_GreaterGreaterEquals(d4,function(d6){return P.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),P.rtn(dh.T.Empty)));};P.op_GreaterGreaterEquals=function(d1,d2){return P.bind(d2,d1);};P.whileLoop=function(d1,d2){return d1()?P.bind(function(){return P.whileLoop(d1,d2);},d2()):P.rtn();};P.map=function(d1,d2){return P.bind(function(d3){return P.rtn(d1(d3));},d2);};P.bindR=function(d1,d2){return P.bind(d1,P.rtnR(d2));};P.bindrA=function(d1,d2){return P.bind(d1,P.rtnrA(d2));};P.bindM=function(d1,d2){return P.bind(d1,P.rtnM(d2));};P.bindr=function(d1,d2){return P.bind(d1,P.rtnr(d2));};P.bind=function(d1,d2){var d3;d3=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d2,function(d4){var d5,d6;function d7(d9){return H.addMsg(d6,d9);}function d8(d9){return dj.Return(d9);}d5=g.OkM(d4);return d5.$==1?dj.Return(g.ErrorM(d5.$0)):(d6=d5.$0[1],dj.Bind(d1(d5.$0[0]),function(d9){return d8(d7(d9));}));});}),function(d4){return dj.Return(g.ErrorM(new e({$:5,$0:d4.message,$1:d4.stack})));});});};P.iterpA=function(d1,d2){function d3(d4){c.print$1(d4);}P.iterA(function(d4){return d3(e.summarized(d4));},d1,d2);};P.iterpS=function(d1,d2){function d3(d4){c.print$1(d4);}P.iterS(function(d4){return d3(e.summarized(d4));},d1,d2);};P.iterA=function(d1,d2,d3){function d4(d6){H.iter(d1,d2,d6);}function d5(d6){return dj.Return(d6);}dj.Start(dj.Bind(d3,function(d6){return d5(d4(d6));}),null);};P.iterS=function(d1,d2,d3){throw"iterS cannot be used in JavaScript!";};P.rtnrA=function(d1){function d2(d3){return dj.Return(d3);}return dj.Bind(d1,function(d3){return d2(H.ofResult(d3));});};P.rtnM=function(d1){return dj.Return(H.rtnM(d1));};P.rtnR=function(d1){return dj.Return(d1);};P.rtnr=function(d1){return dj.Return(H.rtnr(d1));};P.rtn=function(d1){return dj.Return(g.OkM$1(d1));};P.freeMessage=function(d1){function d2(d3){return dj.Return(d3);}return dj.Bind(d1,function(d3){return d2(H.freeMessage(d3));});};P.mapError=function(d1,d2){function d3(d5){return H.mapMessage(d1,d5);}function d4(d5){return dj.Return(d5);}return dj.Bind(d2,function(d5){return d4(d3(d5));});};R["AsyncResultMBuilder.Combine"]=function(d1,d2,d3){function d4(d5){return dj.Return(d5);}return P.bind(d3,dj.Bind(d2,function(d5){return d4(g.OkM$1(d5));}));};R["AsyncResultMBuilder.Bind"]=function(d1,d2,d3){function d4(d5){return dj.Return(d5);}return P.bind(d3,dj.Bind(d2,function(d5){return d4(g.OkM$1(d5));}));};R["AsyncResultMBuilder.ReturnFrom"]=function(d1,d2){function d3(d4){return dj.Return(d4);}return dj.Bind(d2,function(d4){return d3(g.OkM$1(d4));});};R.asyncResultM=function(){c$.$cctor();return c$.asyncResultM;};g.asyncResultP=function(){c$.$cctor();return c$.asyncResultP;};g.asyncResult=function(){c$.$cctor();return c$.asyncResult;};g.OkM=function(d1){return d1.$0==null?{$:1,$0:d1.$1}:{$:0,$0:[d1.$0.$0,d1.$1]};};g.ErrorM=function(d1){return{$:0,$0:null,$1:d1};};g.OkMWithMsg=function(d1,d2){return{$:0,$0:{$:1,$0:d1},$1:d2};};g.OkM$1=function(d1){return{$:0,$0:{$:1,$0:d1},$1:e.NoMsg};};S.EndsWith$1=function(d1,d2){return df.EndsWith(d2,d1)?{$:1,$0:_do.string(d2,{$:1,$0:0},{$:1,$0:d2.length-d1.length-1})}:null;};S.StartsWith$1=function(d1,d2){return df.StartsWith(d2,d1)?{$:1,$0:_do.string(d2,{$:1,$0:d1.length},null)}:null;};S.skipLastLine$1=function(){c$.$cctor();return c$.skipLastLine;};S.indentStr$1=function(d1){function d2(d4){return S.indent$1(d1,d4);}function d3(d4){return df.concat("\n",d4);}return function(d4){return d3(d2(d4));};};S.unindentStr$1=function(){c$.$cctor();return c$.unindentStr;};S.indent$1=function(d1,d2){var d3,d4;d3=df.SplitChars(d2,["\n"],0);return dg.map((d4=df.replicate(d1," "),function(d5){return d4+d5;}),d3);};S.unindent$1=function(d1){var d2,d3,d4,d5;d2=df.SplitChars(d1,["\n"],0);d3=(d4=dg.tryFindIndex(function(d6){return" "!==d6;},(d5=dg.tryFind(function(d6){return df.Trim(d6)!=="";},d2),d5==null?"":d5.$0)),d4==null?0:d4.$0);return dg.filter(function(d6){return!df.StartsWith(d6,"# 1 ");},dg.map(function(d6){return d6.length<=d3?"":d6.substring(d3);},d2));};S.skipFirstLine$1=function(d1){var d2;d2=d1.indexOf("\n");return d2<0?"":_do.string(d1,{$:1,$0:d2+1},null);};S.append$1=function(d1,d2){return d1+d2;};S.trim$1=function(d1){return df.Trim(d1);};S.contains$1=function(d1,d2){return d2.indexOf(d1)!=-1;};S.delimitedO$1=function(d1,d2,d3){var d4,d5,d6,d7,d8;d4=S.splitInTwoO$1(d1,d3);return d4==null?null:(d5=d4.$0,(d6=d5[0],(d7=S.splitInTwoO$1(d2,d5[1]),d7==null?null:{$:1,$0:(d8=d7.$0,[d6,d8[0],d8[1]])})));};S.splitInTwoO$1=function(d1,d2){var d3;d3=d2.indexOf(d1);return d3===-1?null:{$:1,$0:[c["String.Left$1"](d2,d3),d2.substring(d3+d1.length)]};};S.splitByChar$1=function(d1,d2){return df.SplitChars(d2,[d1],0);};T.replace=function(d1,d2,d3){return di.ofSeq(dg.delay(function(){return dg.append(d1>0?_do.array(d3,null,{$:1,$0:d1-1}):[],dg.delay(function(){return dg.append([d2],dg.delay(function(){return d1<di.length(d3)?_do.array(d3,{$:1,$0:d1+1},null):[];}));}));}));};U.Guid$1=function(){c$.$cctor();return c$["|Guid|_|"];};U.Double$1=function(){c$.$cctor();return c$["|Double|_|"];};U.Single$1=function(){c$.$cctor();return c$["|Single|_|"];};U.Int$1=function(){c$.$cctor();return c$["|Int|_|"];};U.Date$1=function(){c$.$cctor();return c$["|Date|_|"];};U.parseGuidO$1=function(){c$.$cctor();return c$.parseGuidO;};U.parseDoubleO$1=function(){c$.$cctor();return c$.parseDoubleO;};U.parseSingleO$1=function(){c$.$cctor();return c$.parseSingleO;};U.parseIntO$1=function(){c$.$cctor();return c$.parseIntO;};U.parseDateO$1=function(){c$.$cctor();return c$.parseDateO;};U.tryParseWith$1=function(d1){function d2(d3,d4){return d3?{$:1,$0:d4}:null;}return function(d3){return d2.apply(null,d1(d3));};};V.PostAndAsyncReply=function(d1,d2,d3){return d1.PostAndAsyncReply(function(d4){return[d4,d2];},d3);};X.applyReply=function(d1,d2){return X.applyReplyA(function(d3){var d4;d4=null;return dj.Delay(function(){return dj.Return(d1(d3));});},d2);};X.applyReplyA=function(d1,d2){return d2.PostAndAsyncReply(function(d3){return function(d4){var d5;d5=null;return dj.Delay(function(){return dj.Bind(d1(d4),function(d6){d3(d6[1]);return dj.Return(d6[0]);});});};},null);};X.apply=function(d1,d2){X.applyA(function(d3){var d4;d4=null;return dj.Delay(function(){return dj.Return(d1(d3));});},d2);};X.applyA=function(d1,d2){d2.mailbox.AddLast(function(d3){var d4;d4=null;return dj.Delay(function(){return d1(d3);});});d2.resume();};X.setState=function(d1,d2){d2.mailbox.AddLast(function(){var d3;d3=null;return dj.Delay(function(){return dj.Return(d1);});});d2.resume();};X.getStateA=function(d1){return d1.PostAndAsyncReply(function(d2){return function(d3){var d4;d4=null;return dj.Delay(function(){d2(d3);return dj.Return(d3);});};},null);};W.defHandler=function(d1,d2){c.print$1(d1);return d2;};W.stateFull=function(d1,d2){return dq.Start(function(d3){function d4(d5){var d6;d6=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d3.Receive(null),function(d7){return dj.Bind(d7(d5),function(d8){return d4(d8);});});}),function(d7){return d4(d1(d7,d5));});});}return d4(d2);},null);};W.fold=function(d1,d2,d3){return W.foldA(d1,function(d4,d5){var d6;d6=null;return dj.Delay(function(){return dj.Return(d2(d4,d5));});},d3);};W.foldA=function(d1,d2,d3){return dq.Start(function(d4){function d5(d6){var d7;d7=null;return dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d4.Receive(null),function(d8){return dj.Bind(d2(d6,d8),function(d9){return d5(d9);});});}),function(d8){return d5(d1(d8,d6));});});}return d5(d3);},null);};W.call=function(d1,d2){return W.callA(d1,function(d3){var d4;d4=null;return dj.Delay(function(){return dj.Return(d2(d3));});});};W.callA=function(d1,d2){return W.iterA(d1,function(d3){var d4,d5,d6;d4=d3[0];d5=d3[1];d6=null;return dj.Delay(function(){return dj.Bind(d2(d5),function(d7){d4(d7);return dj.Zero();});});});};W.iter=function(d1,d2){return W.iterA(d1,function(d3){var d4;d4=null;return dj.Delay(function(){d2(d3);return dj.Zero();});});};W.iterA=function(d1,d2){return dq.Start(function(d3){var d4;d4=null;return dj.Delay(function(){return dj.While(function(){return true;},dj.Delay(function(){return dj.TryWith(dj.Delay(function(){return dj.Bind(d3.Receive(null),function(d5){return dj.Bind(d2(d5),function(){return dj.Return(null);});});}),function(d5){d1(d5);return dj.Zero();});}));});},null);};Y.Hole={$:0};_0.New=function(d1,d2,d3,d4,d5,d6,d7,d8){return{id:d1,getData:d2,isExpandedEf:d3,canHaveChildrenEf:d4,childrenEf:d5,pathEf:d6,parentOEf:d7,newChildrenEf:d8};};Z.removeNodeOutdentChildren=function(d1,d2){var d3;function d4(d5,d6){return x.op_GreaterGreaterEquals(d5,function(d7){return Z.outdentNode(d6,d7);});}return x.op_GreaterGreaterEquals(x.op_GreaterGreaterEquals(d1.childrenEf(),(d3=x.rtn(d2),function(d5){return dg.fold(d4,d3,d5);})),function(d5){return Z.removeNode(d1,d5);});};Z.outdentNode=function(d1,d2){var d3;function d4(d5){return Z.moveToSibling(true,d1,d5,d2);}return x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(d1.parentOEf(d2),function(d5){return d5==null?null:{$:1,$0:d4(d5.$0)};}),(d3=x.rtn(d2),function(d5){return d5==null?d3:d5.$0;}));};Z.indentNode=function(d1,d2){var d3;function d4(d6){return!dn.Equals(d1.id(),d6.id());}function d5(d6,d7){return x.op_GreaterGreaterEquals(d7.canHaveChildrenEf(),function(d8){return d8?x.rtn({$:1,$0:d7}):d6;});}return x.op_GreaterGreaterEquals(x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(d1.parentOEf(d2),function(d6){return d6!=null&&d6.$==1?x.op_BarGreaterGreater(d6.$0.childrenEf(),function(d7){var d8;d8=di.ofSeq(d7);return d8;}):x.rtn(d2);}),function(d6){return dg.takeWhile(d4,d6);}),(d3=x.rtn(null),function(d6){return dg.fold(d5,d3,d6);})),function(d6){var d7;return d6!=null&&d6.$==1?(d7=d6.$0,x.op_GreaterGreaterEquals(Z.removeNode(d1,d2),function(d8){return Z.addChild(true,d1,d7,d8);})):x.rtn(d2);});};Z.addChild=function(d1,d2,d3,d4){var d5;d5=t.eff();return d5.Delay(function(){return d5.Bind(d3.pathEf(),function(d6){function d7(d8){var d9,d_;return dn.Equals(d8.id(),d3.id())?d1?x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(x.op_BarGreaterGreater(d8.childrenEf(),di.ofSeq),(d9=dh.ofArray([d2]),function(d$){return dg.append(d$,d9);})),di.ofSeq),d8.newChildrenEf):x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(x.op_BarGreaterGreater(d8.childrenEf(),di.ofSeq),(d_=dh.ofArray([d2]),function(d$){return dg.append(d_,d$);})),di.ofSeq),d8.newChildrenEf):dh.contains(d8.id(),d6)?x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(d8.childrenEf(),di.ofSeq),function(d$){return dg.map(d7,d$);}),t.sequenceSeq),di.ofSeq),d8.newChildrenEf):x.rtn(d8);}return d5.ReturnFrom(t.sequenceSeq(dg.map(d7,d4)));});});};Z.moveToSibling2=function(d1,d2,d3,d4){var d5;d5=t.eff();return d5.Delay(function(){return d5.Bind(Z.tryFindId(d2,d4),function(d6){var d7;return d6!=null&&d6.$==1?(d7=d6.$0,d5.Bind(Z.tryFindId(d3,d4),function(d8){return d8!=null&&d8.$==1?d5.ReturnFrom(Z.moveToSibling(d1,d7,d8.$0,d4)):d5.Return(d4);})):d5.Return(d4);});});};Z.moveToSibling=function(d1,d2,d3,d4){return x.op_GreaterGreaterEquals(Z.removeNode(d2,d4),function(d5){return Z.addSibling(d1,d2,d3,d5);});};Z.tryFindId=function(d1,d2){return Z.tryFind(function(d3){return dn.Equals(d3.id(),d1);},d2);};Z.tryFind=function(d1,d2){function d3(d4,d5){return x.op_GreaterGreaterEquals(d4,function(d6){var d7;return d6==null?d1(d5)?x.rtn({$:1,$0:d5}):x.op_GreaterGreaterEquals(d5.childrenEf(),(d7=x.rtn(null),function(d8){return dg.fold(d3,d7,d8);})):x.rtn({$:1,$0:d6.$0});});}return dg.fold(d3,x.rtn(null),d2);};Z.addSibling=function(d1,d2,d3,d4){function d5(d6){return dn.Equals(d6.id(),d3.id());}return x.op_GreaterGreaterEquals(d3.pathEf(),function(d6){var d7,d8;function d9(d_){return dn.Equals(d_.id(),d8)?x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(d_.childrenEf(),di.ofSeq),function(d$){return Z.addToParent(d1,d5,d2,d_,d$);}):dh.contains(d_.id(),d7)?x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(d_.childrenEf(),di.ofSeq),function(d$){return dg.map(d9,d$);}),t.sequenceSeq),di.ofSeq),d_.newChildrenEf):x.rtn(d_);}return d6.$==1?(d7=d6.$1,(d8=d6.$0,t.sequenceSeq(dg.map(d9,d4)))):x.rtn(Z.addNodeToSeq(d1,d5,d2,d4));});};Z.addToParent=function(d1,d2,d3,d4,d5){return d4.newChildrenEf(di.ofSeq(Z.addNodeToSeq(d1,d2,d3,d5)));};Z.addNodeToSeq=function(d1,d2,d3,d4){return dh.ofSeq(dg.delay(function(){return dg.collect(function(d5){return d2(d5)?d1?dg.append([d5],dg.delay(function(){return[d3];})):dg.append([d3],dg.delay(function(){return[d5];})):[d5];},d4);}));};Z.removeNodes=function(d1,d2){var d3;d3=t.eff();return d3.Delay(function(){function d4(d5,d6){var d7;d7=t.eff();return d7.Delay(function(){return d7.Bind(d5,function(d8){var d9,d_;d9=d8[1];d_=d8[0];return d7.Bind(x.op_BarGreaterGreater(d6.childrenEf(),di.ofSeq),function(d$){return d7.Bind(dg.fold(d4,x.rtn([dh.T.Empty,d9]),d$),function(ea){var eb,ec;eb=ea[1];ec=ea[0];return d1(d6)?d7.Return([d_,dh.append(ec,eb)]):d7.Bind(d6.newChildrenEf(di.ofSeq(dg.rev(ec))),function(ed){return d7.Return([new dh.T({$:1,$0:ed,$1:d_}),eb]);});});});});});}return d3.Bind(dg.fold(d4,x.rtn([dh.T.Empty,dh.T.Empty]),d2),function(d5){return d3.Return(dh.rev(dh.append(d5[1],d5[0])));});});};Z.removeNode=function(d1,d2){var d3;d3=t.eff();return d3.Delay(function(){return d3.Bind(d1.pathEf(),function(d4){function d5(d6){var d7;d7=t.eff();return d7.Delay(function(){return dn.Equals(d6.id(),d1.id())?(function(d8){return d8("found it");}(function(d8){dr.log(d8);}),d7.Return(null)):dh.contains(d6.id(),d4)?(function(d8){return d8("deeper");}(function(d8){dr.log(d8);}),d7.ReturnFrom(x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(x.op_BarGreaterGreater(d6.childrenEf(),di.ofSeq),function(d8){return dg.map(d5,d8);}),t.sequenceSeq),function(d8){return dg.choose(a.id,d8);}),di.ofSeq),d6.newChildrenEf),function(d8){return{$:1,$0:d8};}))):(function(d8){return d8("not");}(function(d8){dr.log(d8);}),d7.Return({$:1,$0:d6}));});}((function(d6){return function(d7){return d6("path = "+de.printList(de.prettyPrint,d7));};}(function(d6){dr.log(d6);}))(d4));return d3.ReturnFrom(x.op_BarGreaterGreater(t.sequenceSeq(dg.map(d5,d2)),function(d6){return dg.choose(a.id,d6);}));});});};Z.listNodes=function(d1,d2){return x.op_BarGreaterGreater(t.sequenceSeq(dg.map(function(d3){return x.op_BarGreaterGreater(x.op_GreaterGreaterEquals(d3.isExpandedEf(),function(d4){var d5;return d4?x.op_GreaterGreaterEquals(x.op_BarGreaterGreater(d3.childrenEf(),di.ofSeq),(d5=d1+1,function(d6){return Z.listNodes(d5,d6);})):x.rtn([]);}),function(d4){return dg.append([[d3,d1]],d4);});},d2)),function(d3){return dg.collect(a.id,d3);});};c["String.Right$1"]=function(d1,d2){var d3,d4;return c["String.Substring2$1"](d1,(d3=0,(d4=d1.length-d2,dn.Compare(d3,d4)===1?d3:d4)),d1.length);};c["String.Left$1"]=function(d1,d2){return c["String.Substring2$1"](d1,0,d2);};c["String.Substring2$1"]=function(d1,d2,d3){var d4,d5;while(true){if(d3<=0)return"";else if(d2<0){d4=d2;d2=0;d3=d3+d4;}else return d2>=d1.length?"":df.Substring(d1,d2,(d5=d1.length-d2,dn.Compare(d3,d5)===-1?d3:d5));}};c.delayed$1=function(d1,d2){var d3;d3=[null];return function(d4){var d5,d6;d5=d3[0];d5==null?void 0:d5.$0.Cancel$1();d3[0]={$:1,$0:new ds.New()};dj.Start((d6=null,dj.Delay(function(){return dj.Bind(dj.Sleep(d1),function(){d2(d4);return dj.Zero();});})),{$:1,$0:d3[0].$0});};};c.print$1=function(d1){if(typeof d1=="string")((function(d2){return function(d3){return d2(de.toSafe(d3));};}(function(d2){dr.log(d2);}))(d1));else((function(d2){return function(d3){return d2(de.prettyPrint(d3));};}(function(d2){dr.log(d2);}))(d1));};c.Error$1=function(d1){return{$:1,$0:d1};};_2.sequenceSeq=function(d1){return _2.traverseSeq(a.id,d1);};_2.traverseSeq=function(d1,d2){return _2.map(a.id,di.foldBack(function(d3,d4){return _2.op_GreaterGreaterEquals(d1(d3),function(d5){return _2.op_GreaterGreaterEquals(d4,function(d6){return _2.rtn(new dh.T({$:1,$0:d5,$1:d6}));});});},di.ofSeq(d2),_2.rtn(dh.T.Empty)));};_2.op_GreaterGreaterEquals=function(d1,d2){return _2.bind(d2,d1);};_2.rtn=function(d1){return du.Const(d1);};_2.map=function(d1,d2){return du.Map(d1,d2);};_2.bind=function(d1,d2){return du.Bind(d1,d2);};_2.insertWO=function(d1){return d1==null?du.Const(null):du.Map(function(d2){return{$:1,$0:d2};},d1.$0);};_3.lensView=function(d1,d2,d3,d4){var d5,d6,d7;d5=_3.freshId();d6=du.Map2(function(d8){return d1(d8);},d4.get_View(),d3);d7=new dt.Var({Get:function(){return d1(d4.Get());},Set:function(d8){return d4.Update(function(d9){return d2(d9,d8);});},SetFinal:function(d8){return this.Set(d8);},Update:function(d8){return d4.Update(function(d9){return d2(d9,d8(d1(d9)));});},UpdateMaybe:function(d8){return d4.UpdateMaybe(function(d9){var d_;d_=d8(d1(d9));return d_==null?null:{$:1,$0:d2(d9,d_.$0)};});},get_View:function(){return d6;},get_Id:function(){return d5;}});dv.New.call(d7);return d7;};_3.freshId=function(){_3.set_counter(_3.counter()+1);return"varuid"+a.String(_3.counter());};_3.counter=function(){c$.$cctor();return c$.counter;};_3.set_counter=function(d1){c$.$cctor();c$.counter=d1;};_4.currentLens=function(d1,d2,d3){return _4["currentLensUpd'"](d1,d2,function(d4){d3.UpdateBy(function(){return d3.TryFindByKey(d3.key(d4))==null?null:{$:1,$0:d4};},d3.key(d4));},d3);};_4["currentLensUpd'"]=function(d1,d2,d3,d4){return new dw.New(du.Map2(function(d5,d6){var d7;d7=d6==null?null:d4.TryFindByKey(d6.$0);return d7==null?d1:d7.$0;},d4.v,d2),d3);};_4.currentLensUpd=function(d1,d2,d3,d4){var d5;function d6(d8){return d4.TryFindByKey(d8);}function d7(d8){return d8==null?d1:d8.$0;}return _3.lensView((d5=function(d8){return d8==null?null:d6(d8.$0);},function(d8){return d7(d5(d8));}),function(d8,d9){(i.iter(d3(d9)))(d8);return d8;},d4.v,d2);};_4.lensDef=function(d1,d2,d3){function d4(d5){return d5==null?d1:d5.$0;}return _4["lensIntoO'"](d3,d4,function(){return a.id;},d2,du.Map(d4,d3.TryFindByKeyAsView(d2)));};_4.docLensMapViewO=function(d1,d2,d3,d4){function d5(d6,d7){return d3(d6,_4["lensIntoO'"](d4,function(d8){return d8==null?d1:d8.$0;},function(){return a.id;},d6,d7));}return dx.ConvertSeqBy(d4.key,function(d6){return function(d7){return d5(d6,d7);};},du.Map(d2,d4.v));};_4.docLensMapView=function(d1,d2,d3){function d4(d5,d6){return d2(d5,_4["lensInto'"](d3,a.id,function(){return a.id;},d5,d6));}return dx.ConvertSeqBy(d3.key,function(d5){return function(d6){return d4(d5,d6);};},du.Map(d1,d3.v));};_4["lensIntoO'"]=function(d1,d2,d3,d4,d5){var d6,d7;d6=_3.freshId();d7=new dv({Get:function(){return d2(d1.TryFindByKey(d4));},Set:function(d8){return d1.UpdateBy(function(d9){return{$:1,$0:(d3(d9))(d8)};},d4);},Update:function(d8){return d1.UpdateBy(function(d9){var d_;return{$:1,$0:(d_=d8(d2({$:1,$0:d9})),(d3(d9))(d_))};},d4);},UpdateMaybe:function(d8){return d1.UpdateBy(function(d9){var d_,d$;d_=d8(d2({$:1,$0:d9}));d$=d3(d9);return d_==null?null:{$:1,$0:d$(d_.$0)};},d4);},SetFinal:function(d8){return this.Set(d8);},get_View:function(){return d5;},get_Id:function(){return d6;}});dv.New.call(d7);return d7;};_4["lensInto'"]=function(d1,d2,d3,d4,d5){var d6,d7;d6=_3.freshId();d7=new dv({Get:function(){return d2(d1.FindByKey(d4));},Set:function(d8){return d1.UpdateBy(function(d9){return{$:1,$0:(d3(d9))(d8)};},d4);},Update:function(d8){return d1.UpdateBy(function(d9){var d_;return{$:1,$0:(d_=d8(d2(d9)),(d3(d9))(d_))};},d4);},UpdateMaybe:function(d8){return d1.UpdateBy(function(d9){var d_,d$;d_=d8(d2(d9));d$=d3(d9);return d_==null?null:{$:1,$0:d$(d_.$0)};},d4);},SetFinal:function(d8){return this.Set(d8);},get_View:function(){return d5;},get_Id:function(){return d6;}});dv.New.call(d7);return d7;};_5.LoadFilesAsync=function(d1){var d2;d2=null;return dj.Delay(function(){return dj.For(d1,function(d3){return dj.Bind(_5.LoadFile(d3),function(){return dj.Return(null);});});});};_5.LoadFile=function(d1){var d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed;function ee(eg,eh){return df.EndsWith(eh,eg)?{$:1,$0:null}:null;}function ef(eg,eh){try{ec.onload=eg;self.document.head.appendChild(ec);}catch(ei){eh(ei);}}d2=(d3=((d5=ee(".js",d1),d5!=null&&d5.$==1)?!self.document.querySelector("script[src='"+d1+"']")||((d6=ee(".fsx",d1),d6!=null&&d6.$==1)?!self.document.querySelector("script[src='"+d1+"']")||(d7=ee(".fs",d1),d7!=null&&d7.$==1)&&!self.document.querySelector("script[src='"+d1+"']"):(d8=ee(".fs",d1),d8!=null&&d8.$==1)&&!self.document.querySelector("script[src='"+d1+"']")):(d9=ee(".fsx",d1),d9!=null&&d9.$==1)?!self.document.querySelector("script[src='"+d1+"']")||(d_=ee(".fs",d1),d_!=null&&d_.$==1)&&!self.document.querySelector("script[src='"+d1+"']"):(d$=ee(".fs",d1),d$!=null&&d$.$==1)&&!self.document.querySelector("script[src='"+d1+"']"))?{$:1,$0:_5.createScript(d1)}:(ea=ee(".css",d1),ea!=null&&ea.$==1)?{$:1,$0:_5.createCss(d1)}:(eb=ee(".html",d1),eb!=null&&eb.$==1)?{$:1,$0:_5.createHtml(d1)}:null,d3==null?null:{$:1,$0:(ec=d3.$0,dj.FromContinuations(function(eg,eh,ei){return ef.apply(null,[eg,eh,ei]);}))});return d2==null?(ed=null,dj.Delay(function(){return dj.Return(null);})):d2.$0;};_5.createHtml=function(d1){var d2;d2=self.document.createElement("link");d2.setAttribute("rel","import");d2.setAttribute("type","text/html");d2.setAttribute("href",d1);return d2;};_5.createCss=function(d1){var d2;d2=self.document.createElement("link");d2.setAttribute("rel","stylesheet");d2.setAttribute("type","text/css");d2.setAttribute("href",d1);return d2;};_5.createScript=function(d1){var d2;d2=self.document.createElement("script");d2.setAttribute("type","text/javascript");d2.setAttribute("src",d1);return d2;};_6.Identifier$1=function(d1){var d2,d3,d4;return(d3=_1.REGEX$2("^[$a-zA-Z_][0-9a-zA-Z_\\.\\-$]*$","",d1),d3!=null&&d3.$==1&&((d4=d3.$0,!dn.Equals(d4,null)&&d4.length===1)&&(d2=di.get(d3.$0,0),true)))?{$:1,$0:d2}:null;};_6.getEndWord$1=function(d1,d2){var d3,d4;d3=_1.REGEX$2("^([a-zA-Z_]\\w*)","g",d1.substring(d2));return d3!=null&&d3.$==1?(d4=d3.$0,!dn.Equals(d4,null)&&d4.length===1)?di.get(d3.$0,0):"":"";};_6.getStartWord$1=function(d1,d2){var d3,d4;d3=_1.REGEX$2("([a-zA-Z_]\\w*)$","g",df.Substring(d1,0,d2));return d3!=null&&d3.$==1?(d4=d3.$0,!dn.Equals(d4,null)&&d4.length===1)?di.get(d3.$0,0):"":"";};_7.addResizeObserver$1=function(d1,d2){var d3,d4,d5,d6;try{d3=!(!a.ResizeObserver);}catch(d7){d3=false;}if(d3){d4=new a.ResizeObserver(d1);_7.set_observers$1(new dh.T({$:1,$0:d4,$1:_7.observers$1()}));d4.observe(d2);}else{d5=_7.dimsChanged$1(d2);dj.Start((d6=null,dj.Delay(function(){return dj.While(function(){return d2.isConnected;},dj.Delay(function(){return dj.Bind(dj.Sleep(110),function(){return d5()?(d1(),dj.Zero()):dj.Zero();});}));})),null);}};_7.dimsChanged$1=function(d1){var d2;d2=[d1.getBoundingClientRect()];return function(){var d3;d3=d1.getBoundingClientRect();return dn.Equals(_7.domRect2Tuple$1(d2[0]),_7.domRect2Tuple$1(d3))?false:(d2[0]=d3,true);};};_7.domRect2Tuple$1=function(d1){return[d1.top,d1.left,d1.width,d1.height];};_7.observers$1=function(){c$.$cctor();return c$.observers;};_7.set_observers$1=function(d1){c$.$cctor();c$.observers=d1;};_9.New=function(d1,d2){return{column:d1,lineNumber:d2};};_.New=function(d1,d2,d3,d4){return{startColumn:d1,endColumn:d2,startLineNumber:d3,endLineNumber:d4};};$.New=function(d1,d2,d3,d4,d5,d6){return{authority:d1,fragment:d2,fsPath:d3,path:d4,query:d5,scheme:d6};};ba.New=function(d1,d2){return{range:d1,uri:d2};};bb.New=function(d1,d2){return{matches:d1,range:d2};};bc.New=function(d1,d2,d3){return{endColumn:d1,startColumn:d2,word:d3};};bd.New=function(d1){return{uri:d1};};be.New=function(d1,d2){return{value:d1,isTrusted:d2};};bf.New=function(d1,d2,d3,d4,d5,d6){return{startColumn:d1,endColumn:d2,startLineNumber:d3,endLineNumber:d4,severity:d5,message:d6};};bg.New=function(d1,d2,d3){return{kind:d1,label:d2,detail:d3};};bh.New=function(d1,d2){return{contents:d1,range:d2};};bi=_8.Editor=dd.Class({},l,bi);bi.New=dd.Ctor(function(){l.New.call(this);},bi);bj.New=function(d1,d2,d3,d4,d5,d6,d7){return{"var":d1,onChange:d2,onRender:d3,editorO:d4,disabled:d5,options:d6,overrides:d7};};_8.newVarO=function(d1){var d2;d2=_8.newVar(dy.Lens(d1,function(d3){return d3==null?"":d3.$0;},function(d3,d4){return d3==null?null:{$:1,$0:d4};}));return _8.disabled(du.Map(function(d3){return d3==null;},d1.get_View()),d2);};_8.newText=function(d1){return _8.newVar(dy.Create$1(d1));};_8["var"]=function(d1){return d1["var"];};_8.disabled=function(d1,d2){return bj.New(d2["var"],d2.onChange,d2.onRender,d2.editorO,d1,d2.options,d2.overrides);};_8.onRender=function(d1,d2){return bj.New(d2["var"],d2.onChange,{$:1,$0:d1},d2.editorO,d2.disabled,d2.options,d2.overrides);};_8.onChange=function(d1,d2){return bj.New(d2["var"],d1,d2.onRender,d2.editorO,d2.disabled,d2.options,d2.overrides);};_8.setVar=function(d1,d2){return bj.New(d1,d2.onChange,d2.onRender,d2.editorO,d2.disabled,d2.options,d2.overrides);};_8.render$1924$48=function(d1){return function(d2){var d3,d4;d3=(d4=d2.parentElement,self.monaco.editor.create(d4,d1.options,d1.overrides));_7.addResizeObserver$1(function(){d3.layout();},d2.parentElement);d2.parentNode.removeChild(d2);d1.editorO={$:1,$0:d3};(i.iter(function(d5){d5(d3);}))(d1.onRender);_1.bindVarEditor(function(d5){d3.onDidChangeModelContent(d5);},function(){return d3.getValue();},function(d5){d3.setValue(d5);},d1.onChange,d1["var"]);};};_8.render=function(d1){var d2;return dx.Async((d2=null,dj.Delay(function(){return dj.Bind(_8.loader(),function(){return dj.Return(dx.Element("div",[dz.OnAfterRenderImpl(function(d3){var d4,d5;d4=(d5=d3.parentElement,self.monaco.editor.create(d5,d1.options,d1.overrides));_7.addResizeObserver$1(function(){d4.layout();},d3.parentElement);d3.parentNode.removeChild(d3);d1.editorO={$:1,$0:d4};(i.iter(function(d6){d6(d4);}))(d1.onRender);_1.bindVarEditor(function(d6){d4.onDidChangeModelContent(d6);},function(){return d4.getValue();},function(d6){d4.setValue(d6);},d1.onChange,d1["var"]);})],[]));});})));};_8.loader=function(){c$.$cctor();return c$.loader;};_8.newVar=function(d1){return bj.New(d1,a.ignore,null,null,du.Const(false),null,null);};_1.rexGuid$1=function(){c$.$cctor();return c$.rexGuid;};_1.REGEX$2=function(d1,d2,d3){var d4;return d3===null?null:(d4=(new a.String(d3)).match(new a.RegExp(d1,d2)),dn.Equals(d4,null)?null:!dn.Equals(d4,null)&&d4.length===0?null:{$:1,$0:d4});};_1.bindVarEditor=function(d1,d2,d3,d4,d5){var d6,d7;d6=[0];d7=[0];d1(function(){var d8;d8=d2();d5.Get()!==d8?(d6[0]=d6[0]+1,d5.Set(d8),d4()):void 0;});du.Sink(function(){if(d6[0]>d7[0])d7[0]=d6[0];else if(d2()!==d5.Get())d3(d5.Get());},d5.get_View());};bm=bl.Address=dd.Class({get_txt:function(){return this.$0;}},null,bm);bn.BRGetProcessId={$:1};bn.BRGetConnections={$:0};bo.MsgRequestForEcho={$:5};bo.MsgRequestForId={$:4};bo.MsgFromBroker={$:3};bo.MsgReply={$:2};bo.MsgRequest={$:1};bo.MsgInformation={$:0};bp.BMReceiverCantReply={$:4};bp.BMOnlyBrokerShouldUse={$:1};bp.BMOk={$:0};bq.Receiver={$:2};bq.Broker={$:1};bq.NoReply={$:0};br.New=function(d1,d2,d3,d4,d5,d6,d7){return{from:d1,destination:d2,msgType:d3,subtype:d4,id:d5,payload:d6,replier:d7};};bl.makeReply=function(d1){return bl.replier(bq.NoReply,bl.msgType(bo.MsgReply,d1));};bl.mapPayload=function(d1,d2){return br.New(d2.from,d2.destination,d2.msgType,d2.subtype,d2.id,d1(d2.payload),d2.replier);};bl.msgId=function(d1,d2){return br.New(d2.from,d2.destination,d2.msgType,d2.subtype,d1,d2.payload,d2.replier);};bl.replier=function(d1,d2){return br.New(d2.from,d2.destination,d2.msgType,d2.subtype,d2.id,d2.payload,d1);};bl.subtype=function(d1,d2){return br.New(d2.from,d2.destination,d2.msgType,d1,d2.id,d2.payload,d2.replier);};bl.msgType=function(d1,d2){return br.New(d2.from,d2.destination,d1,d2.subtype,d2.id,d2.payload,d2.replier);};bl.destination=function(d1,d2){return br.New(d2.from,d1,d2.msgType,d2.subtype,d2.id,d2.payload,d2.replier);};bl.from=function(d1,d2){return br.New(d1,d2.destination,d2.msgType,d2.subtype,d2.id,d2.payload,d2.replier);};bl.MessageBrokerAddress=function(){c$.$cctor();return c$.MessageBrokerAddress;};bl.MessageBrokerId=function(){c$.$cctor();return c$.MessageBrokerId;};bu.New=function(d1,d2){return{Code:d1,Message:d2};};bv.New=function(d1,d2,d3){return{File:d1,Line:d2,Column:d3};};bw.New=function(d1,d2,d3,d4){return{Name:d1,ReplacementText:d2,Glyph:d3,GlyphChar:d4};};bx.New=function(d1,d2,d3){return{Signature:d1,Comment:d2,Footer:d3};};by.New=function(d1,d2,d3,d4){return{Name:d1,CanonicalTypeTextForSorting:d2,Display:d3,Description:d4};};bz.New=function(d1,d2,d3,d4){return{Tip:d1,TypeText:d2,Parameters:d3,IsStaticArguments:d4};};bA.New=function(d1,d2){return{Name:d1,Type:d2};};bB.New=function(d1,d2){return{OutputType:d1,Parameters:d2};};bC.New=function(d1,d2,d3){return{Name:d1,CurrentParameter:d2,Overloads:d3};};bD.New=function(d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$){return{FileName:d1,StartLine:d2,StartColumn:d3,EndLine:d4,EndColumn:d5,IsFromDefinition:d6,IsFromAttribute:d7,IsFromComputationExpression:d8,IsFromDispatchSlotImplementation:d9,IsFromPattern:d_,IsFromType:d$};};bE.New=function(d1,d2){return{Name:d1,Uses:d2};};bF.New=function(d1,d2){return{Name:d1,Overloads:d2};};bG.New=function(d1,d2,d3){return{Fsc:d1,Fsi:d2,MSBuild:d3};};bH.New=function(d1,d2,d3,d4,d5,d6,d7,d8){return{FileName:d1,StartLine:d2,EndLine:d3,StartColumn:d4,EndColumn:d5,Severity:d6,Message:d7,Subcategory:d8};};bI.New=function(d1,d2){return{File:d1,Errors:d2};};bJ.New=function(d1){return{Kind:d1};};bK.New=function(d1,d2,d3,d4,d5,d6,d7,d8){return{UniqueName:d1,Name:d2,Glyph:d3,GlyphChar:d4,IsTopLevel:d5,File:d6,EnclosingEntity:d7,IsAbstract:d8};};bL.New=function(d1,d2){return{Declaration:d1,Nested:d2};};bM.New=function(d1,d2,d3,d4,d5,d6){return{Namespace:d1,Name:d2,Type:d3,Line:d4,Column:d5,MultipleNames:d6};};bN.New=function(d1,d2){return{Name:d1,Qualifier:d2};};bO.New=function(d1,d2,d3){return{Opens:d1,Qualifies:d2,Word:d3};};bP.New=function(d1){return{Text:d1};};bR.New=function(d1,d2,d3,d4){return{FileName:d1,IsAsync:d2,Lines:d3,Version:d4};};bS.New=function(d1,d2,d3){return{FileName:d1,Lines:d2,Version:d3};};bT.New=function(d1,d2,d3,d4,d5,d6){return{FileName:d1,SourceLine:d2,Line:d3,Column:d4,Filter:d5,IncludeKeywords:d6};};bU.New=function(d1,d2,d3,d4){return{FileName:d1,Line:d2,Column:d3,Filter:d4};};bV.New=function(d1){return{FileName:d1};};bW.New=function(d1){return{FileName:d1};};bX.New=function(d1){return{Symbol:d1};};bY.New=function(d1,d2,d3){return{Directory:d1,Deep:d2,ExcludedDirs:d3};};bZ.symbolUseProject=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("symboluseproject",function(d5){return d5.$==4?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.symbolUse=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("symboluse",function(d5){return d5.$==4?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.helpText=function(d1){return bZ.FSAutocompleteCall("helptext",function(d2){return d2.$==2?{$:1,$0:d2.$0}:null;},{$:6,$0:bX.New(d1)});};bZ.declarations=function(d1,d2,d3){return bZ.FSAutocompleteCall("declarations",function(d4){return d4.$==10?{$:1,$0:d4.$0}:null;},{$:1,$0:bS.New(d1,d2,d3)});};bZ.findDeclaration=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("finddeclaration",function(d5){return d5.$==9?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.findTypeDecl=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("findtypedeclaration",function(d5){return d5.$==9?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.completion=function(d1,d2,d3,d4,d5,d6){return bZ.FSAutocompleteCall("completion",function(d7){return d7.$==3?{$:1,$0:d7.$0}:null;},{$:2,$0:bT.New(d3,d1,d4,d5,d6,d2)});};bZ.signatureData=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("signatureData",function(d5){return d5.$==13?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.signature=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("signature",function(d5){return d5.$==12?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.toolTip=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("tooltip",function(d5){return d5.$==11?{$:1,$0:d5.$0}:null;},{$:3,$0:bU.New(d1,d2,d3,d4)});};bZ.parseCode=function(d1,d2,d3,d4){return bZ.FSAutocompleteCall("parse",function(d5){return d5.$==7?{$:1,$0:d5.$0}:null;},{$:0,$0:bR.New(d1,d3,d2,d4)});};bZ.FSAutocompleteCall=function(d1,d2,d3){var d4;d4=g.asyncResult();return d4.Run(d4.Delay(function(){return d4.Bind$1((new dB.New()).Async("RuleEditor:FsRoot.Library2+FsAutoComplete.FSAutocompleteCall0:-662505047",[d1,d3]),function(d5){var d6,d7;function d8(d9){return d9!=null;}d6=di.partition(function(d9){return d8(d2(d9));},d5);d7=d6[1];return d4.Bind(m.ofOption(function(){return new e({$:4,$0:d7});},dg.tryHead(dg.choose(d2,d6[0]))),function(d9){return d4.Return([d9,d7]);});});}));};b1.TemplatesFileName=function(){c$.$cctor();return c$.TemplatesFileName;};b1.rootdir=function(){c$.$cctor();return c$.rootdir;};b3.DtOther={$:6};b3.DtMeasure={$:5};b3.DtCalc={$:4};b3.DtTCalc={$:3};b3.DtVersion={$:2};b3.DtTime={$:1};b3.DtDataType={$:0};b4.CtFreeze={$:2};b4.CtCalc={$:1};b4.CtOther={$:0};b5.AtNumber={$:1};b5.AtString={$:0};b6.EtNumber={$:1};b6.EtString={$:0};b7=b2.ModId=dd.Class({get_Id:function(){return this.$0;}},null,b7);b8=b2.AttId=dd.Class({get_Id:function(){return this.$0;}},null,b8);b9=b2.ElmId=dd.Class({get_Id:function(){return this.$0;}},null,b9);b_=b2.CubId=dd.Class({get_Id:function(){return this.$0;}},null,b_);b$=b2.DimId=dd.Class({get_Id:function(){return this.$0;}},null,b$);ca=b2.CalId=dd.Class({get_Id:function(){return this.$0;}},null,ca);cb=b2.TotId=dd.Class({get_Id:function(){return this.$0;}},null,cb);cc=b2.ForId=dd.Class({get_Id:function(){return this.$0;}},null,cc);cd=b2.RulId=dd.Class({get_Id:function(){return this.$0;}},null,cd);ce.New=function(d1,d2,d3,d4){return{attId:d1,attName:d2,attType:d3,attTableNum:d4};};cf.New=function(d1,d2,d3,d4,d5,d6,d7){return{elmId:d1,elmDim:d2,elmType:d3,elmName:d4,elmDescription:d5,elmAttributes:d6,elmParents:d7};};cg.New=function(d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$){return{dimId:d1,dimName:d2,dimPrefix:d3,dimOrder:d4,dimExclude:d5,dimFreeze:d6,dimType:d7,defaultElm:d8,dimElements:d9,dimAttributes:d_,isCalcDim:d$};};ch.UoPlus={$:1};ch.UoMinus={$:0};ci.OpOr={$:11};ci.OpAnd={$:10};ci.OpLE={$:9};ci.OpLT={$:8};ci.OpGE={$:7};ci.OpGT={$:6};ci.OpNE={$:5};ci.OpEQ={$:4};ci.OpDivide={$:3};ci.OpMultiply={$:2};ci.OpSubtract={$:1};ci.OpAdd={$:0};cj.ExtStet={$:1};cj.ExtNA={$:0};ck.ExnStet={$:1};ck.ExnNA={$:0};cl.ExiStet={$:1};cl.ExiNA={$:0};cm.New=function(d1,d2,d3){return{sliDims:d1,calculation:d2,cube:d3};};cn.ForAll={$:2};cn.ForConsolidated={$:1};cn.ForBase={$:0};co.New=function(d1,d2,d3,d4,d5,d6,d7,d8){return{forId:d1,forDestDecl:d2,forDestination:d3,forDescription:d4,forText:d5,forExpression:d6,forType:d7,forOrder:d8};};cp.New=function(d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea){return{calId:d1,calName:d2,calDescription:d3,calOrder:d4,format:d5,isText:d6,isInput:d7,isBalance:d8,calDims:d9,calFormulas:d_,cubIdO:d$,properties:ea};};cq.New=function(d1,d2,d3,d4,d5){return{totId:d1,totName:d2,totOrder:d3,totFormat:d4,children:d5};};cr.ConsolidatedRuleKey={$:6};cr.InputRuleKey={$:5};cr.ActualRuleKey={$:4};cs.New=function(d1,d2,d3,d4,d5,d6,d7){return{cubId:d1,cubName:d2,cubRules:d3,cubRuleXmls:d4,cubDims:d5,measureDim:d6,cubType:d7};};ct.New=function(d1,d2,d3,d4,d5,d6,d7,d8){return{rulId:d1,rulSourceId:d2,rulDescription:d3,rulDestination:d4,rulExpression:d5,rulType:d6,rulOrder:d7,rulXml:d8};};cu.GetInitModelStats={$:0};cv.New=function(d1,d2,d3,d4,d5,d6){return{modId:d1,server:d2,actualElem:d3,modDims:d4,modCubes:d5,modCalculations:d6};};cw.HelperTypeN={$:0};cw.op_AmpPercentGreater=function(d1,d2){return d2;};cw.op_AmpPercentGreater$1=function(d1,d2){return{$:2,$0:b2.calcSlice(d2)};};cw.op_AmpPercentGreater$2=function(d1,d2){return{$:2,$0:d2};};cw.op_AmpPercentGreater$3=function(d1,d2){return{$:3,$0:d2};};cw.op_AmpPercentGreater$4=function(d1,d2){return{$:3,$0:d2};};cw.op_AmpPercentGreater$5=function(d1,d2){return{$:3,$0:d2?1:0};};cx.HelperTypeT={$:0};cx.op_AmpAmpGreater=function(d1,d2){return d2;};cx.op_AmpAmpGreater$1=function(d1,d2){return{$:2,$0:b2.calcSlice(d2)};};cx.op_AmpAmpGreater$2=function(d1,d2){return{$:2,$0:d2};};cx.op_AmpAmpGreater$3=function(d1,d2){return{$:5,$0:d2.dimId};};cx.op_AmpAmpGreater$4=function(d1,d2){return{$:3,$0:d2};};cy.HelperTypeA={$:0};cz.getDimR=function(d1,d2){return m.ofOption(function(){return{$:0,$0:d1};},cz.getDimO(d1,d2));};cz.getDimO=function(d1,d2){return dg.tryFind(function(d3){return dn.Equals(d3.dimId,d1);},d2.modDims);};cz.getCubeO=function(d1,d2){return dg.tryFind(function(d3){return dn.Equals(d3.cubId,d1);},d2.modCubes);};cA.newElement=function(d1){return cf.New(new b9({$:0,$0:dD.NewGuid()}),new b$({$:0,$0:dD.NewGuid()}),b6.EtString,d1,d1,new dF.New([]),[]);};cB.dimId=function(d1){return d1.$==1?d1.$0:d1.$0;};cC.containsDim=function(d1,d2){return d2.sliDims.ContainsKey(d1);};cC.addRef=function(d1,d2){return cm.New(d2.sliDims.Add(cB.dimId(d1),d1),d2.calculation,d2.cube);};cC.forAll=function(){c$.$cctor();return c$.forAll;};cC.newSlice=function(d1){return cm.New(new dF.New(dg.map(function(d2){return[cB.dimId(d2),d2];},d1)),null,null);};cD.filterSort=function(d1){var d2;d2=cD.filter(d1);return function(d3){return cD.sort(d2(d3));};};cD.sort=function(d1){return dg.sortBy(function(d2){return d2.dimOrder;},d1);};cD.filter=function(d1){function d2(d3){return dg.contains(d3.dimType,d1);}return function(d3){return dg.filter(d2,d3);};};cD.setName=function(d1,d2){return cg.New(d2.dimId,d1,d2.dimPrefix,d2.dimOrder,d2.dimExclude,d2.dimFreeze,d2.dimType,d2.defaultElm,d2.dimElements,d2.dimAttributes,d2.isCalcDim);};cD.dType=function(d1,d2){return cg.New(d2.dimId,d2.dimName,d2.dimPrefix,d2.dimOrder,d2.dimExclude,d2.dimFreeze,d1,d2.defaultElm,d2.dimElements,d2.dimAttributes,d2.isCalcDim);};cD.prefix=function(d1,d2){return cg.New(d2.dimId,d2.dimName,d1,d2.dimOrder,d2.dimExclude,d2.dimFreeze,d2.dimType,d2.defaultElm,d2.dimElements,d2.dimAttributes,d2.isCalcDim);};cD.New=function(d1){return cD.newDimension(new b$({$:0,$0:dD.NewGuid()}),d1,false);};cD.newDimensionCalc=function(d1,d2){return cD.newDimension(d1,d2,true);};cD.newDimensionNonCalc=function(d1,d2){return cD.newDimension(d1,d2,false);};cD.newDimension=function(d1,d2,d3){return cg.New(d1,d2,"","",false,false,b3.DtOther,null,[],[],d3);};cD.getElementR=function(d1,d2){return m.ofOption(function(){return{$:2,$0:d2.dimName,$1:d1};},cD.getElementO(d1,d2));};cD.getElementO=function(d1,d2){return dg.tryFind(function(d3){return dn.Equals(d3.elmId,d1);},d2.dimElements);};cE.measureDimNameR=function(d1,d2){return dl.Map(function(d3){return d3.dimName;},cE.measureDimR(d1,d2));};cE.measureDimR=function(d1,d2){return dl.Bind(function(d3){return cz.getDimR(d3,d1);},m.ofOption(function(){return{$:4,$0:d2.cubName};},d2.measureDim));};cE.measureDimO=function(d1,d2){var d3;d3=d2.measureDim;return d3==null?null:cz.getDimO(d3.$0,d1);};cE.dims=function(d1,d2){return di.filter(function(d3){var d4;return di.exists((d4=d3.dimId,function(d5){return dn.Equals(d4,d5);}),d2.cubDims);},d1.modDims);};cE.forElr=function(d1,d2){var d3;d3=cE.slice(d2);return cm.New(b2.Map_adds(dh.map(function(d4){return[cB.dimId(d4),d4];},d1),cE.slice(d2).sliDims),d3.calculation,d3.cube);};cE.addRules=function(d1,d2){return cs.New(d2.cubId,d2.cubName,dg.fold(function(d3,d4){return d3.Add(d4[0],d4[1]);},d2.cubRules,d1),d2.cubRuleXmls,d2.cubDims,d2.measureDim,d2.cubType);};cE.addRule=function(d1,d2,d3){return cs.New(d3.cubId,d3.cubName,d3.cubRules.Add(d1,d2),d3.cubRuleXmls,d3.cubDims,d3.measureDim,d3.cubType);};cE.New=function(){return(((cE.newCube(""))([]))(null))(b4.CtOther);};cE.newCubeDims=function(d1,d2,d3){return(((cE.newCube(d1))(di.ofSeq(dg.map(function(d4){return d4.dimId;},d2))))(d3))(b4.CtOther);};cE.newCubeCalc=function(d1,d2,d3){return(((cE.newCube(d1))(d2))(d3))(b4.CtCalc);};cE.newCube=function(d1){var d2;d2=new b_({$:0,$0:dD.NewGuid()});return dd.Curried(cE.newCubeId,3,[d2,d1]);};cE.newCubeId=function(d1,d2,d3,d4,d5){return cs.New(d1,d2,new dF.New([]),new dF.New([]),d3,d4,d5);};cE.isCalcCube=function(d1){return d1.cubType.$===1;};cE.containsDim=function(d1,d2){return dg.contains(d1,d2.cubDims);};cE.slice=function(d1){return cm.New(new dF.New([]),null,{$:1,$0:d1.cubId});};cF.sort=function(d1){return dg.sortBy(function(d2){return d2.calOrder;},d1);};cF.cubeR=function(d1){return(b2.ofOptF(function(){return(function(d2){return function(d3){return d2("Calculation '"+de.toSafe(d3)+"' has no cube");};}(a.id))(d1.calName);}))(d1.cubIdO);};cF.withCube=function(d1,d2,d3){var d4,d5;d4=(d5=d2.cube,d5==null?null:cz.getCubeO(d5.$0,d1));return d4==null?null:d3(d4.$0);};cF.addFormulas=function(d1,d2){return dg.isEmpty(d1)?d2:cp.New(d2.calId,d2.calName,d2.calDescription,d2.calOrder,d2.format,d2.isText,d2.isInput,d2.isBalance,d2.calDims,d2.calFormulas.concat(di.ofSeq(d1)),d2.cubIdO,d2.properties);};cF.forSlice=function(d1,d2){var d3;d3=cF.slice(d2);return cm.New(b2.Map_adds(dh.map(function(d4){return[cB.dimId(d4),d4];},d1),cF.slice(d2).sliDims),d3.calculation,d3.cube);};cF.addFormula=function(d1,d2){return cp.New(d2.calId,d2.calName,d2.calDescription,d2.calOrder,d2.format,d2.isText,d2.isInput,d2.isBalance,d2.calDims,d2.calFormulas.concat([d1]),d2.cubIdO,d2.properties);};cF.setOrder=function(d1,d2){return cp.New(d2.calId,d2.calName,d2.calDescription,d1,d2.format,d2.isText,d2.isInput,d2.isBalance,d2.calDims,d2.calFormulas,d2.cubIdO,d2.properties);};cF.setIsText=function(d1,d2){return cp.New(d2.calId,d2.calName,d2.calDescription,d2.calOrder,d2.format,d1,d2.isInput,d2.isBalance,d2.calDims,d2.calFormulas,d2.cubIdO,d2.properties);};cF.setName=function(d1,d2){return cp.New(d2.calId,d1,d2.calDescription,d2.calOrder,d2.format,d2.isText,d2.isInput,d2.isBalance,d2.calDims,d2.calFormulas,d2.cubIdO,d2.properties);};cF.New=function(){return cF.newInput(new ca({$:0,$0:dD.NewGuid()}),"",[]);};cF.newCalc=function(d1,d2,d3){var d4;d4=cF.newInput(d1,d2,d3);return cp.New(d4.calId,d4.calName,d4.calDescription,d4.calOrder,d4.format,d4.isText,false,d4.isBalance,d4.calDims,d4.calFormulas,d4.cubIdO,d4.properties);};cF.newInput=function(d1,d2,d3){return cp.New(d1,df.Trim(df.Replace(d2,"_"," ")),"","","#,##0.00",false,true,false,new dG.New(d3),[],null,new dF.New([]));};cF.calcType=function(d1){return d1.isInput?"INPUT":"CALC";};cF.slice=function(d1){return b2.calcSlice(d1);};cG.New=function(){return cG.newTotal("");};cG.newTotal=function(d1){return cq.New(new cb({$:0,$0:dD.NewGuid()}),d1,"","",[]);};cH.addRules=function(d1,d2){return dg.fold(function(d3,d4){var d5,d6;function d7(d8,d9,d_){return[d9,d_];}d5=(d6=((cH.getCubeO())(d4[0]))(d3),d6==null?null:{$:1,$0:cH.setCube(cE.addRules(dg.map(function(d8){return d7(d8[0],d8[1],d8[2]);},d4[1]),d6.$0),d3)});return d5==null?d3:d5.$0;},d2,dg.groupBy(function(d3){return a.id(d3[0],d3[1],d3[2]);},d1));};cH.prepareModel=function(d1){return cH.fixCalcsAndCubes(cH.fixForDimensions(d1));};cH.fixCalcsAndCubes=function(d1){var d2,d3;function d4(d6){return cH.getCalcCube(d6,d1);}function d5(d6){return d6==null;}d2=di.filter(function(d6){var d7;return(d7=d6.cubIdO,d7==null?null:((cH.getCubeO())(d7.$0))(d1))==null;},d1.modCalculations);return dg.isEmpty(d2)?d1:(d3=dg.fold(function(d6,d7){return cH.newCalcCube(d7,d6);},d1,dg.filter(function(d6){return d5(d4(d6));},dg.distinct(dg.map(function(d6){return d6.calDims;},d2)))),cv.New(d3.modId,d3.server,d3.actualElem,d3.modDims,d3.modCubes,di.map(function(d6){var d7,d8,d9,d_;d7=(d8=dg.tryFind(function(d$){return dn.Equals(d$.calId,d6.calId);},d2),d8==null?null:{$:1,$0:(d9=d8.$0,cp.New(d9.calId,d9.calName,d9.calDescription,d9.calOrder,d9.format,d9.isText,d9.isInput,d9.isBalance,d9.calDims,d9.calFormulas,(d_=cH.getCalcCube(d9.calDims,d3),d_==null?null:{$:1,$0:d_.$0.cubId}),d9.properties))});return d7==null?d6:d7.$0;},d3.modCalculations)));};cH.newCalcCube=function(d1,d2){var d3,d4,d5;d3=cH.autoName(d1,d2);d4=cD.newDimensionCalc(new b$({$:0,$0:dD.NewGuid()}),cH.measurePrefix()+d3);d5=di.ofSeq(dg.map(function(d6){return d6.dimId;},dg.append(cH.orderedDims(d1,d2),dh.ofArray([d4]))));return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims.concat([d4]),d2.modCubes.concat([cE.newCubeCalc(cH.cubePrefix()+d3,d5,{$:1,$0:d4.dimId})]),d2.modCalculations);};cH.fixForDimensions=function(d1){return cv.New(d1.modId,d1.server,d1.actualElem,d1.modDims,d1.modCubes,di.map(function(d2){return cp.New(d2.calId,d2.calName,d2.calDescription,d2.calOrder,d2.format,d2.isText,d2.isInput,d2.isBalance,dH.Filter(function(d3){return dg.exists(function(d4){return dn.Equals(d3,d4);},cH.dimIds(d1));},d2.calDims),d2.calFormulas,d2.cubIdO,d2.properties);},d1.modCalculations));};cH.dimIds=function(d1){return di.map(function(d2){return d2.dimId;},d1.modDims);};cH.autoName=function(d1,d2){var d3,d4,d5;d3=df.concat("",dg.map(function(d6){return d6.dimPrefix;},cH.orderedDims(d1,d2)));d4=dg.choose(function(d6){var d7,d8;d7=cH.cubePrefix()+d3;return d6.cubName===d7?{$:1,$0:-1}:df.StartsWith(d6.cubName,d7)?(d8=_do.string(d6.cubName,{$:1,$0:d3.length+1},null),(U.parseIntO$1())(d8)):null;},d2.modCubes);return d3+(dg.isEmpty(d4)?"":(d5=1+dg.max(d4),(function(d6){return function(d7){return d6(a.String(d7));};}(a.id))(d5)));};cH.orderedDims=function(d1,d2){return dg.filter(function(d3){var d4;return dg.exists((d4=d3.dimId,function(d5){return dn.Equals(d4,d5);}),d1);},d2.modDims);};cH.measurePrefix=function(){c$.$cctor();return c$.measurePrefix;};cH.cubePrefix=function(){c$.$cctor();return c$.cubePrefix;};cH.dimCombinations=function(d1){return dg.distinct(dg.map(function(d2){return d2.calDims;},d1.modCalculations));};cH.withDims=function(d1,d2,d3){return cH.withDimsO(d1,d2,dd.Curried(function(d4,d5,d6,d7){return{$:1,$0:d3(d4,d5,d6,d7)};},4));};cH.withDimsO=function(d1,d2,d3){var d4;return i.join(i.apply(i.apply(i.apply(i.apply({$:1,$0:d3},(d4=d2.measureDim,d4==null?null:((cH.getDimO())(d4.$0))(d1))),cH.dataTypeDimO(d1)),cH.versionDimO(d1)),cH.timeDimO(d1)));};cH.setCube=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,di.map(function(d3){return dn.Equals(d3.cubId,d1.cubId)?d1:d3;},d2.modCubes),d2.modCalculations);};cH.getCalcCube=function(d1,d2){return dg.tryFind(function(d3){return dn.Equals(new dG.New(dg.filter(function(d4){return!dn.Equals({$:1,$0:d4},d3.measureDim);},d3.cubDims)),d1);},dg.filter(cE.isCalcCube,d2.modCubes));};cH.isActualCalcO=function(d1){return cH.pickCalcO("IsActual",d1);};cH.versionDimO=function(d1){return cH.pickDimO(b3.DtVersion,d1);};cH.timeDimO=function(d1){return cH.pickDimO(b3.DtTime,d1);};cH.dataTypeDimO=function(d1){return cH.pickDimO(b3.DtDataType,d1);};cH.tCalcDimO=function(d1){return cH.pickDimO(b3.DtTCalc,d1);};cH.freezeCubeO=function(d1){return cH.pickCubeO(b4.CtFreeze,d1);};cH.pickCalcO=function(d1,d2){return dg.tryPick(function(d3){return d3.calName===d1?{$:1,$0:d3}:null;},d2.modCalculations);};cH.pickDimO=function(d1,d2){return dg.tryPick(function(d3){return dn.Equals(d3.dimType,d1)?{$:1,$0:d3}:null;},d2.modDims);};cH.pickCubeO=function(d1,d2){return dg.tryPick(function(d3){return dn.Equals(d3.cubType,d1)?{$:1,$0:d3}:null;},d2.modCubes);};cH.getCubeR=function(d1,d2){return m.ofOption(function(){return{$:3,$0:d1};},((cH.getCubeO())(d1))(d2));};cH.getCalcR=function(d1,d2){return m.ofOption(function(){return{$:5,$0:d1};},cH.getCalcO(d1,d2));};cH.getCubeO=function(){c$.$cctor();return c$.getCubeO;};cH.getCalcO=function(d1,d2){return dg.tryFind(function(d3){return dn.Equals(d3.calId,d1);},d2.modCalculations);};cH.getDimR=function(){c$.$cctor();return c$.getDimR;};cH.getDimO=function(){c$.$cctor();return c$.getDimO;};cH.addForm=function(d1,d2,d3){return cv.New(d3.modId,d3.server,d3.actualElem,d3.modDims,d3.modCubes,di.map(function(d4){return dn.Equals(d4.calId,d1)?cF.addFormula(d2,d4):d4;},d3.modCalculations));};cH.addCube=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,d2.modCubes.concat([d1]),d2.modCalculations);};cH.addDim=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims.concat([d1]),d2.modCubes,d2.modCalculations);};cH.addCalc=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,d2.modCubes,d2.modCalculations.concat([d1]));};cH.addForms=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,d2.modCubes,di.map(function(d3){var d4,d5;function d6(d7){return d7[0];}return cF.addFormulas(dg.map(function(d7){return d7[1];},dg.filter((d4=(d5=d3.calId,function(d7){return dn.Equals(d5,d7);}),function(d7){return d4(d6(d7));}),d1)),d3);},d2.modCalculations));};cH.addCubes=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,cH.mergeBy(function(d3){return d3.cubId;},d1,d2.modCubes),d2.modCalculations);};cH.addDims=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,cH.mergeBy(function(d3){return d3.dimId;},d1,d2.modDims),d2.modCubes,d2.modCalculations);};cH.addCalcs=function(d1,d2){return cv.New(d2.modId,d2.server,d2.actualElem,d2.modDims,d2.modCubes,cH.mergeBy(function(d3){return d3.calId;},d1,d2.modCalculations));};cH.mergeBy=function(d1,d2,d3){return di.ofSeq(d2).concat(di.filter(function(d4){return!dg.contains(d1(d4),dg.map(d1,d2));},d3));};cI.getDimDest=function(d1,d2){return dg.tryPick(function(d3){return dn.Equals(cB.dimId(d3),d1.dimId)?{$:1,$0:d3}:null;},d2.forDestination);};cI.setOrder=function(d1,d2){return co.New(d2.forId,d2.forDestDecl,d2.forDestination,d2.forDescription,d2.forText,d2.forExpression,d2.forType,d1);};cI.setText=function(d1,d2){return co.New(d2.forId,d2.forDestDecl,d2.forDestination,d2.forDescription,d1,d2.forExpression,d2.forType,d2.forOrder);};cI.conso=function(d1){return co.New(d1.forId,d1.forDestDecl,d1.forDestination,d1.forDescription,d1.forText,d1.forExpression,cn.ForConsolidated,d1.forOrder);};cJ.conso=function(d1){return ct.New(d1.rulId,d1.rulSourceId,d1.rulDescription,d1.rulDestination,d1.rulExpression,cn.ForConsolidated,d1.rulOrder,d1.rulXml);};cJ.New=function(){return ct.New(new cd({$:0,$0:dD.NewGuid()}),null,"",dh.T.Empty,cl.ExiStet,cn.ForBase,"","");};cK.New=function(){return ce.New(new b8({$:0,$0:dD.NewGuid()}),"",b5.AtString,1);};b2.ofOptS=function(d1){function d2(){return new e({$:4,$0:d1});}return function(d3){return m.ofOption(d2,d3);};};b2.ofOptF=function(d1){function d2(){return new e({$:4,$0:d1()});}return function(d3){return m.ofOption(d2,d3);};};b2.calcSlice=function(d1){return cm.New(new dF.New([]),{$:1,$0:d1.calId},null);};b2.Map_adds=function(d1,d2){return new dF.New(dg.append(dI.ToSeq(d2),d1));};b2.Xmodel=function(){c$.$cctor();return c$.Xmodel;};cM.Subtract={$:2};cM.Add={$:1};cM.Zero={$:0};cN.New=function(d1,d2,d3,d4,d5){return{nid:d1,expanded:d2,element:d3,children:d4,weight:d5};};cO.New=function(d1,d2,d3){return{getParentO:d1,getPath:d2,setChildren:d3};};cL.setChildrenEf=function(d1,d2){return x.op_BarGreaterGreater(z.ask(),function(d3){return(d3.setChildren(d1))(d2);});};cL.getPathEf=function(d1){return x.op_BarGreaterGreater(z.ask(),function(d2){return d2.getPath(d1);});};cL.getParentOEf=function(d1){return x.op_BarGreaterGreater(z.ask(),function(d2){return d2.getParentO(d1);});};cP.tryFindNodeCIdEf=function(d1,d2){return cP.tryFindTreeNodeEf(cP.forCId(function(d3){return dn.Equals(d1,d3);}),d2);};cP.tryFindNodeTIdEf=function(d1,d2){return cP.tryFindTreeNodeEf(cP.forTId(function(d3){return dn.Equals(d1,d3);}),d2);};cP.tryFindSelChildEf=function(d1,d2){return x.op_BarGreaterGreater(cP.tryFindSelNodeEf(d1,d2),function(d3){return d3==null?null:{$:1,$0:cP.getElement(d3.$0)};});};cP.tryFindSelNodeEf=function(d1,d2){var d3;return x.op_BarGreaterGreater(t.insertO((d3=d1==null?null:{$:1,$0:d1.$0[0]},d3==null?null:{$:1,$0:cP.tryFindNodeEf(d3.$0,d2)})),function(d4){return d4==null?null:a.id(d4.$0);});};cP.tryFindNodeEf=function(d1,d2){return cP.tryFindTreeNodeEf(function(d3){return dn.Equals(d3.nid,d1);},d2);};cP.tryFindTreeNodeEf=function(d1,d2){return x.op_BarGreaterGreater(Z.tryFind(function(d3){return d1(cP.ofNode(d3));},dg.map(cP.treenode,d2)),function(d3){return d3==null?null:{$:1,$0:cP.ofNode(d3.$0)};});};cP.forCId=function(d1){var d2,d3;function d4(d6){return d6==null?null:{$:1,$0:d1(d6.$0)};}function d5(d6){return d6==null?false:d6.$0;}d2=(d3=function(d6){return cP.getCId(cP.getElement(d6));},function(d6){return d4(d3(d6));});return function(d6){return d5(d2(d6));};};cP.forTId=function(d1){var d2,d3;function d4(d6){return d6==null?null:{$:1,$0:d1(d6.$0)};}function d5(d6){return d6==null?false:d6.$0;}d2=(d3=function(d6){return cP.getTId(cP.getElement(d6));},function(d6){return d4(d3(d6));});return function(d6){return d5(d2(d6));};};cP.getCId=function(d1){return d1.$==0?{$:1,$0:d1.$0}:null;};cP.getTId=function(d1){return d1.$==1?{$:1,$0:d1.$0}:null;};cP.getElement=function(d1){return d1.element;};cP.removeNodesEf=function(d1,d2){return x.op_BarGreaterGreater(Z.removeNodes(function(d3){return d1(cP.ofNode(d3));},dg.map(cP.treenode,d2)),function(d3){return dg.map(cP.ofNode,d3);});};cP.newNodeTot=function(d1){return cP.newTreeNode({$:1,$0:d1});};cP.newNodeCalc=function(d1){return cP.newTreeNode({$:0,$0:d1});};cP.newTreeNode=function(d1){return cN.New({$:0,$0:dD.NewGuid()},true,d1,[],cM.Add);};cP.treenode=function(d1){return _0.New(function(){return d1.nid;},function(){return d1;},function(){return x.rtn(d1.expanded);},function(){return x.rtn(d1.element.$!=0);},function(){return x.rtn(dg.map(cP.treenode,d1.children));},function(){return cL.getPathEf(d1.nid);},function(){return x.op_BarGreaterGreater(cL.getParentOEf(d1.nid),function(d2){return d2==null?null:{$:1,$0:cP.treenode(d2.$0)};});},function(d2){return x.op_BarGreaterGreater(cL.setChildrenEf(d1,dg.map(cP.ofNode,d2)),cP.treenode);});};cP.ofNode=function(d1){return d1.getData();};cR=cQ.HoverProvider=dd.Class({provideHover:function(d1,d2,d3){var d4,d5;d4=d1.getWordAtPosition(d2);return!d4?null:bh.New([be.New((d5=d4.word,(function(d6){return function(d7){return d6("The word is: "+de.toSafe(d7));};}(a.id))(d5)),true)],_.New(d4.startColumn,d4.endColumn,d2.lineNumber,d2.lineNumber));}},l,cR);cR.New=dd.Ctor(function(d1){l.New.call(this);},cR);cS=cQ.CompletionItemProvider=dd.Class({resolveCompletionItem:function(d1,d2){return bg.New(d1.kind,d1.label,"more details");},provideCompletionItems:function(d1,d2,d3,d4){var d5;d5=d1.getWordAtPosition(d2);return!d5?null:[bg.New(2,"Hello",""),bg.New(2,"How",""),bg.New(2,"Are",""),bg.New(2,"You",""),bg.New(2,d5.word,"")];}},l,cS);cS.New=dd.Ctor(function(d1){l.New.call(this);},cS);cT=cQ.DefinitionProvider=dd.Class({provideDefinition:function(d1,d2,d3){var d4,d5;d4=d1.getWordAtPosition(d2);return!d4?null:(d5=d1.findMatches(d4.word,false,false,true," <>()+-=.,/#@$%^&*\"",false,1),di.length(d5)===0?null:ba.New(di.get(d5,0).range,d1.uri));}},l,cT);cT.New=dd.Ctor(function(d1){l.New.call(this);},cT);cQ.monacoNew=function(d1,d2,d3,d4){return _8.onRender(function(d5){var d6,d7,d8,d9;function d_(ed,ee,ef){return d7.provideHover(ed,ee,ef);}function d$(ed,ee,ef,eg){return d8.provideCompletionItems(ed,ee,ef,eg);}function ea(ed,ee){return d8.resolveCompletionItem(ed,ee);}function eb(ed,ee,ef){return d9.provideDefinition(ed,ee,ef);}function ec(ed){var ee;ee=d5.getModel();self.monaco.editor.setModelMarkers(ee,"annotations",ed);}d6=d5.getModel();self.monaco.editor.setModelLanguage(d6,"fsharp");self.monaco.editor.setTheme("vs-dark");d7=new cR.New(d5);d8=new cS.New(d5);d9=new cT.New(d5);c.print$1(function(ed){return d_(ed[0],ed[1],ed[2]);});c.print$1(function(ed){return d$(ed[0],ed[1],ed[2],ed[3]);});c.print$1(function(ed){return ea(ed[0],ed[1]);});c.print$1(function(ed){return eb(ed[0],ed[1],ed[2]);});self.monaco.languages.registerHoverProvider("fsharp",d7);self.monaco.languages.registerCompletionItemProvider("fsharp",d8);self.monaco.languages.registerDefinitionProvider("fsharp",d9);(i.iter(function(ed){du.Sink(ec,ed);}))(d2);},_8.newVar(d1));};cQ.transformAnnotations=function(d1){var d2,d3;function d4(d5,d6,d7,d8,d9,d_){return bf.New(d7,d9,d6,d8,d5==="Err"?8:d5==="Warn"?4:d5==="Hint"?1:2,d_);}d2="(Err|Warn|Info|Hint) \\((\\d+)\\,\\s*(\\d+)\\) - \\((\\d+)\\,\\s*(\\d+)\\)\\: \"([^\"]+?)\"\\.";return di.map(function(d5){return d4(d5[0],d5[1],d5[2],d5[3],d5[4],d5[5]);},di.choose(function(d5){var d6,d7,d8;return(d7=_1.REGEX$2(d2,"",d5),d7!=null&&d7.$==1&&((d8=d7.$0,!dn.Equals(d8,null)&&d8.length===7)&&(d6=[di.get(d7.$0,3),di.get(d7.$0,2),di.get(d7.$0,6),di.get(d7.$0,5),di.get(d7.$0,4),di.get(d7.$0,1)],true)))?{$:1,$0:[d6[5],dm.toInt(a.Number(d6[1])),dm.toInt(a.Number(d6[0])),dm.toInt(a.Number(d6[4])),dm.toInt(a.Number(d6[3])),d6[2]]}:null;},(d3=_1.REGEX$2(d2,"g",d1),d3!=null&&d3.$==1?d3.$0:[])));};cQ.annotationsV=function(){c$.$cctor();return c$.annotationsV;};cU.New=function(d1,d2,d3,d4){return{major:d1,minor:d2,majorDate:d3,minorDate:d4};};cV.incrementMajor=function(d1){return cU.New(d1.major+1,0,function(d2){return d2.getFullYear()+"-"+("0"+(d2.getMonth()+1)).slice(-2)+"-"+("0"+d2.getDay()).slice(-2)+" "+("0"+d2.getHours()).slice(-2)+":"+("0"+d2.getMinutes()).slice(-2)+":"+("0"+d2.getSeconds()).slice(-2)+":"+("00"+d2.getMilliseconds()).slice(-3);}(new a.Date(dJ.now())),function(d2){return d2.getFullYear()+"-"+("0"+(d2.getMonth()+1)).slice(-2)+"-"+("0"+d2.getDay()).slice(-2)+" "+("0"+d2.getHours()).slice(-2)+":"+("0"+d2.getMinutes()).slice(-2)+":"+("0"+d2.getSeconds()).slice(-2)+":"+("00"+d2.getMilliseconds()).slice(-3);}(new dJ(dJ.now())));};cV.incrementMinor=function(d1){return cU.New(d1.major,d1.minor+1,d1.majorDate,function(d2){return d2.getFullYear()+"-"+("0"+(d2.getMonth()+1)).slice(-2)+"-"+("0"+d2.getDay()).slice(-2)+" "+("0"+d2.getHours()).slice(-2)+":"+("0"+d2.getMinutes()).slice(-2)+":"+("0"+d2.getSeconds()).slice(-2)+":"+("00"+d2.getMilliseconds()).slice(-3);}(new dJ(dJ.now())));};cV.New=function(){return cU.New(0,0,"","");};cW.New=function(d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg){return{treeHierarchy:d1,calculations:d2,totals:d3,dimensions:d4,cubes:d5,globalDefs:d6,server:d7,selection:d8,selectedDim:d9,selectedCube:d_,collapsed:d$,cubePrefix:ea,measurePrefix:eb,outputMsgs:ec,codeFS:ed,parserMsgs:ee,fileName:ef,version:eg};};cX.NoOp={$:28};cX.AddDimension={$:17};cX.AddCalculation={$:3};cX.AddTotal={$:0};cY.getDimsCubeO=a.id;cY.setHierarchy=function(d1,d2){d1.treeHierarchy.Set(di.ofSeq(d2));};cY.refreshNow=function(){c$.$cctor();return c$.refreshNow;};cY.refreshView=function(){c$.$cctor();return c$.refreshView;};cY.isNodeFormSelected=function(d1,d2,d3){return dn.Equals(d3,{$:1,$0:[d2,{$:1,$0:d1}]});};cY.nonFormulaV=function(){c$.$cctor();return c$.nonFormulaV;};cY.nonCalculationV=function(){c$.$cctor();return c$.nonCalculationV;};cY.nonTotalV=function(){c$.$cctor();return c$.nonTotalV;};cY.nonFormula=function(){c$.$cctor();return c$.nonFormula;};cY.nonCalculation=function(){c$.$cctor();return c$.nonCalculation;};cY.nonTotal=function(){c$.$cctor();return c$.nonTotal;};cY.selectedString=function(d1,d2){return du.Map(function(d3){return d3?d1:"";},d2);};cY.isNodeSelected=function(d1,d2){var d3;d3=d2==null?null:{$:1,$0:dn.Equals(d1,d2.$0[0])};return d3==null?false:d3.$0;};cZ.appendParser=function(d1){cZ.appendText(cZ.model().parserMsgs,d1);};cZ.appendMsgs=function(d1){cZ.appendText(cZ.model().outputMsgs,d1);};cZ.appendText=function(d1,d2){var d3;d1.Set((d3=d1.Get(),d3===""?d2:d2===""?d3:d3+"\n"+d2));};cZ.processor=function(){c$.$cctor();return c$.processor;};cZ.set_processor=function(d1){c$.$cctor();c$.processor=d1;};cZ.model=function(){c$.$cctor();return c$.model;};c1.InFsCode={$:5};c1.InGlobalDefs={$:2};c2.New=function(d1,d2,d3){return{lines:d1,indent:d2,location:d3};};c0.fsCodeVO=function(){c$.$cctor();return c$.fsCodeVO;};c0.fsCode=function(){var d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb;d1=(d2=du.get_Do(),du.Bind(function(ec){return du.Bind(function(ed){return du.Const(c0.txtLocn(c1.InFsCode,c0.preface(ec.major,ed)));},cZ.model().server.get_View());},cZ.model().version.get_View()));d3=c0.mapSeqCached(cD.sort,c0.newDimS,cZ.model().dimensions);d4=c0.mapSeqCached(a.id,c0.newMeasureDimS,cZ.model().cubes);d5=c0.mapSeqCached(a.id,c0.newCubeS,cZ.model().cubes);d6=c0.mapSeqCachedW(a.id,c0.newCalcSW,cZ.model().calculations);d7=c0.mapSeqCached(a.id,c0.getForms,cZ.model().calculations);d8=du.Map(function(ec){return c0.txtLocn(c1.InGlobalDefs,S.indent$1(4,ec));},cZ.model().globalDefs.get_View());d9=du.Map(function(ec){return c0.txtLocn(c1.InFsCode,ec);},d4);d_=du.Map(function(ec){return c0.txtLocn(c1.InFsCode,ec);},d5);d$=du.Map(function(ec){return c0.groupLocns(dg.collect(a.id,ec));},d7);ea=du.Map(c0.groupLoc1s,d3);eb=du.Map(c0.groupLoc1s,d6);return du.Map(c0.collectCode,du.Sequence(dh.ofArray([d1,ea,d9,du.Const(c0.txtLoc1(c1.InFsCode,"    addDims()")),d_,du.Const(c0.txtLoc1(c1.InFsCode,"    addCubes()")),eb,du.Const(c0.txtLoc1(c1.InFsCode,"    addCalcs()")),d8,d$,du.Const(c0.txtLoc1(c1.InFsCode,"    addFrms()"))])));};c0.collectCode=function(d1){var d2;function d3(d5){return d5[0];}function d4(d5){return""!==d5;}d2=di.unzip(di.ofSeq(dg.filter(function(d5){return d4(d3(d5));},d1)));return[df.concat("\n",d2[0]),di.collect(a.id,d2[1])];};c0.groupLocns=function(d1){function d2(d3,d4){return c0.loc(d4,dg.length(df.SplitChars(d3,["\n"],0)));}return[df.concat("\n",dg.map(function(d3){return d3[0];},d1)),di.ofSeq(dg.map(function(d3){return d2(d3[0],d3[1]);},d1))];};c0.groupLoc1s=function(d1){function d2(d3,d4){return c0.loc(d4,1);}return[df.concat("\n",dg.map(function(d3){return d3[0];},d1)),di.ofSeq(dg.map(function(d3){return d2(d3[0],d3[1]);},d1))];};c0.txtLoc1=function(d1,d2){return c0.txtLocn(d1,dh.ofArray([d2]));};c0.txtLocn=function(d1,d2){return[df.concat("\n",d2),[c0.loc(d1,dg.length(d2))]];};c0.loc=function(d1,d2){return c2.New(d2,4,d1);};c0.bindSeqCached=function(d1,d2,d3){function d4(d5){return d5==null?null:d2(d5.$0);}return c0.viewSeqChoose(c0.mapSeqCached0(d1,function(d5){return du.Map(d4,d5);},d3));};c0.mapSeqCachedW=function(d1,d2,d3){function d4(d5){return c0.optviewMerge(d2,d5);}return c0.viewSeqChoose(c0.mapSeqCached0(d1,function(d5){return du.Bind(d4,d5);},d3));};c0.mapSeqCached=function(d1,d2,d3){function d4(d5){return d5==null?null:{$:1,$0:d2(d5.$0)};}return c0.viewSeqChoose(c0.mapSeqCached0(d1,function(d5){return du.Map(d4,d5);},d3));};c0.viewSeqChoose=function(d1){return du.Map(function(d2){return dg.choose(a.id,d2);},du.Join(du.Map(du.Sequence,d1)));};c0.optviewMerge=function(d1,d2){return d2!=null&&d2.$==1?du.Map(function(d3){return{$:1,$0:d3};},d1(d2.$0)):du.Const(null);};c0.mapSeqCached0=function(d1,d2,d3){var d4,d5;function d6(d7){return d3.TryFindByKeyAsView(d7);}return du.MapSeqCachedBy(d3.key,(d4=(d5=d3.key,function(d7){return d6(d5(d7));}),function(d7){return d2(d4(d7));}),du.Map(d1,d3.v));};c0.fsCodeForCalc=function(d1){var d2,d3,d4,d5,d6;d2=df.concat("\n",dg.map(function(d7){return d7[0];},c0.getForms(d1)));d3=(d4=(d5=du.TryGet(c0.newCalcSW(d1)),d5==null?null:{$:1,$0:d5.$0[0]}),d4==null?"View.TryGet failed for some reason":d4.$0);return(d6=(function(d7){return function(d8){return d7("\r\n                        module Formula =\r\n                            open FSSGlobal.CalculationModel\r\n                            open CalculationModel\r\n                            open CalculationSyntax\r\n                            open InitModel\r\n                            open System \r\n                            open Definition"+a.String(d8)+"\n");};}(a.id))(cZ.model().version.Get().major),(S.unindentStr$1())(d6))+d3+"\n    addCalcs()\n"+d2+"\n    addFrms() "+"\n    ";};c0.preface=function(d1,d2){var d3;return S.unindent$1((d3=(((dd.Curried3(function(d4,d5,d6){return d4("\r\n                #nowarn \"86\"\r\n                #r @\"..\\CalculationModelDll\\CalculationModelDll.dll\"\r\n                module Definition"+a.String(d5)+" =\r\n                    open FSSGlobal.CalculationModel\r\n                    open CalculationModel\r\n                    open CalculationSyntax\r\n                    open InitModel\r\n                    open System\r\n                    \r\n                    let NoCubeYet = newCube (CubId <| Guid.NewGuid()) \"NOCUBEYET\" CtCalc [] None\r\n                    \r\n                    {\r\n                        modId           = ModId <| System.Guid.NewGuid()\r\n                        server          = @"+de.prettyPrint(d6)+"\r\n                        actualElem      = \"Actual\"\r\n                        modCubes        = [| |]\r\n                        modDims         = [| |]\r\n                        modCalculations = [| |]\r\n                    } |> setInitModel\r\n                        ");}))(a.id))(d1))(d2),(c0.trace())(d3)));};c0.getForms=function(d1){return di.ofSeq(dg.map(function(d2){return c0.newFormS(d2[0],d2[1]);},dg.map(function(d2){return[d1,d2];},dg.sortBy(function(d2){return d2.forOrder;},d1.calFormulas))));};c0.newFormS=function(d1,d2){var d3,d4;d3=c0.prepareFormula(d2.forText);return[(d4=df.concat("\n",dh.ofSeq(dg.delay(function(){return dg.append(d3,dg.delay(function(){return[(((((((dd.Curried(function(d5,d6,d7,d8,d9,d_,d$){return d5("    |> newForm (ForId (Guid.Parse "+de.prettyPrint(d6)+")) "+de.toSafe(d7)+" "+de.toSafe(d8)+" "+de.toSafe(d9)+" "+de.prettyPrint(d_)+" "+de.prettyPrint(d$)+" ");},7))(a.id))(d2.forId.get_Id()))(c0.fixName(d1.calName)))((function(d5){return function(d6){return d5(da.p$4(d6));};}(a.id))(d2.forType)))(c0.getDest(d2)))(d2.forOrder))(c["String.Left$1"](c0.fixText(d3),495))];}));}))),(c0.trace())(d4)),{$:3,$0:d2.forId}];};c0.fixText=function(d1){return df.concat(" ",dg.map(function(d2){return df.Replace(df.Replace(d2,"\\","\\\\"),"\"","\\\"");},dg.map(S.trim$1,d1)));};c0.prepareFormula=function(d1){return dg.map(function(d2){return"    "+d2;},S.unindent$1(df.Replace(df.Replace(df.Replace(d1,"@=","&="),"@<","&<"),"@>","&>")));};c0.getDest=function(d1){var d2;d2=df.concat(" ; ",dg.choose(function(d3){var d4;d4=c0.getDimO(d3.K);return d4==null?null:{$:1,$0:(((dd.Curried3(function(d5,d6,d7){return d5(de.toSafe(d6)+".["+de.prettyPrint(d7)+"]");}))(a.id))(d4.$0.dimName))(d3.V)};},d1.forDestDecl));return(function(d3){return function(d4){return d3("[ "+de.toSafe(d4)+" ]");};}(a.id))(d2);};c0.newCalcSW=function(d1){return du.Map(function(d2){var d3;return[(d3=((((((((dd.Curried(function(d4,d5,d6,d7,d8,d9,d_,d$){return d4("    let "+de.toSafe(d5)+" = newCalc (CalId (Guid.Parse "+de.prettyPrint(d6)+")) "+de.toSafe(d7)+" "+de.prettyPrint(d8)+" "+de.prettyPrint(d9)+" "+de.prettyPrint(d_)+" "+de.toSafe(d$));},8))(a.id))(c0.fixName(d1.calName)))(d1.calId.get_Id()))(d1.isInput?"Input":"Calc"))(d1.calName))(d1.calOrder))(d1.isText))(d2),(c0.trace())(d3)),{$:1,$0:d1.calId}];},c0.getCalcCubeNameW(d1.calDims));};c0.getCalcCubeNameW=function(d1){var d2,d3,d4,d5,d6,d7;function d8(d_){return c0.fixName(d_.cubName);}function d9(d_){return d_==null?"NoCubeYet":d_.$0;}d2=(d3=cZ.model().cubes.TryFindAsView(function(d_){return dn.Equals(new dG.New(d_.cubDims),d1);}),du.Map((d4=(d5=function(d_){return d_==null?null:{$:1,$0:d8(d_.$0)};},function(d_){return d9(d5(d_));}),(d6=c0.trace(),function(d_){return d6(d4(d_));})),d3));d7=[dy.Create$1(null)];du.Sink(function(d_){if(!dn.Equals(d7[0].Get(),d_))d7[0].Set(d_);},d2);return d7[0].get_View();};c0.newCubeS=function(d1){var d2;d2=((((((dd.Curried(function(d3,d4,d5,d6,d7,d8){return d3("    let "+de.toSafe(d4)+" = newCube (CubId (Guid.Parse "+de.prettyPrint(d5)+")) "+de.prettyPrint(d6)+" CtCalc [ "+de.toSafe(d7)+" ] (Some "+de.toSafe(d8)+")");},6))(a.id))(c0.fixName(d1.cubName)))(d1.cubId.get_Id()))(d1.cubName))(c0.getCubeDims(d1)))(c0.fixName(c0.cubeMeasureName(d1)));return(c0.trace())(d2);};c0.getCubeDims=function(d1){var d2;return df.concat(" ; ",dg.append(dg.map(function(d3){return d3.dimName;},dg.choose((d2=cZ.model().dimensions,function(d3){return d2.TryFindByKey(d3);}),d1.cubDims)),dh.ofArray([c0.dimMeasureName(d1.cubName)])));};c0.getMeasureDims=function(){return dg.map(c0.newMeasureDimS,cZ.model().cubes["var"].Get());};c0.newMeasureDimS=function(d1){var d2,d3;d2=(d3=c0.cubeMeasureName(d1),((((((dd.Curried(function(d4,d5,d6,d7,d8,d9){return d4("    let "+de.toSafe(d5)+" = newDim (DimId (Guid.Parse "+de.prettyPrint(d6)+")) "+de.prettyPrint(d7)+" "+da.p$5(d8)+" "+de.prettyPrint(d9));},6))(a.id))(c0.fixName(d3)))(d1.cubId.get_Id()))(d3))(b3.DtCalc))(""));return(c0.trace())(d2);};c0.cubeMeasureName=function(d1){return c0.dimMeasureName(d1.cubName);};c0.dimMeasureName=function(d1){return cZ.model().measurePrefix.Get()+d1.substring(1);};c0.newDimS=function(d1){var d2;return[(d2=((((((dd.Curried(function(d3,d4,d5,d6,d7,d8){return d3("    let "+de.toSafe(d4)+" = newDim (DimId (Guid.Parse "+de.prettyPrint(d5)+")) "+de.prettyPrint(d6)+" "+da.p$5(d7)+" "+de.prettyPrint(d8));},6))(a.id))(c0.fixName(d1.dimName)))(d1.dimId.get_Id()))(d1.dimName))(d1.dimType))(d1.dimExclude?"":d1.dimPrefix),(c0.trace())(d2)),{$:0,$0:d1.dimId}];};c0.fixName=function(d1){return df.Replace(df.Replace(df.Trim(d1)," ","_"),"-","_");};c0.getFormO=function(d1){return dg.tryPick(function(d2){return dg.tryPick(function(d3){return dn.Equals(d3.forId,d1)?{$:1,$0:[d2,d3]}:null;},d2.calFormulas);},cZ.model().calculations["var"].Get());};c0.getCalcO=function(d1){return cZ.model().calculations.TryFindByKey(d1);};c0.getDimO=function(d1){return cZ.model().dimensions.TryFindByKey(d1);};c0.trace=function(){c$.$cctor();return c$.trace;};c3.filterFormula=function(d1,d2){var d3;function d4(d5,d6,d7,d8,d9){return bf.New(d6-1,d8-1,d5-1,d7-1,8,d9);}return di.map(function(d5){return d4(d5[0],d5[1],d5[2],d5[3],d5[4]);},di.choose(function(d5){var d6,d7,d8,d9;return(d7=_1.REGEX$2(c3.rexFormula(),"",d5),d7!=null&&d7.$==1&&((d8=d7.$0,!dn.Equals(d8,null)&&d8.length===7)&&(di.get(d7.$0,3),di.get(d7.$0,4),di.get(d7.$0,5),(d9=di.get(d7.$0,6),(di.get(d7.$0,1),di.get(d7.$0,2),dn.Equals(d2,{$:1,$0:new cc({$:0,$0:d9})})))&&(d6=[di.get(d7.$0,2),di.get(d7.$0,1),di.get(d7.$0,6),di.get(d7.$0,5),di.get(d7.$0,4),di.get(d7.$0,3)],true))))?{$:1,$0:[dm.toInt(a.Number(d6[1])),dm.toInt(a.Number(d6[0])),dm.toInt(a.Number(d6[5])),dm.toInt(a.Number(d6[4])),d6[3]]}:null;},(d3=_1.REGEX$2(c3.rexFormula(),"g",d1),d3!=null&&d3.$==1?d3.$0:[])));};c3.rexFormula=function(){c$.$cctor();return c$.rexFormula;};c3.getHints=function(d1,d2,d3,d4,d5){var d6;function d7(d8){c.print$1(d8);}L.iterA(function(d8){return d7(e.summarized(d8));},a.ignore,(d6=g.asyncResult(),d6.Run(d6.Delay(function(){var d8;return(d8=c0.fsCodeVO(),d8!=null&&d8.$==1)?O["AsyncResultBuilder.Bind"](d6,du.GetAsync(c0.fsCodeVO().$0),function(d9){var d_,d$,ea;function eb(ec,ed){return dn.Equals(ed.location,d1);}d_=dg.tryFind(function(ec){return eb(ec[0],ec[1]);},(dg.mapFold(function(ec,ed){return[[ec,ed],ec+ed.lines];},0,d9[1]))[0]);return d_!=null&&d_.$==1?(d$=d_.$0[1],(ea=_6.getStartWord$1(d3,d5),(((((dd.Curried(function(ec,ed,ee,ef){return ec("getHints '"+de.toSafe(ed)+"' <= "+a.String(ee)+" :"+de.toSafe(ef)+" => ");},4))(function(ec){dr.log(ec);}))(ea))(d5))(d3),d6.Bind$1(bZ.completion(df.replicate(d$.indent," ")+d3,true,c3.parseFile(),d4+1+d_.$0[0],d5+1+d$.indent,""),function(ec){d2(di.map(function(ed){return[ed.ReplacementText,(((dd.Curried3(function(ee,ef,eg){return ee(df.PadRight(de.toSafe(ef),40)+" "+df.PadLeft(de.toSafe(eg),20));}))(a.id))(ed.Name))(c3.getSymbolType(ed.GlyphChar)),ed.Glyph];},ec[0]),[d4,d5-ea.length],[d4,d5]);return d6.Zero();})))):d6.Zero();}):d6.Zero();}))));};c3.getSymbolType=function(d1){return d1==="C"?"class":d1==="Cn"?"Constant":d1==="D"?"delegate":d1==="E"?"enum":d1==="P"?"property":d1==="e"?"event":d1==="X"?"exception":d1==="F"?"field":d1==="I"?"interface":d1==="M"?"function":d1==="N"?"module":d1==="S"?"struct":d1==="T"?"type":d1==="V"?"Variable":d1;};c3.showToolTips=function(d1,d2,d3,d4){var d5;function d6(d7){c.print$1(d7);}L.iterA(function(d7){return d6(e.summarized(d7));},a.ignore,(d5=g.asyncResult(),d5.Run(d5.Delay(function(){var d7;return(d7=c0.fsCodeVO(),d7!=null&&d7.$==1)?O["AsyncResultBuilder.Bind"](d5,du.GetAsync(c0.fsCodeVO().$0),function(d8){var d9,d_,d$,ea,eb,ec,ed,ee,ef,eg;function eh(ei,ej){return dn.Equals(ej.location,d1);}d9=d8[1];d_=dg.tryFind(function(ei){return eh(ei[0],ei[1]);},(dg.mapFold(function(ei,ej){return[[ei,ej],ei+ej.lines];},0,d9))[0]);return d_!=null&&d_.$==1?(d$=d_.$0[1],(ea=d_.$0[0],(eb=df.length(_6.getStartWord$1(d2,d4)),(ec=df.length(_6.getEndWord$1(d2,d4)),(ed=d3+1+ea,(ee=d3+1+ea,(ef=d4-eb+1+d$.indent,(eg=d4+(eb===0&&ec===0?2:ec)+1+d$.indent,d5.Bind$1(bZ.toolTip(c3.parseFile(),ed,ef,""),function(ei){var ej;ej=c3.adaptMessage(d9,ed,ef,ee,eg,df.concat("\n",dg.collect(function(ek){return dh.ofArray([ek.Signature,ek.Comment]);},dg.collect(a.id,ei[0]))));return!(cZ.model().parserMsgs.Get().indexOf(ej)!=-1)?(cZ.appendParser(ej),d5.Zero()):d5.Zero();}))))))))):d5.Zero();}):d5.Zero();}))));};c3.jumpToRef=function(d1){var d2;d2=d1.Target.value;c3.jumpToLine(_do.string(d2,{$:1,$0:_do.string(d2,{$:1,$0:0},{$:1,$0:d1.Target.selectionStart}).lastIndexOf("\n")+1},null));};c3.jumpToLine=function(d1){var d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed;function ee(eg){return!eg;}function ef(eg){return!eg;}d2=_1.REGEX$2((d3=df.concat("|",dh.ofArray([c3.rexGlobal(),c3.rexTotId(),c3.rexCalcId(),c3.rexFormId(),c3.rexDimId()])),(function(eg){return function(eh){return eg("(?:"+de.toSafe(eh)+")");};}(a.id))(d3)),"",d1);d2!=null&&d2.$==1?(d4=di.filter(function(eg){return ef(ee(eg));},di.skip(1,d2.$0)),!dn.Equals(d4,null)&&d4.length===2&&(d6=di.get(d4,0),(di.get(d4,1),d6===c3.sForId()))?(di.get(d4,0),d7={$:11,$0:new cc({$:0,$0:di.get(d4,1)})},(cZ.processor())(d7)):!dn.Equals(d4,null)&&d4.length===2&&(d9=di.get(d4,0),(di.get(d4,1),d9===c3.sCalId()))?(di.get(d4,0),d_={$:8,$0:new ca({$:0,$0:di.get(d4,1)})},(cZ.processor())(d_)):!dn.Equals(d4,null)&&d4.length===2&&(ea=di.get(d4,0),(di.get(d4,1),ea===c3.sTotId()))?(di.get(d4,0),eb={$:1,$0:new cb({$:0,$0:di.get(d4,1)})},(cZ.processor())(eb)):!dn.Equals(d4,null)&&d4.length===2?(ec=di.get(d4,0),(di.get(d4,1),ec===c3.sDimId()))?(di.get(d4,0),ed={$:19,$0:new b$({$:0,$0:di.get(d4,1)})},(cZ.processor())(ed)):void 0:void 0):void 0;};c3.rexDimId=function(){c$.$cctor();return c$.rexDimId;};c3.rexFormId=function(){c$.$cctor();return c$.rexFormId;};c3.rexCalcId=function(){c$.$cctor();return c$.rexCalcId;};c3.rexTotId=function(){c$.$cctor();return c$.rexTotId;};c3.rexGlobal=function(){c$.$cctor();return c$.rexGlobal;};c3.sDimId=function(){c$.$cctor();return c$.sDimId;};c3.sTotId=function(){c$.$cctor();return c$.sTotId;};c3.sCalId=function(){c$.$cctor();return c$.sCalId;};c3.sForId=function(){c$.$cctor();return c$.sForId;};c3.adaptErrors=function(d1,d2){return dg.map(function(d3){return c3.adaptMessage(d1,d3.StartLine,d3.StartColumn,d3.EndLine,d3.EndColumn,d3.Message);},d2.Errors);};c3.parseFile=function(){c$.$cctor();return c$.parseFile;};c3.adaptMessages=function(d1,d2){var d3,d4;d3=".*\\((\\d+),(\\d+)\\) - \\((\\d+),(\\d+)\\) ([^\"]*?)\"(?:\\n|$)";return di.map(function(d5){var d6,d7,d8;return(d7=_1.REGEX$2(d3,"",d5),d7!=null&&d7.$==1&&((d8=d7.$0,!dn.Equals(d8,null)&&d8.length===6)&&(d6=[di.get(d7.$0,2),di.get(d7.$0,4),di.get(d7.$0,1),di.get(d7.$0,3),di.get(d7.$0,5)],true)))?c3.adaptMessage(d1,dm.toInt(a.Number(d6[2])),dm.toInt(a.Number(d6[0])),dm.toInt(a.Number(d6[3])),dm.toInt(a.Number(d6[1])),d6[4]):d5;},(d4=_1.REGEX$2(d3,"g",d2),d4!=null&&d4.$==1?d4.$0:[d2]));};c3.adaptMessage=function(d1,d2,d3,d4,d5,d6){var d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em;function en(eo,ep){return d2-1>=eo&&d2-1<eo+ep.lines;}d7=(d8=dg.tryFind(function(eo){return en(eo[0],eo[1]);},(dg.mapFold(function(eo,ep){return[[eo,ep],eo+ep.lines];},0,d1))[0]),d8==null?null:(d9=d8.$0,(d_=d9[0],(d$=d9[1],(ea=d$.location,ea.$==1?(eb=ea.$0,(ec=c0.getCalcO(eb),ec==null?null:{$:1,$0:((((dd.Curried(function(eo,ep,eq,er){return eo(de.toSafe(ep)+": "+de.prettyPrint(eq)+". "+da.p$1(er));},4))(a.id))(ec.$0.calName))(d6))(eb)})):ea.$==4?(ed=ea.$0,(ee=c0.getFormO(ed),ee==null?null:{$:1,$0:(ef=ee.$0,(eg=ef[0],(ef[1],((((dd.Curried(function(eo,ep,eq,er){return eo(de.toSafe(ep)+": "+de.prettyPrint(eq)+". "+da.p(er));},4))(a.id))(eg.calName))(d6))(ed))))})):ea.$==3?(eh=ea.$0,(ei=c0.getFormO(eh),ei==null?null:{$:1,$0:(ej=ei.$0,(ek=ej[0],(ej[1],((((((((dd.Curried(function(eo,ep,eq,er,es,et,eu,ev){return eo(de.toSafe(ep)+": ("+a.String(eq)+","+a.String(er)+") - ("+a.String(es)+","+a.String(et)+"): "+de.prettyPrint(eu)+". "+da.p(ev));},8))(a.id))(ek.calName))(d2-d_))(d3-d$.indent))(d4-d_))(d5-d$.indent))(d6))(eh))))})):ea.$==5?{$:1,$0:((((((dd.Curried(function(eo,ep,eq,er,es,et){return eo("F# Code ("+a.String(ep)+","+a.String(eq)+") - ("+a.String(er)+","+a.String(es)+"): "+de.prettyPrint(et)+".");},6))(a.id))(d2))(d3))(d4))(d5))(d6)}:ea.$==2?{$:1,$0:((((((dd.Curried(function(eo,ep,eq,er,es,et){return eo("Global  ("+a.String(ep)+","+a.String(eq)+") - ("+a.String(er)+","+a.String(es)+"): "+de.prettyPrint(et)+".");},6))(a.id))(d2-d_))(d3-d$.indent))(d4-d_))(d5-d$.indent))(d6)}:(el=ea.$0,(em=c0.getDimO(el),em==null?null:{$:1,$0:((((dd.Curried(function(eo,ep,eq,er){return eo(de.toSafe(ep)+": "+de.prettyPrint(eq)+". "+da.p$3(er));},4))(a.id))(em.$0.dimName))(d6))(el)})))))));return d7==null?((((((dd.Curried(function(eo,ep,eq,er,es,et){return eo(a.String(ep)+" "+a.String(eq)+" - "+a.String(er)+" "+a.String(es)+" "+de.toSafe(et));},6))(a.id))(d2))(d3))(d4))(d5))(d6):d7.$0;};c4.dtypes=function(){c$.$cctor();return c$.dtypes;};c4.formTypeV=function(d1){return dy.Lens(dy.Lens(d1,function(d2){return d2.forType;},function(d2,d3){return co.New(d2.forId,d2.forDestDecl,d2.forDestination,d2.forDescription,d2.forText,d2.forExpression,d3,d2.forOrder);}),function(d2){return _do.string((function(d3){return function(d4){return d3(da.p$4(d4));};}(a.id))(d2),{$:1,$0:3},null);},function(d2,d3){return d3==="Base"?cn.ForBase:d3==="Consolidated"?cn.ForConsolidated:cn.ForAll;});};c4.calcTypeV=function(d1){return dy.Lens(dy.Lens(d1,function(d2){return d2.isInput;},function(d2,d3){return cp.New(d2.calId,d2.calName,d2.calDescription,d2.calOrder,d2.format,d2.isText,d3,d2.isBalance,d2.calDims,d2.calFormulas,d2.cubIdO,d2.properties);}),function(d2){return d2?"Input":"Calc";},function(d2,d3){return d3!=="Calc";});};c4.currentFormV=function(){c$.$cctor();return c$.currentFormV;};c4.lensForm=function(d1,d2){var d3,d4,d5;d3=dy.Lens(d1,function(d6){return d6.calFormulas;},function(d6,d7){return cp.New(d6.calId,d6.calName,d6.calDescription,d6.calOrder,d6.format,d6.isText,d6.isInput,d6.isBalance,d6.calDims,d7,d6.cubIdO,d6.properties);});d4=(d5=du.get_Do(),du.Bind(function(d6){var d7,d8;return du.Const((d7=d2(),d7==null?null:(d8=d7.$0,dn.Equals(d6.calId,cY.nonCalculation().calId)?null:dg.tryFind(function(d9){return dn.Equals(d9.forId,d8);},d6.calFormulas))));},d1.get_View()));return new dw.New((c4.mapDefW(cY.nonFormula()))(d4),function(d6){var d7;dj.Start((d7=null,dj.Delay(function(){return dj.Bind(du.GetAsync(d4),function(d8){var d9;return d8==null?dj.Zero():(d9=dg.tryFindIndex(function(d_){return dn.Equals(d_.forId,d6.forId);},d3.Get()),(i.iter(function(d_){d3.Set(T.replace(d_,d6,d3.Get()));}))(d9),dj.Zero());});})),null);});};c4.currentCalcV=function(){c$.$cctor();return c$.currentCalcV;};c4.setCurrentCalc=function(d1){var d2;dj.Start((d2=null,dj.Delay(function(){return dj.Bind(du.GetAsync(c4.currentCalcOW()),function(d3){return d3==null?dj.Zero():(cZ.model().calculations.Append(d1),dj.Zero());});})),null);};c4.currentCalcOW=function(){c$.$cctor();return c$.currentCalcOW;};c4.tryFindNode=function(d1){return function(d2){return cP.tryFindNodeEf(d1,d2);};};c4.iterEff=function(d1,d2){c4.runEff(t.map(d1,d2));};c4.runEff=function(d1){return u.run(z.readerHandler(c4.getTreeEffReaderResource(),d1));};c4.getTreeEffReaderResource=function(){return cO.New(c4.getParentO,c4.getPath,function(d1){return function(d2){return c4.setChildren(d1,d2);};});};c4.getPath=function(d1){var d2,d3;d2=c4.getParentO(d1);return d2==null?dh.T.Empty:(d3=d2.$0,new dh.T({$:1,$0:d3.nid,$1:c4.getPath(d3.nid)}));};c4.getParentO=function(d1){var d2;d2=null;return c4.parents().TryGetValue(d1,{get:function(){return d2;},set:function(d3){d2=d3;}})?{$:1,$0:d2}:null;};c4.setChildren=function(d1,d2){function d3(d6){return new dG.New(dg.map(function(d7){return d7.nid;},d6));}function d4(d6){return c4.parents().Remove(d6);}function d5(d6){}dg.iter(function(d6){return d5(d4(d6));},dG.op_Subtraction(d3(d1.children),d3(d2)));dg.iter(function(d6){d.add(d6.nid,d1,c4.parents());},d2);return cN.New(d1.nid,d1.expanded,d1.element,di.ofSeq(d2),d1.weight);};c4.parents=function(){c$.$cctor();return c$.parents;};c4.zx=function(){c$.$cctor();return c$.zx;};c4.mapDefW=function(d1){function d2(d3){return d3==null?d1:d3.$0;}return function(d3){return du.Map(d2,d3);};};c4.scrollIntoView=function(d1,d2){du.Sink(function(d3){if(d3)d2.scrollIntoViewIfNeeded();},d1);};c6.DragNone={$:0};c5.isDragForm=function(d1,d2){return c5.getDragFormO(d1,d2)!=null;};c5.getDragNIdO=function(d1){var d2;return c5.drag().$==1&&(!dn.Equals(c5.drag().$0,d1)&&(d2=c5.drag().$0,true))?{$:1,$0:d2}:null;};c5.getDragFormO=function(d1,d2){var d3,d4,d5;return c5.drag().$==2&&((d4=c5.drag().$1,(d5=c5.drag().$0,!dn.Equals(d2,d4.forId)&&dn.Equals(d5,d1)))&&(d3=[c5.drag().$0,c5.drag().$1],true))?{$:1,$0:d3[1]}:null;};c5.setDragForm=function(d1,d2){c5.set_drag({$:2,$0:d1,$1:d2});};c5.setDragNode=function(d1){c5.set_drag({$:1,$0:d1});};c5.setDragNone=function(){c5.set_drag(c6.DragNone);};c5.drag=function(){c$.$cctor();return c$.drag;};c5.set_drag=function(d1){c$.$cctor();c$.drag=d1;};c7.tableDimensions$4118$48=function(d1){return function(){(cZ.processor())({$:19,$0:d1});};};c7.tableDimensions$4117$48=function(d1){return function(){(cZ.processor())({$:18,$0:d1});};};c7.tableDimensions=function(){var d1,d2,d3,d4,d5;return(d1=(d2=(d3=cZ.model().dimensions,_4.docLensMapView(cD.filterSort(c7.dtypes()),function(d6,d7){var d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh;function ei(ej){return _do.string(ej,{$:1,$0:2},null);}return(d8=(d9=(d_=(d$=dy.Lens(d7,function(ej){return ej.dimFreeze;},function(ej,ek){return cg.New(ej.dimId,ej.dimName,ej.dimPrefix,ej.dimOrder,ej.dimExclude,ek,ej.dimType,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),(ea=dy.Lens(d7,function(ej){return ej.dimExclude;},function(ej,ek){return cg.New(ej.dimId,ej.dimName,ej.dimPrefix,ej.dimOrder,ek,ej.dimFreeze,ej.dimType,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),(eb=dy.Lens(dy.Lens(d7,function(ej){return ej.dimType;},function(ej,ek){return cg.New(ej.dimId,ej.dimName,ej.dimPrefix,ej.dimOrder,ej.dimExclude,ej.dimFreeze,ek,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),(ec=function(ej){return function(ek){return ej(da.p$5(ek));};}(a.id),function(ej){return ei(ec(ej));}),function(ej,ek){return ek==="DataType"?b3.DtDataType:ek==="Time"?b3.DtTime:ek==="Version"?b3.DtVersion:b3.DtOther;}),(ed=dy.Lens(d7,function(ej){return ej.dimOrder;},function(ej,ek){return cg.New(ej.dimId,ej.dimName,ej.dimPrefix,ek,ej.dimExclude,ej.dimFreeze,ej.dimType,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),(ee=dy.Lens(d7,function(ej){return ej.dimPrefix;},function(ej,ek){return cg.New(ej.dimId,ej.dimName,ek,ej.dimOrder,ej.dimExclude,ej.dimFreeze,ej.dimType,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),(ef=dy.Lens(d7,function(ej){return ej.dimName;},function(ej,ek){return cg.New(ej.dimId,ek,ej.dimPrefix,ej.dimOrder,ej.dimExclude,ej.dimFreeze,ej.dimType,ej.defaultElm,ej.dimElements,ej.dimAttributes,ej.isCalcDim);}),dN.Make().WithHole({$:8,$0:"name",$1:ef})).WithHole({$:8,$0:"abbreviation",$1:ee})).WithHole({$:8,$0:"order",$1:ed})).WithHole({$:8,$0:"type",$1:eb})).WithHole({$:9,$0:"excludename",$1:ea})).WithHole({$:9,$0:"includefreeze",$1:d$})),d_.WithHole(dO.EventQ2(d_.k,"remove",function(){return d_.i;},function(){(cZ.processor())({$:18,$0:d6});}))),d9.WithHole(dO.EventQ2(d9.k,"select",function(){return d9.i;},function(){(cZ.processor())({$:19,$0:d6});}))),(eg=dO.CompleteHoles(d8.k,d8.h,[["name",0],["abbreviation",0],["order",0],["type",0],["excludename",2],["includefreeze",2]]),(eh=new dP.New(eg[1],db.dimensionrow(eg[0])),(d8.i=eh,eh)))).get_Doc();},d3)),dN.Make().WithHole({$:0,$0:"tbody",$1:d2})),(d4=dO.CompleteHoles(d1.k,d1.h,[]),(d5=new dP.New(d4[1],db.dimensiontable(d4[0])),(d1.i=d5,d5)))).get_Doc();};c7.dtypes=function(){c$.$cctor();return c$.dtypes$1;};c8.tableCalculations=function(){var d1,d2,d3,d4;return(d1=(d2=dx.Convert(function(d5){return c8.rowTreeNode(d5[0],d5[1],d5[2]);},du.Map(function(d5){function d6(d7,d8){return[d7.id(),cP.ofNode(d7).element,d8];}return dg.map(function(d7){return d6(d7[0],d7[1]);},c4.runEff(Z.listNodes(0,dg.map(cP.treenode,d5))));},cZ.model().treeHierarchy.get_View())),dN.Make().WithHole({$:0,$0:"tbody",$1:d2})),(d3=dO.CompleteHoles(d1.k,d1.h,[]),(d4=new dP.New(d3[1],db.calculationtable(d3[0])),(d1.i=d4,d4)))).get_Doc();};c8.rowTreeNode$4195$39=function(d1){return function(d2){c4.scrollIntoView(d1,d2);};};c8.rowTreeNode$4193$39=function(d1){return function(d2){var d3;d2.Event.preventDefault();d3=c5.getDragNIdO(d1);(i.iter(function(d4){(cZ.processor())({$:16,$0:true,$1:d4,$2:d1});}))(d3);};};c8.rowTreeNode$4192$39=function(d1){return function(d2){if(c5.getDragNIdO(d1)!=null)d2.Event.preventDefault();};};c8.rowTreeNode$4191$39=function(d1){return function(d2){c5.setDragNode(d1);d2.Event.stopPropagation();};};c8.rowTreeNode$4190$39=function(d1){return function(){du.Get(i.iter(function(d2){(cZ.processor())({$:14,$0:!d2.expanded,$1:d2.nid});}),d1);};};c8.rowTreeNode$4189$39=function(d1){return function(){(cZ.processor())({$:13,$0:d1});};};c8.rowTreeNode$4188$39=function(d1){return function(){(cZ.processor())({$:2,$0:d1});};};c8.rowTreeNode$4174$39=function(d1){return function(d2){c4.scrollIntoView(d1,d2);};};c8.rowTreeNode$4172$39=function(d1){return function(d2){var d3;d2.Event.preventDefault();d3=c5.getDragNIdO(d1);(i.iter(function(d4){(cZ.processor())({$:16,$0:true,$1:d4,$2:d1});}))(d3);};};c8.rowTreeNode$4171$39=function(d1){return function(d2){if(c5.getDragNIdO(d1)!=null)d2.Event.preventDefault();};};c8.rowTreeNode$4170$39=function(d1){return function(d2){c5.setDragNode(d1);d2.Event.stopPropagation();};};c8.rowTreeNode$4168$39=function(d1,d2){return function(){du.Get(function(d3){if(!d3)(cZ.processor())({$:13,$0:d2});},d1);};};c8.rowTreeNode$4167$39=function(d1){return function(){(cZ.processor())({$:7,$0:d1});};};c8.rowTreeNode=function(d1,d2,d3){var d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF;d4=(function(eG){return function(eH){return eG(a.String(eH)+"em");};}(a.id))(d3);d5=du.Map(function(eG){return cY.isNodeSelected(d1,eG);},cZ.model().selection.get_View());return d2.$==1?(d6=d2.$0,(d7=cZ.model().totals,_4.lensDef(cY.nonTotal(),d6,d7),d8=(d9=cZ.model().totals,_4.lensDef(cY.nonTotal(),d6,d9)),d_=du.Map(function(eG){return c4.runEff(cP.tryFindNodeEf(d1,eG));},cZ.model().treeHierarchy.get_View()),d$=du.Map(function(eG){var eH;eH=eG==null?null:{$:1,$0:eG.$0.expanded?"-":"+"};return eH==null?"*":eH.$0;},d_),(ea=(eb=(ec=(ed=(ee=(ef=(eg=(eh=dy.Lens(d8,function(eG){return eG.totOrder;},function(eG,eH){return cq.New(eG.totId,eG.totName,eH,eG.totFormat,eG.children);}),(ei=dy.Lens(d8,function(eG){return eG.totFormat;},function(eG,eH){return cq.New(eG.totId,eG.totName,eG.totOrder,eH,eG.children);}),(ej=dy.Lens(d8,function(eG){return eG.totName;},function(eG,eH){return cq.New(eG.totId,eH,eG.totOrder,eG.totFormat,eG.children);}),(ek=cY.selectedString("selected",d5),dN.Make().WithHole({$:2,$0:"selectedmark",$1:d$}).WithHole({$:2,$0:"selected",$1:ek})).WithHole({$:1,$0:"indent",$1:d4}).WithHole({$:8,$0:"totname",$1:ej})).WithHole({$:8,$0:"format",$1:ei})).WithHole({$:8,$0:"ordertot",$1:eh})),eg.WithHole(dO.EventQ2(eg.k,"remove",function(){return eg.i;},function(){(cZ.processor())({$:2,$0:d6});}))),ef.WithHole(dO.EventQ2(ef.k,"select",function(){return ef.i;},function(){(cZ.processor())({$:13,$0:d1});}))),ee.WithHole(dO.EventQ2(ee.k,"collapse",function(){return ee.i;},function(){du.Get(i.iter(function(eG){(cZ.processor())({$:14,$0:!eG.expanded,$1:eG.nid});}),d_);}))),ed.WithHole(dO.EventQ2(ed.k,"drag",function(){return ed.i;},function(eG){c5.setDragNode(d1);eG.Event.stopPropagation();}))),ec.WithHole(dO.EventQ2(ec.k,"dragover",function(){return ec.i;},function(eG){if(c5.getDragNIdO(d1)!=null)eG.Event.preventDefault();}))),eb.WithHole(dO.EventQ2(eb.k,"drop",function(){return eb.i;},function(eG){var eH;eG.Event.preventDefault();eH=c5.getDragNIdO(d1);(i.iter(function(eI){(cZ.processor())({$:16,$0:true,$1:eI,$2:d1});}))(eH);}))).WithHole({$:7,$0:"afterrender",$1:function(eG){c4.scrollIntoView(d5,eG);}}),(el=dO.CompleteHoles(ea.k,ea.h,[["totname",0],["ordertot",0],["format",0]]),(em=new dP.New(el[1],db.totalrow(el[0])),(ea.i=em,em)))).get_Doc())):(en=d2.$0,(eo=(ep=cZ.model().calculations,_4.lensDef(cY.nonCalculation(),en,ep)),(eq=dx.Convert(function(eG){return c8.rowFormula(d1,eo,eG);},du.Map(function(eG){return dg.map(function(eH){return eH.forId;},eG.calFormulas);},eo.get_View())),(er=(es=(et=(eu=(ev=(ew=(ex=c4.calcTypeV(eo),(ey=dy.Lens(eo,function(eG){return eG.calOrder;},function(eG,eH){return cp.New(eG.calId,eG.calName,eG.calDescription,eH,eG.format,eG.isText,eG.isInput,eG.isBalance,eG.calDims,eG.calFormulas,eG.cubIdO,eG.properties);}),(ez=dy.Lens(eo,function(eG){return eG.isBalance;},function(eG,eH){return cp.New(eG.calId,eG.calName,eG.calDescription,eG.calOrder,eG.format,eG.isText,eG.isInput,eH,eG.calDims,eG.calFormulas,eG.cubIdO,eG.properties);}),(eA=dy.Lens(eo,function(eG){return eG.isText;},function(eG,eH){return cp.New(eG.calId,eG.calName,eG.calDescription,eG.calOrder,eG.format,eH,eG.isInput,eG.isBalance,eG.calDims,eG.calFormulas,eG.cubIdO,eG.properties);}),(eB=dy.Lens(eo,function(eG){return eG.format;},function(eG,eH){return cp.New(eG.calId,eG.calName,eG.calDescription,eG.calOrder,eH,eG.isText,eG.isInput,eG.isBalance,eG.calDims,eG.calFormulas,eG.cubIdO,eG.properties);}),(eC=dy.Lens(eo,function(eG){return eG.calName;},function(eG,eH){return cp.New(eG.calId,eH,eG.calDescription,eG.calOrder,eG.format,eG.isText,eG.isInput,eG.isBalance,eG.calDims,eG.calFormulas,eG.cubIdO,eG.properties);}),(eD=cY.selectedString("selected",d5),dN.Make().WithHole({$:1,$0:"selectedmark",$1:""}).WithHole({$:2,$0:"selected",$1:eD})).WithHole({$:1,$0:"indent",$1:d4}).WithHole({$:8,$0:"calcname",$1:eC})).WithHole({$:8,$0:"format",$1:eB})).WithHole({$:9,$0:"istext",$1:eA})).WithHole({$:9,$0:"isbalance",$1:ez})).WithHole({$:8,$0:"ordercalc",$1:ey})).WithHole({$:8,$0:"calctype",$1:ex})),ew.WithHole(dO.EventQ2(ew.k,"remove",function(){return ew.i;},function(){(cZ.processor())({$:7,$0:en});}))),ev.WithHole(dO.EventQ2(ev.k,"select",function(){return ev.i;},function(){du.Get(function(eG){if(!eG)(cZ.processor())({$:13,$0:d1});},d5);}))).WithHole({$:0,$0:"formulas",$1:eq}),eu.WithHole(dO.EventQ2(eu.k,"drag",function(){return eu.i;},function(eG){c5.setDragNode(d1);eG.Event.stopPropagation();}))),et.WithHole(dO.EventQ2(et.k,"dragover",function(){return et.i;},function(eG){if(c5.getDragNIdO(d1)!=null)eG.Event.preventDefault();}))),es.WithHole(dO.EventQ2(es.k,"drop",function(){return es.i;},function(eG){var eH;eG.Event.preventDefault();eH=c5.getDragNIdO(d1);(i.iter(function(eI){(cZ.processor())({$:16,$0:true,$1:eI,$2:d1});}))(eH);}))).WithHole({$:7,$0:"afterrender",$1:function(eG){c4.scrollIntoView(d5,eG);}}),(eE=dO.CompleteHoles(er.k,er.h,[["calcname",0],["calctype",0],["ordercalc",0],["format",0],["istext",2],["isbalance",2]]),(eF=new dP.New(eE[1],db.calculationrow(eE[0])),(er.i=eF,eF)))).get_Doc())));};c8.rowFormula$4149$35=function(d1){return function(d2){c4.scrollIntoView(d1,d2);};};c8.rowFormula$4147$35=function(d1,d2,d3){return function(d4){var d5,d6,d7;function d8(d_){return d_.forId;}function d9(d_){d3.Set(d_);}d4.Event.preventDefault();d5=c5.getDragFormO(d1,d2);(i.iter((d6=(d7=d3.Get(),function(d_){var d$,ea,eb,ec;function ed(ee){return dn.Equals(d2,ee);}return di.ofSeq(dg.collect(a.id,(d$=di.ofSeq(dg.filter((ea=(eb=d8(d_),function(ee){return!dn.Equals(eb,ee);}),function(ee){return ea(d8(ee));}),d7)),(ec=di.splitAt(di.findIndex(function(ee){return ed(d8(ee));},d$),d$),dh.ofArray([ec[0],[d_],ec[1]])))));}),function(d_){return d9(d6(d_));})))(d5);};};c8.rowFormula$4146$35=function(d1,d2){return function(d3){if(c5.isDragForm(d1,d2))d3.Event.preventDefault();};};c8.rowFormula$4145$35=function(d1,d2){return function(d3){c5.setDragForm(d1,d2.Get());d3.Event.stopPropagation();};};c8.rowFormula$4144$35=function(d1,d2){return function(){(cZ.processor())({$:12,$0:d1,$1:d2});};};c8.rowFormula$4143$35=function(d1){return function(){(cZ.processor())({$:10,$0:d1});};};c8.rowFormula=function(d1,d2,d3){var d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei;d4=d2.Get().calId;d5=dy.Lens(d2,function(ej){return ej.calFormulas;},function(ej,ek){return cp.New(ej.calId,ej.calName,ej.calDescription,ej.calOrder,ej.format,ej.isText,ej.isInput,ej.isBalance,ej.calDims,ek,ej.cubIdO,ej.properties);});d6=c4.lensForm(d2,function(){return{$:1,$0:d3};});d7=du.Map(function(ej){return cY.isNodeFormSelected(d3,d1,ej);},cZ.model().selection.get_View());d8=du.Map2(function(ej,ek){return df.concat(", ",dg.map(function(el){var em;return(((dd.Curried3(function(en,eo,ep){return en(de.toSafe(eo)+":"+de.toSafe(ep));}))(a.id))((em=dg.tryFind(function(en){return dn.Equals(en.dimId,el.K);},ek),em!=null&&em.$==1?em.$0.dimName:"")))(el.V);},ej.forDestDecl));},d6.get_View(),cZ.model().dimensions.v);return(d9=(d_=(d$=(ea=(eb=(ec=(ed=c4.formTypeV(d6),(ee=dy.Lens(d6,function(ej){return ej.forText;},function(ej,ek){return co.New(ej.forId,ej.forDestDecl,ej.forDestination,ej.forDescription,ek,ej.forExpression,ej.forType,ej.forOrder);}),(ef=cY.selectedString("selected",d7),(eg=cY.selectedString(">",d7),dN.Make().WithHole({$:2,$0:"selectedmark",$1:eg})).WithHole({$:2,$0:"selected",$1:ef})).WithHole({$:2,$0:"formulafor",$1:d8}).WithHole({$:8,$0:"formula",$1:ee})).WithHole({$:8,$0:"formtype",$1:ed})),ec.WithHole(dO.EventQ2(ec.k,"remove",function(){return ec.i;},function(){(cZ.processor())({$:10,$0:d3});}))),eb.WithHole(dO.EventQ2(eb.k,"select",function(){return eb.i;},function(){(cZ.processor())({$:12,$0:d3,$1:d1});}))),ea.WithHole(dO.EventQ2(ea.k,"drag",function(){return ea.i;},function(ej){c5.setDragForm(d4,d6.Get());ej.Event.stopPropagation();}))),d$.WithHole(dO.EventQ2(d$.k,"dragover",function(){return d$.i;},function(ej){if(c5.isDragForm(d4,d3))ej.Event.preventDefault();}))),d_.WithHole(dO.EventQ2(d_.k,"drop",function(){return d_.i;},function(ej){var ek,el,em;function en(ep){return ep.forId;}function eo(ep){d5.Set(ep);}ej.Event.preventDefault();ek=c5.getDragFormO(d4,d3);(i.iter((el=(em=d5.Get(),function(ep){var eq,er,es,et;function eu(ev){return dn.Equals(d3,ev);}return di.ofSeq(dg.collect(a.id,(eq=di.ofSeq(dg.filter((er=(es=en(ep),function(ev){return!dn.Equals(es,ev);}),function(ev){return er(en(ev));}),em)),(et=di.splitAt(di.findIndex(function(ev){return eu(en(ev));},eq),eq),dh.ofArray([et[0],[ep],et[1]])))));}),function(ep){return eo(el(ep));})))(ek);}))).WithHole({$:7,$0:"afterrender",$1:function(ej){c4.scrollIntoView(d7,ej);}}),(eh=dO.CompleteHoles(d9.k,d9.h,[["formtype",0],["formula",0]]),(ei=new dP.New(eh[1],db.formularow(eh[0])),(d9.i=ei,ei)))).get_Doc();};c9.mainProgram=function(){var d1,d2,d3,d4,d5,d6;dQ.addPlugIn(dR.New("RuleEditor",[dQ.newVar("fileName",cZ.model().fileName),dQ.newVar("CodeFS",cZ.model().codeFS),dQ.newVar("Output",cZ.model().outputMsgs),dQ.newVar("Parser",cZ.model().parserMsgs),dQ.newVar("Server",cZ.model().server),dQ.newVar("GlobalDefs",cZ.model().globalDefs)],[],[dQ.newDoc("globalDefs",dS.Create(b0.globalDefs)),dQ.newDoc("Dimensions",dS.Create(c7.tableDimensions)),dQ.newDoc("Calculations",dS.Create(c8.tableCalculations)),dQ.newDoc("details",dS.Create(b0.details)),dQ.newDoc("dimsSelected",dS.Create(b0.dimsSelected))],[dQ.newAct("IndentIn",function(){var d7,d8;d7=(d8=cZ.model().selection.Get(),d8==null?null:{$:1,$0:d8.$0[0]});(i.iter(function(d9){(cZ.processor())({$:15,$0:true,$1:d9});}))(d7);}),dQ.newAct("IndentOut",function(){var d7,d8;d7=(d8=cZ.model().selection.Get(),d8==null?null:{$:1,$0:d8.$0[0]});(i.iter(function(d9){(cZ.processor())({$:15,$0:false,$1:d9});}))(d7);}),dQ.newActF("LoadFile",{$:1,$0:function(d7){(cZ.processor())({$:27,$0:d7});},$1:"FileElement"}),dQ.newActF("SaveAs",{$:1,$0:function(d7){(cZ.processor())({$:26,$0:d7});},$1:"FileElement"}),dQ.newAct("AddCalculation",function(){(cZ.processor())(cX.AddCalculation);}),dQ.newAct("AddTotal",function(){(cZ.processor())(cX.AddTotal);}),dQ.newAct("AddDimension",function(){(cZ.processor())(cX.AddDimension);})],[]));dT.addLayout((d1=(d2=self.document.getElementById("GlobalLayout"),dn.Equals(d2,null)?"\r\n                    menuEditor       horizontal  65       menuLogo                  editorMessages\r\n                    double           horizontal  0-50-100 AppFramework.AppFwkClient menuEditor\r\n                    menuLogo         vertical    350      logo                      menu\r\n                    logo             span       \"margin:0; color:gray; font-size: 55px; font-weight:530\" \"F# Station\"\r\n                    editorMessages   horizontal 10-83-100 editorButtons             messages\r\n                    messages         vertical   0-50-100  messagesLeft              messagesRight\r\n                    editorButtons    vertical -200 snippetsSnippet buttons\r\n                    buttons div      \"overflow: hidden; display: grid; grid-template-columns: 100%; grid-template-rows: repeat(15, calc(100% / 15)); bxackground-color: #eee; box-sizing: border-box; padding : 5px; grid-gap: 5px; margin-right: 21px\" btnSaveAs none x btnAddSnippet btnDeleteSnippet btnIndentIn btnIndentOut none x btnRunFS none x btnAbortFsi\r\n                    snippetsSnippet  vertical   0-20-100  snippets                  editorProperties\r\n                    snippets         horizontal 20        \"${FSharpStation.CurrentPath}\" FSharpStation.Snippets\r\n                    editorProperties vertical   0-100-100 snippet                   properties\r\n                    properties       div        \"\"        FSharpStation.Properties\r\n                    snippet          horizontal 35        Name                      FSharpStation.editor\r\n                    menu             span  \"\" btnLoad btnImport\r\n        \r\n                    btnSaveAs        button FSharpStation.SaveAs         \"class=btn ${FSharpStation.SaveNeeded}\" \"Save as...    \"\r\n                    btnAddDimension  button RuleEditor.AddDimension      \"\"                  \"Add Dimension \"\r\n                    btnDeleteSnippet button FSharpStation.RemoveSnippet  \"\"                  \"Delete Snippet\"\r\n                    btnIndentIn      button FSharpStation.IndentIn       \"\"                  \"Indent In  >> \"\r\n                    btnIndentOut     button FSharpStation.IndentOut      \"\"                  \"Indent Out << \"\r\n                    btnRunFS         button FSharpStation.RunFS          \"\"                  \"Run F#        \"\r\n                    btnAbortFsi      button FSharpStation.AbortFsi       \"\"                  \"Abort Fsi     \"\r\n        \r\n                    messagesLeft     wcomp-tabstrip                      \"\"                  Output FsCode\r\n                    messagesRight    wcomp-tabstrip                      \"\"                  Parser\r\n        \r\n                    Output           textarea  FSharpStation.Output      \"tabname=Output ; placeholder=Output messages ; spellcheck=false\" \r\n                    FsCode           textarea  FSharpStation.FsCode      \"tabname=F# Code; placeholder=F# Code         ; spellcheck=false\" \r\n                    Parser           textarea  FSharpStation.Parser      \"tabname=Parser ; placeholder=Parser messages; dblclick=${FSharpStation.JumpTo} ; spellcheck=false\" \r\n                    Name             Doc       InputLabel                \"\"     \"Name:\"        FSharpStation.SnippetName\r\n                    btnLoad          Doc       InputFile                 \"\"     \"Load File...\" FSharpStation.LoadFile  FileName\r\n                    btnImport        Doc       InputFile                 \"\"     \"Import...\"    FSharpStation.Import    \"\"\r\n                    FileName         div                                 \"class=form-control\"  FSharpStation.fileName\r\n                   ":d2.textContent),dT.newLyt(c9.RuleEditorLyt(),d1)));d3=(d4=null,(d5=c9.RuleEditorLyt(),d4==null?d5:d4.$0));dQ.mainDocV().Set(d3);return dx.Async((d6=null,dj.Delay(function(){return dj.Return(dQ.getMainDoc().f());})));};c9.scrollToBottom=function(d1,d2){var d3;dj.Start((d3=null,dj.Delay(function(){return dj.Bind(dj.Sleep(100),function(){d1.scrollTop=d1.scrollHeight;return dj.Zero();});})),null);};c9.RuleEditorLyt=function(){c$.$cctor();return c$.RuleEditorLyt;};c_.updateModel=function(d1,d2){if(c_.updateModelR(d1,d2))(cY.refreshNow())();};c_.updateModelR=function(d1,d2){var d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew;function ex(eE,eF){var eG;eG=d1.calculations.TryFindByKey(eE);return(i.iter(eF))(eG);}function ey(eE){return dn.Equals(d1.selection.Get(),eE)?false:(d1.selection.Set(eE),true);}function ez(eE){return dg.tryFind(function(eF){return dg.exists(function(eG){return dn.Equals(eG.forId,eE);},eF.calFormulas);},d1.calculations["var"].Get());}function eA(eE,eF){var eG;return eE?[eF,true]:dn.Equals(eF.nid,ej)?[cN.New(eF.nid,ek,eF.element,eF.children,eF.weight),true]:(eG=dg.mapFold(eA,false,eF.children),[cN.New(eF.nid,eF.expanded,eF.element,di.ofSeq(eG[0]),eF.weight),eG[1]]);}function eB(eE){return[eE.nid,null];}function eC(eE){return[eE.nid,null];}function eD(eE){return[eE.nid,{$:1,$0:eo}];}return d2.$==3?(d3=cF.New(),(d1.calculations.Append(d3),d4=cP.newNodeCalc(d3.calId),d1.treeHierarchy.Set([d4].concat(d1.treeHierarchy.Get())),c_.updateModelR(d1,{$:13,$0:d4.nid}))):d2.$==0?(d5=cG.New(),(d1.totals.Append(d5),d6=cP.newNodeTot(d5.totId),d1.treeHierarchy.Set([d6].concat(d1.treeHierarchy.Get())),c_.updateModelR(d1,{$:13,$0:d6.nid}))):d2.$==9?(d7=d2.$0,dn.Equals(d7,cY.nonCalculation().calId)?false:(d8=co.New(new cc({$:0,$0:dD.NewGuid()}),new dF.New([]),dh.T.Empty,"","",cl.ExiStet,cn.ForBase,""),(d9=d1.calculations.TryFindByKey(d7),(i.iter(function(eE){d1.calculations.Append(cp.New(eE.calId,eE.calName,eE.calDescription,eE.calOrder,eE.format,eE.isText,eE.isInput,eE.isBalance,eE.calDims,eE.calFormulas.concat([d8]),eE.cubIdO,eE.properties));}))(d9),d_=(d$=c4.runEff((ea=d1.treeHierarchy.Get(),cP.tryFindSelNodeEf(d1.selection.Get(),ea))),d$==null?null:{$:1,$0:c_.updateModelR(d1,{$:12,$0:d8.forId,$1:d$.$0.nid})}),d_==null||d_.$0))):d2.$==17?(eb=cD.New(""),(d1.dimensions.Append(eb),c_.updateModelR(d1,{$:19,$0:eb.dimId}))):d2.$==2?(ec=d2.$0,(d1.totals.RemoveByKey(ec),ey(null),cY.setHierarchy(d1,c4.runEff((ed=d1.treeHierarchy.Get(),cP.removeNodesEf(cP.forTId(function(eE){return dn.Equals(ec,eE);}),ed)))),true)):d2.$==7?(ee=d2.$0,(ey(null),d1.calculations.RemoveByKey(ee),dg.iter((ef=d1.totals,function(eE){ef.Append(eE);}),dg.choose(function(eE){var eF;function eG(eH,eI){return dn.Equals(eI,{$:0,$0:ee});}eF=di.partition(function(eH){return eG(eH[0],eH[1]);},eE.children);return di.length(eF[0])===0?null:{$:1,$0:cq.New(eE.totId,eE.totName,eE.totOrder,eE.totFormat,eF[1])};},d1.totals["var"].Get())),cY.setHierarchy(d1,c4.runEff((eg=d1.treeHierarchy.Get(),cP.removeNodesEf(cP.forCId(function(eE){return dn.Equals(ee,eE);}),eg)))),true)):d2.$==10?(eh=d2.$0,(ei=ez(eh),(i.iter(function(eE){d1.calculations.Append(cp.New(eE.calId,eE.calName,eE.calDescription,eE.calOrder,eE.format,eE.isText,eE.isInput,eE.isBalance,eE.calDims,di.filter(function(eF){return!dn.Equals(eF.forId,eh);},eE.calFormulas),eE.cubIdO,eE.properties));}))(ei),true)):d2.$==18?(d1.dimensions.RemoveByKey(d2.$0),true):d2.$==13?ey({$:1,$0:[d2.$0,null]}):d2.$==14?(ej=d2.$1,(ek=d2.$0,(d1.treeHierarchy.Set(di.ofSeq((dg.mapFold(eA,false,d1.treeHierarchy.Get()))[0])),true))):d2.$==15?(el=d2.$1,(em=d2.$0?function(eE){return function(eF){return Z.indentNode(eE,eF);};}:function(eE){return function(eF){return Z.outdentNode(eE,eF);};},(c4.iterEff(a.ignore,(en=t.eff(),en.Delay(function(){return en.Bind(cP.tryFindNodeEf(el,d1.treeHierarchy.Get()),function(eE){var eF;return eE!=null&&eE.$==1?en.Bind((eF=dg.map(cP.treenode,d1.treeHierarchy.Get()),(em(cP.treenode(eE.$0)))(eF)),function(eG){cY.setHierarchy(d1,dg.map(cP.ofNode,eG));return en.Zero();}):en.Zero();});}))),true))):d2.$==16?(c4.iterEff(a.ignore,x.op_BarGreaterGreater(x.op_BarGreaterGreater(Z.moveToSibling2(d2.$0,d2.$1,d2.$2,dg.map(cP.treenode,d1.treeHierarchy.Get())),function(eE){return dg.map(cP.ofNode,eE);}),function(eE){cY.setHierarchy(d1,eE);})),true):d2.$==12?ey({$:1,$0:[d2.$1,{$:1,$0:d2.$0}]}):d2.$==1?c4.runEff(x.op_BarGreaterGreater(x.op_BarGreaterGreater(cP.tryFindNodeTIdEf(d2.$0,d1.treeHierarchy.Get()),function(eE){return eE==null?null:{$:1,$0:eB(eE.$0)};}),ey)):d2.$==8?c4.runEff(x.op_BarGreaterGreater(x.op_BarGreaterGreater(cP.tryFindNodeCIdEf(d2.$0,d1.treeHierarchy.Get()),function(eE){return eE==null?null:{$:1,$0:eC(eE.$0)};}),ey)):d2.$==11?(eo=d2.$0,c4.runEff(x.op_BarGreaterGreater(x.op_BarGreaterGreater(x.op_BarGreaterGreater(t.insertO((ep=(eq=ez(eo),eq==null?null:{$:1,$0:eq.$0.calId}),ep==null?null:{$:1,$0:cP.tryFindNodeCIdEf(ep.$0,d1.treeHierarchy.Get())})),function(eE){return eE==null?null:a.id(eE.$0);}),function(eE){return eE==null?null:{$:1,$0:eD(eE.$0)};}),ey))):d2.$==19?(er=d2.$0,(es=dn.Equals(er,new b$({$:0,$0:"00000000-0000-0000-0000-000000000000"}))?null:{$:1,$0:er},dn.Equals(es,d1.selectedDim.Get())?false:(d1.selectedDim.Set(es),true))):d2.$==23?(et=d2.$1,(ex(d2.$0,function(eE){d1.calculations.Append(cp.New(eE.calId,eE.calName,eE.calDescription,eE.calOrder,eE.format,eE.isText,eE.isInput,eE.isBalance,eE.calDims.Add(et),eE.calFormulas,eE.cubIdO,eE.properties));}),false)):d2.$==22?(eu=d2.$1,(ex(d2.$0,function(eE){d1.calculations.Append(cp.New(eE.calId,eE.calName,eE.calDescription,eE.calOrder,eE.format,eE.isText,eE.isInput,eE.isBalance,eE.calDims.Remove(eu),eE.calFormulas,eE.cubIdO,eE.properties));}),false)):d2.$==6?(d1.cubes.Append(cE.newCubeCalc(d2.$0,di.ofSeq(d2.$1),null)),false):d2.$==4?(d1.cubes.RemoveByKey(d2.$0),false):d2.$==5?(ev=d2.$1,(ew=d1.cubes.TryFindByKey(d2.$0),(i.iter(function(eE){d1.cubes.Append(cs.New(eE.cubId,ev,eE.cubRules,eE.cubRuleXmls,eE.cubDims,eE.measureDim,eE.cubType));}))(ew),false)):((function(eE){return function(eF){return eE("Msg not implemented: "+da.p$6(eF));};}(function(eE){dr.log(eE);}))(d2),false);};b0.globalDefs=function(){return _8.render(cQ.monacoNew(cZ.model().globalDefs,null,null,null));};b0.dimsSelected=function(){var d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea;d1=dy.Lens(c4.currentFormV(),function(eb){return eb.forDestDecl;},function(eb,ec){return co.New(eb.forId,ec,eb.forDestination,eb.forDescription,eb.forText,eb.forExpression,eb.forType,eb.forOrder);});d2=(d3=du.get_Do(),du.Bind(function(eb){return du.Bind(function(ec){var ed,ee;ed=di.ofSeq(dg.map(function(ef){return[ef.dimId,ef.dimExclude?"":ef.dimPrefix];},(cD.filterSort(c4.dtypes()))(ec)));ee=di.map(function(ef){return ef[0];},ed);return du.Bind(function(ef){var eg;eg=di.ofSeq(dg.map(function(eh){return[new dG.New(di.filter(function(ei){return di.contains(ei,ee);},eh.cubDims)),eh];},dg.filter(function(eh){return eh.cubType.$===1;},ef)));return du.Bind(function(eh){var ei,ej,ek;function el(eo){return eo[0];}function em(eo){return dn.Equals(ei,eo);}function en(eo,ep){return ei.Contains(eo)?{$:1,$0:ep}:null;}ei=eh.calDims;ej=(ek=dg.tryFind(function(eo){return em(el(eo));},eg),ek==null?null:{$:1,$0:ek.$0[1]});return du.Const([ej,ej!=null?"":eb+df.concat("",dg.choose(function(eo){return en(eo[0],eo[1]);},ed))]);},c4.currentCalcV().get_View());},cZ.model().cubes.v);},cZ.model().dimensions.v);},cZ.model().cubePrefix.get_View()));d4=du.Map(function(eb){return eb[0];},d2);d5=du.Map(function(eb){return eb[1];},d2);d6=du.Map(function(eb){return eb!=null&&eb.$==1?eb.$0.cubName:"";},d4);return(d7=(d8=(d9=cZ.model().dimensions,_4.docLensMapView(cD.filterSort(c4.dtypes()),function(eb,ec){var ed,ee,ef,eg,eh,ei,ej,ek,el,em;ed=(ee=du.get_Do(),du.Bind(function(en){var eo;eo=en.forDestDecl.TryFind(eb);return eo==null?du.Const(""):du.Const(eo.$0);},c4.currentFormV().get_View()));ef=du.Map(function(en){return dg.contains(eb,en.calDims);},c4.currentCalcV().get_View());eg=du.Map2(function(en,eo){return!dn.Equals(en.forId,cY.nonFormula().forId)&&eo?"":"Hidden";},c4.currentFormV().get_View(),ef);return(eh=(ei=new dw.New(ed,function(en){var eo;eo=df.Trim(en);dn.Equals(c4.currentFormV().Get().forId,cY.nonFormula().forId)?void 0:d1.Set(eo===""?d1.Get().Remove(eb):d1.Get().Add(eb,eo));}),(ej=new dw.New(ef,function(en){var eo;eo=en?{$:23,$0:c4.currentCalcV().Get().calId,$1:eb}:{$:22,$0:c4.currentCalcV().Get().calId,$1:eb};(cZ.processor())(eo);}),(ek=du.Map(function(en){return en.dimName;},ec.get_View()),dN.Make().WithHole({$:2,$0:"dimension",$1:ek})).WithHole({$:9,$0:"dimensioncheck",$1:ej})).WithHole({$:8,$0:"destination",$1:ei})).WithHole({$:2,$0:"hidden",$1:eg}),(el=dO.CompleteHoles(eh.k,eh.h,[["dimensioncheck",2],["destination",0]]),(em=new dP.New(el[1],db.dimselectedrow(el[0])),(eh.i=em,em)))).get_Doc();},d9)),(d_=new dw.New(d6,function(eb){var ec;dj.Start((ec=null,dj.Delay(function(){var ed;ed=df.Trim(eb);return dj.Bind(du.GetAsync(d4),function(ee){var ef;ef=ee==null?ed===""?cX.NoOp:{$:6,$0:ed,$1:c4.currentCalcV().Get().calDims}:ed===""?{$:4,$0:ee.$0.cubId}:{$:5,$0:ee.$0.cubId,$1:ed};(cZ.processor())(ef);return dj.Zero();});})),null);}),dN.Make().WithHole({$:8,$0:"cubename",$1:d_})).WithHole({$:2,$0:"possiblecubename",$1:d5}).WithHole({$:0,$0:"tbody",$1:d8})),(d$=dO.CompleteHoles(d7.k,d7.h,[["cubename",0]]),(ea=new dP.New(d$[1],db.dimsselected(d$[0])),(d7.i=ea,ea)))).get_Doc();};b0.details$4247$30=function(){return function(){var d1,d2;function d3(d4){return{$:9,$0:d4};}d1=du.Map(function(d4){return d4.calId;},c4.currentCalcV().get_View());du.Get((d2=cZ.processor(),function(d4){return d2(d3(d4));}),d1);};};b0.details=function(){var d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el;function em(){var eq;eq=du.Const("");return dU.DynamicPred("disabled",du.Map(function(er){return dn.Equals(er.calId,cY.nonCalculation().calId);},c4.currentCalcV().get_View()),eq);}function en(){var eq;eq=du.Const("");return dU.DynamicPred("disabled",du.Map(function(er){return dn.Equals(er.forId,cY.nonFormula().forId);},c4.currentFormV().get_View()),eq);}function eo(eq,er,es){return du.Get(function(et){c3.showToolTips({$:3,$0:et.forId},eq,er,es);},c4.currentFormV().get_View());}function ep(eq,er,es,et){return du.Get(function(eu){c3.getHints({$:3,$0:eu.forId},function(ev,ew,ex){return((eq(ev))(ew))(ex);},er,es,et);},c4.currentFormV().get_View());}d1=(d2=du.Map2(function(eq,er){return c3.filterFormula(er,eq==null?null:eq.$0[1]);},cZ.model().selection.get_View(),cZ.model().parserMsgs.get_View()),(d3=[dy.Create$1(null)],(du.Sink(function(eq){if(!dn.Equals(d3[0].Get(),eq))d3[0].Set(eq);},d2),d3[0].get_View())));d4=_8.render(cQ.monacoNew(dy.Lens(c4.currentFormV(),function(eq){return eq.forText;},function(eq,er){return co.New(eq.forId,eq.forDestDecl,eq.forDestination,eq.forDescription,er,eq.forExpression,eq.forType,eq.forOrder);}),{$:1,$0:d1},{$:1,$0:dd.Curried3(eo)},{$:1,$0:dd.Curried(ep,4)}));return(d5=(d6=(d7=en(),(d8=en(),(d9=em(),(d_=em(),(d$=em(),(ea=em(),(eb=em(),(ec=em(),(ed=em(),(ee=c4.formTypeV(c4.currentFormV()),(ef=c4.calcTypeV(c4.currentCalcV()),(eg=dy.Lens(c4.currentCalcV(),function(eq){return eq.isBalance;},function(eq,er){return cp.New(eq.calId,eq.calName,eq.calDescription,eq.calOrder,eq.format,eq.isText,eq.isInput,er,eq.calDims,eq.calFormulas,eq.cubIdO,eq.properties);}),(eh=dy.Lens(c4.currentCalcV(),function(eq){return eq.isText;},function(eq,er){return cp.New(eq.calId,eq.calName,eq.calDescription,eq.calOrder,eq.format,er,eq.isInput,eq.isBalance,eq.calDims,eq.calFormulas,eq.cubIdO,eq.properties);}),(ei=dy.Lens(c4.currentCalcV(),function(eq){return eq.format;},function(eq,er){return cp.New(eq.calId,eq.calName,eq.calDescription,eq.calOrder,er,eq.isText,eq.isInput,eq.isBalance,eq.calDims,eq.calFormulas,eq.cubIdO,eq.properties);}),(ej=dy.Lens(c4.currentCalcV(),function(eq){return eq.calName;},function(eq,er){return cp.New(eq.calId,er,eq.calDescription,eq.calOrder,eq.format,eq.isText,eq.isInput,eq.isBalance,eq.calDims,eq.calFormulas,eq.cubIdO,eq.properties);}),dN.Make().WithHole({$:8,$0:"calcname",$1:ej})).WithHole({$:8,$0:"format",$1:ei})).WithHole({$:9,$0:"istext",$1:eh})).WithHole({$:9,$0:"isbalance",$1:eg})).WithHole({$:8,$0:"calctype",$1:ef})).WithHole({$:8,$0:"formtype",$1:ee})).WithHole({$:0,$0:"formula",$1:d4}).WithHole({$:3,$0:"disablecalc1",$1:ed})).WithHole({$:3,$0:"disablecalc2",$1:ec})).WithHole({$:3,$0:"disablecalc3",$1:eb})).WithHole({$:3,$0:"disablecalc4",$1:ea})).WithHole({$:3,$0:"disablecalc5",$1:d$})).WithHole({$:3,$0:"disablecalc6",$1:d_})).WithHole({$:3,$0:"disablecalc7",$1:d9})).WithHole({$:3,$0:"disableform1",$1:d8})).WithHole({$:3,$0:"disableform2",$1:d7})),d6.WithHole(dO.EventQ2(d6.k,"addformula",function(){return d6.i;},function(){var eq,er;function es(et){return{$:9,$0:et};}eq=du.Map(function(et){return et.calId;},c4.currentCalcV().get_View());du.Get((er=cZ.processor(),function(et){return er(es(et));}),eq);}))),(ek=dO.CompleteHoles(d5.k,d5.h,[["calcname",0],["format",0],["calctype",0],["formtype",0],["istext",2],["isbalance",2],["alsoactual",2]]),(el=new dP.New(ek[1],db.formuladetail(ek[0])),(d5.i=el,el)))).get_Doc();};c$.$cctor=function(){var d2,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg;c$.$cctor=a.ignore;c$.rtn=function(eh){return[eh];};c$.result=new n.New();c$.result$1=m.result();c$.fusion=new s.New();c$.eff=new y.New();c$.fusion$1=new G.New();c$.resultM=new I.New();c$.asyncResult=new M.New();c$.asyncResultP=new N.New();c$.asyncResultM=new Q.New();function d1(eh){return df.concat("\n",eh);}c$.unindentStr=function(eh){return d1(S.unindent$1(eh));};function d3(eh){return S.splitByChar$1("\n",eh);}function d4(eh){var ei,ej;return _do.array(eh,{$:1,$0:0},{$:1,$0:(ei=0,(ej=di.length(eh)-2,dn.Compare(ei,ej)===1?ei:ej))});}function d5(eh){return df.concat("\n",eh);}c$.skipLastLine=(d2=function(eh){return d4(d3(eh));},function(eh){return d5(d2(eh));});c$.parseDateO=U.tryParseWith$1(function(eh){var ei,ej;ei=0;return[(ej=dV.TryParse(eh),ej!=null&&ej.$==1&&(ei=ej.$0,true)),ei];});c$.parseIntO=U.tryParseWith$1(function(eh){var ei;ei=0;return[dW.TryParseInt32(eh,{get:function(){return ei;},set:function(ej){ei=ej;}}),ei];});c$.parseSingleO=U.tryParseWith$1(function(eh){var ei,ej;ei=0;return[(ej=a.Number(eh),a.isNaN(ej)?false:(ei=ej,true)),ei];});c$.parseDoubleO=U.tryParseWith$1(function(eh){var ei,ej;ei=0;return[(ej=a.Number(eh),a.isNaN(ej)?false:(ei=ej,true)),ei];});c$.parseGuidO=U.tryParseWith$1(function(eh){var ei;ei=null;return[dD.TryParse(eh,{get:function(){return ei;},set:function(ej){ei=ej;}}),ei];});c$["|Date|_|"]=U.parseDateO$1();c$["|Int|_|"]=U.parseIntO$1();c$["|Single|_|"]=U.parseSingleO$1();c$["|Double|_|"]=U.parseDoubleO$1();c$["|Guid|_|"]=U.parseGuidO$1();c$.counter=1;c$.rexGuid="([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12})";c$.observers=dh.T.Empty;c$.loader=(d6=null,dj.Delay(function(){self.require.config({paths:{vs:"/EPFileX/monaco/package/min/vs"}});return dj.Bind(dj.FromContinuations(function(eh,ei){return self.require(["vs/editor/editor.main"],eh,ei);}),function(){return dj.Return(null);});}));c$.MessageBrokerId="<MessageBroker>";c$.MessageBrokerAddress=new bm({$:0,$0:bl.MessageBrokerId()});c$.rootdir="..\\website";c$.TemplatesFileName="..\\website"+"\\Templates.html";((function(eh){return function(ei){return eh(de.toSafe(ei));};}(function(eh){dr.log(eh);}))("..\\website\\Templates.html"));c$.Xmodel=cv.New(new b7({$:0,$0:dD.NewGuid()}),"local\\Budget","Actual",[],[],[]);c$.forAll=cm.New(new dF.New([]),null,null);c$.getDimO=function(eh){return function(ei){return cz.getDimO(eh,ei);};};c$.getDimR=function(eh){return function(ei){return cz.getDimR(eh,ei);};};c$.getCubeO=function(eh){return function(ei){return cz.getCubeO(eh,ei);};};c$.cubePrefix="Z";c$.measurePrefix="M";c$.annotationsV=dy.Create$1("Err (1, 7) - (1, 12): \"This shows over there as an error\".\nWarn (2, 7) - (2, 12): \"This shows over there as a warning\".\nInfo (3, 7) - (3, 12): \"This shows over there as information\".\nHint (4, 7) - (4, 12): \"This shows over there as a hint\".");c$.nonTotal=(d7=cG.New(),cq.New(new cb({$:0,$0:"00000000-0000-0000-0000-000000000000"}),d7.totName,d7.totOrder,d7.totFormat,d7.children));c$.nonCalculation=(d8=cF.New(),cp.New(new ca({$:0,$0:"00000000-0000-0000-0000-000000000000"}),d8.calName,d8.calDescription,d8.calOrder,d8.format,d8.isText,d8.isInput,d8.isBalance,d8.calDims,d8.calFormulas,d8.cubIdO,d8.properties));c$.nonFormula=(d9=co.New(new cc({$:0,$0:dD.NewGuid()}),new dF.New([]),dh.T.Empty,"","",cl.ExiStet,cn.ForBase,""),co.New(new cc({$:0,$0:"00000000-0000-0000-0000-000000000000"}),d9.forDestDecl,d9.forDestination,d9.forDescription,d9.forText,d9.forExpression,d9.forType,d9.forOrder));c$.nonTotalV=dy.Lens(dy.Create$1(cY.nonFormula()),a.id,a.id);c$.nonCalculationV=dy.Lens(dy.Create$1(cY.nonCalculation()),a.id,a.id);c$.nonFormulaV=dy.Lens(dy.Create$1(cY.nonFormula()),a.id,a.id);d$=(d_=dy.Create$1(),[d_.get_View(),function(){d_.Set(null);}]);c$.refreshView=d$[0];c$.refreshNow=d$[1];c$.model=cW.New(dy.Create$1([]),dX.Create(function(eh){return eh.calId;},[]),dX.Create(function(eh){return eh.totId;},[]),dX.Create(function(eh){return eh.dimId;},[]),dX.Create(function(eh){return eh.cubId;},[]),dy.Create$1(""),dy.Create$1(""),dy.Create$1(null),dy.Create$1(null),dy.Create$1(null),dX.Create(a.id,[]),dy.Create$1("Z"),dy.Create$1("M"),dy.Create$1(""),dy.Create$1(""),dy.Create$1(""),dy.Create$1("NewFile.json"),dy.Create$1(cV.New()));c$.processor=a.ignore;c$.trace=a.id;c$.fsCodeVO={$:1,$0:c0.fsCode()};c$.parseFile="RuleEditor.fsx";ea=c.delayed$1(1000,function(){var eh;function ei(ej){c.print$1(ej);}L.iterA(function(ej){return ei(e.summarized(ej));},a.ignore,(eh=g.asyncResult(),eh.Run(eh.Delay(function(){var ej;cZ.model().parserMsgs.Set("Parsing...\n"+S.skipFirstLine$1(cZ.model().parserMsgs.Get()));return(ej=c0.fsCodeVO(),ej!=null&&ej.$==1)?O["AsyncResultBuilder.Bind"](eh,du.GetAsync(c0.fsCodeVO().$0),function(ek){var el,em;el=ek[1];em=ek[0];return eh.Bind$1(bZ.parseCode(c3.parseFile(),df.SplitChars(em,["\n"],0),true,0),function(en){var eo;eo=df.concat("\n",c3.adaptErrors(el,en[0]));cZ.model().codeFS.Set(em);cZ.model().parserMsgs.Set("Parsed!\n"+eo);return eh.Zero();});}):eh.Zero();}))));});eb=c0.fsCodeVO();(i.iter(function(eh){du.Sink(ea,eh);}))(eb);c$.sForId=dg.head(S.splitByChar$1(" ",(ec=new cc({$:0,$0:"00000000-0000-0000-0000-000000000000"}),(function(eh){return function(ei){return eh(da.p(ei));};}(a.id))(ec))));c$.sCalId=dg.head(S.splitByChar$1(" ",(ed=new ca({$:0,$0:"00000000-0000-0000-0000-000000000000"}),(function(eh){return function(ei){return eh(da.p$1(ei));};}(a.id))(ed))));c$.sTotId=dg.head(S.splitByChar$1(" ",(ee=new cb({$:0,$0:"00000000-0000-0000-0000-000000000000"}),(function(eh){return function(ei){return eh(da.p$2(ei));};}(a.id))(ee))));c$.sDimId=dg.head(S.splitByChar$1(" ",(ef=new b$({$:0,$0:"00000000-0000-0000-0000-000000000000"}),(function(eh){return function(ei){return eh(da.p$3(ei));};}(a.id))(ef))));c$.rexGlobal="(Global)  \\(";c$.rexTotId="\\\"\\. ("+c3.sTotId()+") "+"\""+_1.rexGuid$1();c$.rexCalcId="\\\"\\. ("+c3.sCalId()+") "+"\""+_1.rexGuid$1();c$.rexFormId="\\\"\\. ("+c3.sForId()+") "+"\""+_1.rexGuid$1();c$.rexDimId="\\\"\\. ("+c3.sDimId()+") "+"\""+_1.rexGuid$1();c$.rexFormula="\\((\\d+)\\,\\s*(\\d+)\\) - \\((\\d+)\\,\\s*(\\d+)\\)\\: \"([^\"]+?)\"\\. ForId "+"\""+_1.rexGuid$1();c$.zx=cN.New({$:0,$0:"00000000-0000-0000-0000-000000000000"},false,{$:0,$0:new ca({$:0,$0:"00000000-0000-0000-0000-000000000000"})},[],cM.Add);c$.parents=new dY.New$5();c$.currentCalcOW=(eg=du.get_Do(),du.Bind(function(eh){return du.Bind(function(ei){return du.Bind(function(ej){var ek,el,em,en;return du.Const((ek=(el=c4.runEff(cP.tryFindSelNodeEf(ei,eh)),el==null?null:(em=el.$0.element,em.$==0?{$:1,$0:em.$0}:null)),ek==null?null:(en=ek.$0,dg.tryFind(function(eo){return dn.Equals(eo.calId,en);},ej))));},cZ.model().calculations.v);},cZ.model().selection.get_View());},cZ.model().treeHierarchy.get_View()));c$.currentCalcV=new dw.New((c4.mapDefW(cY.nonCalculation()))(c4.currentCalcOW()),function(eh){c4.setCurrentCalc(eh);});c$.currentFormV=c4.lensForm(c4.currentCalcV(),function(){var eh;eh=cZ.model().selection.Get();return eh==null?null:eh.$0[1];});c$.dtypes=dh.ofArray([b3.DtDataType,b3.DtTime,b3.DtVersion,b3.DtOther]);c$.drag=c6.DragNone;c$.dtypes$1=dh.ofArray([b3.DtDataType,b3.DtTime,b3.DtVersion,b3.DtOther]);c$.RuleEditorLyt="RuleEditorLyt";cZ.set_processor(function(eh){c_.updateModel(cZ.model(),eh);});};da.p$1=function(d1){return"CalId "+de.prettyPrint(d1.$0);};da.p=function(d1){return"ForId "+de.prettyPrint(d1.$0);};da.p$4=function(d1){return d1.$==2?"ForAll":d1.$==1?"ForConsolidated":"ForBase";};da.p$5=function(d1){return d1.$==6?"DtOther":d1.$==5?"DtMeasure":d1.$==4?"DtCalc":d1.$==3?"DtTCalc":d1.$==2?"DtVersion":d1.$==1?"DtTime":"DtDataType";};db.dimensiontable=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"dimensiontable"},d1):void 0;};db.dimensionrow=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"dimensionrow"},d1):void 0;};db.calculationtable=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"calculationtable"},d1):void 0;};db.calculationrow=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"calculationrow"},d1):void 0;};db.totalrow=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"totalrow"},d1):void 0;};db.formularow=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"formularow"},d1):void 0;};da.p$6=function(d1){return d1.$==28?"NoOp":d1.$==27?"LoadTextFile "+de.prettyPrint(d1.$0):d1.$==26?"SaveTextFile "+de.prettyPrint(d1.$0):d1.$==25?"SetForDest ("+da.p$1(d1.$0)+", "+da.p(d1.$1)+", "+da.p$3(d1.$2)+", "+de.prettyPrint(d1.$3)+")":d1.$==24?"RemoveForDest ("+da.p$1(d1.$0)+", "+da.p(d1.$1)+", "+da.p$3(d1.$2)+")":d1.$==23?"AddCalcDim ("+da.p$1(d1.$0)+", "+da.p$3(d1.$1)+")":d1.$==22?"RemoveCalcDim ("+da.p$1(d1.$0)+", "+da.p$3(d1.$1)+")":d1.$==21?"RemoveFormDim ("+da.p(d1.$0)+", "+da.p$3(d1.$1)+")":d1.$==20?"AddFormDim ("+da.p(d1.$0)+", "+da.p$3(d1.$1)+", "+de.prettyPrint(d1.$2)+")":d1.$==19?"SelectDimension "+da.p$3(d1.$0):d1.$==18?"RemoveDimension "+da.p$3(d1.$0):d1.$==17?"AddDimension":d1.$==16?"MoveNode ("+de.prettyPrint(d1.$0)+", "+da.p$8(d1.$1)+", "+da.p$8(d1.$2)+")":d1.$==15?"IndentNode ("+de.prettyPrint(d1.$0)+", "+da.p$8(d1.$1)+")":d1.$==14?"ExpandNode ("+de.prettyPrint(d1.$0)+", "+da.p$8(d1.$1)+")":d1.$==13?"SelectNode "+da.p$8(d1.$0):d1.$==12?"SelectFormNode ("+da.p(d1.$0)+", "+da.p$8(d1.$1)+")":d1.$==11?"SelectFormula "+da.p(d1.$0):d1.$==10?"RemoveFormula "+da.p(d1.$0):d1.$==9?"AddFormula "+da.p$1(d1.$0):d1.$==8?"SelectCalculation "+da.p$1(d1.$0):d1.$==7?"RemoveCalculation "+da.p$1(d1.$0):d1.$==6?"AddCube ("+de.prettyPrint(d1.$0)+", "+de.prettyPrint(d1.$1)+")":d1.$==5?"RenameCube ("+da.p$7(d1.$0)+", "+de.prettyPrint(d1.$1)+")":d1.$==4?"RemoveCube "+da.p$7(d1.$0):d1.$==3?"AddCalculation":d1.$==2?"RemoveTotal "+da.p$2(d1.$0):d1.$==1?"SelectTotal "+da.p$2(d1.$0):"AddTotal";};da.p$8=function(d1){return"TreeNodeId "+de.prettyPrint(d1.$0);};da.p$7=function(d1){return"CubId "+de.prettyPrint(d1.$0);};db.dimsselected=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"dimsselected"},d1):void 0;};db.dimselectedrow=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"dimselectedrow"},d1):void 0;};db.formuladetail=function(d1){d0.LoadLocalTemplates("templates");return d1?d0.NamedTemplate("templates",{$:1,$0:"formuladetail"},d1):void 0;};da.p$2=function(d1){return"TotId "+de.prettyPrint(d1.$0);};da.p$3=function(d1){return"DimId "+de.prettyPrint(d1.$0);};}());

//# sourceMappingURL=RuleEditor.min.map