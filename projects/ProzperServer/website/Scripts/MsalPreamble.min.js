function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW;a=self;b=a.FsRoot=a.FsRoot||{};c=b.TestingJS=b.TestingJS||{};d=c.Msal=c.Msal||{};e=d.PreambleState=d.PreambleState||{};f=a.WebSharper=a.WebSharper||{};g=f.Operators=f.Operators||{};h=a.MsalPreamble_GeneratedPrintf=a.MsalPreamble_GeneratedPrintf||{};i=a.GeneratedPrintf=a.GeneratedPrintf||{};j=a.StartupCode$MsalPreamble$MsalPreamble=a.StartupCode$MsalPreamble$MsalPreamble||{};k=a.EventTarget;l=a.WindowOrWorkerGlobalScope;m=f.JavaScript=f.JavaScript||{};n=m.JS=m.JS||{};o=f.Unchecked=f.Unchecked||{};p=f.Arrays=f.Arrays||{};q=f.Seq=f.Seq||{};r=f.Utils=f.Utils||{};s=f.Obj=f.Obj||{};t=f.UI=f.UI||{};u=t.Var$1=t.Var$1||{};v=t.Var=t.Var||{};w=t.View=t.View||{};x=b.LibraryJS=b.LibraryJS||{};y=x.Msal=x.Msal||{};z=y.AuthenticationParameters=y.AuthenticationParameters||{};A=m.Promise=m.Promise||{};B=f.List=f.List||{};C=B.T=B.T||{};D=t.HtmlModule=t.HtmlModule||{};E=D.attr=D.attr||{};F=t.ViewBuilder=t.ViewBuilder||{};G=y.Configuration=y.Configuration||{};H=y.AuthOptions=y.AuthOptions||{};I=y.Policy=y.Policy||{};J=t.Doc=t.Doc||{};K=m.Pervasives=m.Pervasives||{};L=a.Node;M=b.Library=b.Library||{};N=M.String=M.String||{};O=x.Pojo=x.Pojo||{};P=f.Strings=f.Strings||{};Q=f.Slice=f.Slice||{};R=f.Enumerator=f.Enumerator||{};S=t.ConcreteVar=t.ConcreteVar||{};T=t.Snap=t.Snap||{};U=t.Abbrev=t.Abbrev||{};V=U.Fresh=U.Fresh||{};W=a.Object;X=f.Concurrency=f.Concurrency||{};Y=y.Account=y.Account||{};Z=t.AttrModule=t.AttrModule||{};_0=t.AttrProxy=t.AttrProxy||{};_1=R.T=R.T||{};_2=t.Array=t.Array||{};_3=t.Client=t.Client||{};_4=_3.Templates=_3.Templates||{};_5=X.AsyncBody=X.AsyncBody||{};_6=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};_7=a.Error;_8=m.NonStandardPromiseRejectionException=m.NonStandardPromiseRejectionException||{};_9=X.CT=X.CT||{};_=t.Attrs=t.Attrs||{};$=t.DomUtility=t.DomUtility||{};ba=t.Docs=t.Docs||{};bb=f.Collections=f.Collections||{};bc=bb.Dictionary=bb.Dictionary||{};bd=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};be=X.Scheduler=X.Scheduler||{};bf=f.CancellationTokenSource=f.CancellationTokenSource||{};bg=t.DynamicAttrNode=t.DynamicAttrNode||{};bh=t.Elt=t.Elt||{};bi=bb.FSharpMap=bb.FSharpMap||{};bj=t.DocElemNode=t.DocElemNode||{};bk=a.CharacterData;bl=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bm=bb.HashSet=bb.HashSet||{};bn=t.An=t.An||{};bo=_3.Settings=_3.Settings||{};bp=U.Mailbox=U.Mailbox||{};bq=f.OperationCanceledException=f.OperationCanceledException||{};br=f.Char=f.Char||{};bs=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bt=t.Updates=t.Updates||{};bu=bb.Pair=bb.Pair||{};bv=_3.Attrs=_3.Attrs||{};bw=bv.Dyn=bv.Dyn||{};bx=bb.DictionaryUtil=bb.DictionaryUtil||{};by=_4.Prepare=_4.Prepare||{};bz=bb.KeyCollection=bb.KeyCollection||{};bA=_3.Docs=_3.Docs||{};bB=bA.RunState=bA.RunState||{};bC=bA.NodeSet=bA.NodeSet||{};bD=t.Anims=t.Anims||{};bE=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bF=f.Queue=f.Queue||{};bG=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bH=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bI=t.AppendList=t.AppendList||{};bJ=bb.BalancedTree=bb.BalancedTree||{};bK=t.Easing=t.Easing||{};bL=U.HashSet=U.HashSet||{};bM=bb.HashSetUtil=bb.HashSetUtil||{};bN=bA.DomNodes=bA.DomNodes||{};bO=f.Lazy=f.Lazy||{};bP=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bQ=f.LazyExtensionsProxy=f.LazyExtensionsProxy||{};bR=bQ.LazyRecord=bQ.LazyRecord||{};bS=a.IntelliFactory;bT=bS&&bS.Runtime;bU=a.console;bV=a.jQuery;bW=a.Date;d.preambleStates=function(){j.$cctor();return j.preambleStates;};d.version=function(){j.$cctor();return j.version;};d.storage=function(){j.$cctor();return j.storage;};d.replaceQueryParameters=function(){var bX,bY;bX=P.SplitChars(self.location.href,["?"],0);!o.Equals(bX,null)&&bX.length===2?(bY=p.get(bX,1),p.get(bX,0),q.iter(function(bZ){var b0,b1,b2;b0=P.SplitChars(bZ,["="],0);!o.Equals(b0,null)&&b0.length===2?(b1=p.get(b0,1),b2=p.get(b0,0),d.storage().setItem(b2,a.decodeURIComponent(b1)),(((bT.Curried3(function(b3,b4,b5){return b3("Preamble: Query param: "+r.toSafe(b4)+" = "+r.toSafe(b5));}))(function(b3){bU.log(b3);}))(b2))(b1)):void 0;},P.SplitChars(bY,["&"],0))):void 0;};d.storedVar=function(bX,bY){var bZ,b0;bZ=d.storage().getItem(bX);b0=u.Create$1(bZ===null?bY:bZ);w.Sink(function(b1){d.storage().setItem(bX,b1);},b0.get_View());return b0;};d.storedVarB=function(bX,bY){function bZ(b1){return b1?"1":"";}function b0(b1){return bZ;}return u.Lens(d.storedVar(bX,bZ(bY)),function(b1){return b1==="1";},function(b1,b2){return(b0(b1))(b2);});};d.refreshBeforeB=function(){j.$cctor();return j.refreshBeforeB;};d.createOnStartB=function(){j.$cctor();return j.createOnStartB;};d.forceLoginB=function(){j.$cctor();return j.forceLoginB;};d.editingB=function(){j.$cctor();return j.editingB;};d.applicationId=function(){j.$cctor();return j.applicationId;};d.tenantName=function(){j.$cctor();return j.tenantName;};d.ref=function(){j.$cctor();return j.ref;};d.extraQueryParms=function(){j.$cctor();return j.extraQueryParms;};d.signInPolicy=function(){j.$cctor();return j.signInPolicy;};d.signUpPolicy=function(){j.$cctor();return j.signUpPolicy;};d.editProfilePolicy=function(){j.$cctor();return j.editProfilePolicy;};d.resetPasswordPolicy=function(){j.$cctor();return j.resetPasswordPolicy;};d.policyTypeS=function(){j.$cctor();return j.policyTypeS;};d.goInsideLink=function(){j.$cctor();return j.goInsideLink;};d.scopes=function(){j.$cctor();return j.scopes;};d.preambleStateS=function(){j.$cctor();return j.preambleStateS;};d.policyType=function(){j.$cctor();return j.policyType;};d.preambleState=function(){j.$cctor();return j.preambleState;};d.policyNameW=function(){j.$cctor();return j.policyNameW;};d.authority=function(){j.$cctor();return j.authority;};d.token=function(){j.$cctor();return j.token;};d.userO=function(){j.$cctor();return j.userO;};d.authorityW=function(){j.$cctor();return j.authorityW;};d.authParms=function(){return z.New$1(null,null,null,null,null,null,null,null,{$:1,$0:[(((bT.Curried3(function(bX,bY,bZ){return bX("https://"+r.toSafe(bY)+".onmicrosoft.com/"+r.toSafe(bZ)+"/user_impersonation");}))(a.id))(d.tenantName().Get()))(d.applicationId().Get()),(((bT.Curried3(function(bX,bY,bZ){return bX("https://"+r.toSafe(bY)+".onmicrosoft.com/"+r.toSafe(bZ)+"/Prozper.Admin");}))(a.id))(d.tenantName().Get()))(d.applicationId().Get())]},null,null);};d.agentO=function(){j.$cctor();return j.agentO;};d.ui=function(){var bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9;function b_(){var cA,cB,cC;cA=(cB=d.agentO().Get(),cB==null?null:(cC=cB.$0.getAccount(),o.Equals(cC,null)?null:{$:1,$0:cC}));d.userO().Set(cA);}function b$(cA){return O.newPojo(p.choose(function(cB){return N.splitInTwoO("=",cB);},P.SplitChars(cA,["&"],0)));}function ca(cA,cB){try{!o.Equals(cA,null)?(function(cC){return function(cD){return cC("Preamble redirectCallback error: "+i.p$1(cD));};}(function(cC){bU.log(cC);}))(cA):void 0;!o.Equals(cB,null)?(function(cC){return function(cD){return cC("Preamble redirectCallback resp : "+i.p(cD));};}(function(cC){bU.log(cC);}))(cB):null;}catch(cC){(((bT.Curried3(function(cD,cE,cF){return cD("Preamble redirectCallback exception "+r.prettyPrint(cE)+" "+r.toSafe(cF));}))(function(cD){bU.log(cD);}))(cC))(cC.stack);}}function cb(){return z.New$1(null,null,null,null,{$:1,$0:b$(d.extraQueryParms().Get())},null,null,null,{$:1,$0:p.map(P.Trim,P.SplitChars(d.scopes().Get(),[","],0))},null,null);}function cc(cA){var cB,cC,cD;cB=d.agentO().Get();cB!=null&&cB.$==1?(cC=cB.$0,X.Start((cD=null,X.Delay(function(){var cE;cE=(cA(cC))(cb());return o.Equals(cE,null)?(function(cF){return cF("Preamble executePolicy No promise?");}(function(cF){bU.log(cF);}),X.Zero()):X.Bind(A.AsAsync(cE),function(cF){d.token().Set(cF.accessToken);b_();return X.Zero();});})),null)):void 0;}function cd(){cc(function(cA){return function(cB){cA.loginRedirect({$:1,$0:cB});return null;};});}function ce(){var cA;cA=d.agentO().Get();cA==null?void 0:(cA.$0.logout(),b_());}function cf(cA){var cB;cB=w.Const("");return Z.DynamicPred("disabled",w.Map(function(cC){return!cC;},cA),cB);}function cg(){return cf(w.Map(function(cA){return o.Equals(cA,null);},d.agentO().get_View()));}function ch(){return cf(w.Map(function(cA){return!o.Equals(cA,null);},d.agentO().get_View()));}function ci(cA,cB,cC,cD){var cE,cF;return J.Element("tr",[],[J.Element("td",(cE=cA==null?null:{$:1,$0:B.ofArray([cA.$0])},cE==null?C.Empty:cE.$0),[cB]),J.Element("td",(cF=cC==null?null:{$:1,$0:B.ofArray([cC.$0])},cF==null?C.Empty:cF.$0),[cD])]);}function cj(cA,cB){return ci({$:1,$0:_0.Create("style","text-align:right; width: 20%")},J.Element("label",[],[J.TextNode(cA+":")]),null,cB);}function ck(cA,cB){return ci({$:1,$0:_0.Create("style","text-align:right; width: 20%")},cA,null,J.Input([cg(),_0.Create("style","width: 95%")],cB));}function cl(cA,cB){return ck(J.Element("label",[],[J.TextNode(cA+":")]),cB);}function cm(cA,cB,cC){return J.Select(cA,a.String,cC,cB);}function cn(cA,cB){return J.Element("table",[],[J.Element("tbody",[],B.ofSeq(q.delay(function(){function cC(cD,cE){return J.Element("tr",[],[J.Element("td",[],[J.Element("b",[],[J.TextNode(cD)])]),J.Element("td",[],[J.TextNode((function(cF){return function(cG){return cF(r.prettyPrint(cG));};}(a.id))(cE))])]);}return q.map(function(cD){return cC(cD[0],cD[1]);},q.filter(cA,n.GetFields(cB)));})))]);}function co(cA,cB,cC){var cD;return J.BindView(a.id,(cD=w.get_Do(),w.Bind(function(cE){return w.Const(J.Button(cE+" "+cA,[cB?cg():ch()],cC));},d.policyTypeS().get_View())));}function cp(cA,cB,cC){return J.Button(a.String(cA)+" Policy: ",[cf(cB)],cC);}function cq(cA,cB){return J.Element("span",[],[J.TextNode(cA),J.CheckBox([],cB)]);}function cr(){var cA,cB,cC;cA={$:1,$0:(cB=(cC=G.New$1({$:1,$0:H.New$1(d.applicationId().Get(),{$:1,$0:d.authority().Get()},{$:1,$0:false},null,null,null)},null,null,null),new self.Msal.UserAgentApplication(cC)),(function(cD){cD.handleRedirectCallback(bT.CreateFuncWithArgs(function(cE){return ca(cE[0],cE[1]);}));}(cB),cB))};d.agentO().Set(cA);d.editingB().Set(false);b_();}function cs(cA){var cB;X.Start((cB=null,X.Delay(function(){d.policyType().Set(cA);return X.Bind(w.GetAsync(d.authorityW()),function(){cr();cd();return X.Zero();});})),null);}function ct(){cs(I.SignIn);}function cu(){cs(I.SignUp);}function cv(){cs(I.EditProfile);}function cw(){cs(I.ResetPassword);}function cx(){self.location.replace(d.goInsideLink().Get());}function cy(cA){var cB;switch(cA.$==1?1:cA.$==2?2:cA.$==3?3:cA.$==4?4:cA.$==5?5:cA.$==6?6:cA.$==7?6:cA.$==8?6:cA.$==9?6:cA.$==10?7:cA.$==11?8:0){case 0:return[e.GoingToSignIn,d.forceLoginB().Get()?{$:1,$0:ce}:null];case 1:return[e.WentToSignIn,{$:1,$0:ct}];case 2:return[e.GoingToSignUp,{$:1,$0:ce}];case 3:return[e.WentToSignUp,{$:1,$0:cu}];case 4:return[e.WentToEditProfile,{$:1,$0:cv}];case 5:return[e.WentToResetPassword,{$:1,$0:cw}];case 6:return self.location.hash!==""?[cA,{$:1,$0:a.ignore}]:d.goInsideLink().Get()===""?[e.InPreamble,null]:d.userO().Get()!=null?[e.WentInside,{$:1,$0:cx}]:[e.GoingToSignIn,{$:1,$0:ce}];case 7:return d.goInsideLink().Get()===""?[e.InPreamble,null]:[e.GoingToSignIn,{$:1,$0:ce}];case 8:return[e.InPreamble,null];}}function cz(){var cA;cA=null;return X.Delay(function(){var cB,cC,cD,cE;cB=d.userO().Get();cC=d.agentO().Get();return cB!=null&&cB.$==1&&(cC!=null&&cC.$==1&&(cD=[cC.$0,cB.$0],true))?(cE=cD[0],X.TryWith(X.Delay(function(){return X.Bind(A.AsAsync(cE.acquireTokenSilent(cb())),function(cF){return X.Return({$:1,$0:cF.accessToken});});}),function(){return X.Bind(X.FromContinuations(function(cF,cG){cE.handleRedirectCallback(function(cH,cI){try{!o.Equals(cH,null)?(bU.log(["redirectCallback ERROR: ",cH]),cG(new _7(cH.errorMessage))):!o.Equals(cI,null)?(bU.log(["redirectCallback: ",cI]),cF(cI)):null;}catch(cJ){(((bT.Curried3(function(cK,cL,cM){return cK("Preamble getTokenO0 exception "+r.prettyPrint(cL)+" "+r.toSafe(cM));}))(function(cK){bU.log(cK);}))(cJ))(cJ.stack);}});return cE.acquireTokenRedirect(cb());}),function(cF){return X.Return({$:1,$0:cF.accessToken});});})):X.Return(null);});}bX=J.BindView(a.id,(bY=w.get_Do(),w.Bind(function(cA){return w.Bind(function(cB){return w.Bind(function(cC){var cD,cE,cF,cG,cH;cG=J.Element("h3",C.Empty,[J.TextNode((cD=cA==null?null:{$:1,$0:(cE=cA.$0,(((bT.Curried3(function(cI,cJ,cK){return cI("Hello "+r.toSafe(cJ)+" "+r.toSafe(cK)+".");}))(a.id))(cE.idToken.given_name))(cE.idToken.family_name))},cD==null?"":cD.$0))]);switch(cB==null?0:cA==null?cC.$==1?3:cC.$==2?4:(cF=cC,5):cC.$==0?1:cC.$==1?2:(cF=cC,5)){case 0:return w.Const(J.TextNode("Select your options and click on <Create Agent>."));case 1:return w.Const(cG);case 2:return w.Const(J.Concat(B.ofArray([cG,J.TextNode(function(cI){return cI("To Sign Up click on <Logout> first!");}(a.id))])));case 3:return w.Const(J.TextNode(function(cI){return cI("To Sign Up make sure to really be logged out by clicking on <Logout> first and then click on Sign Up Popup or Redirect!");}(a.id)));case 4:return w.Const(J.TextNode(function(cI){return cI("Sign In before invoking Edit Profile!");}(a.id)));case 5:cH=a.String(cF);return w.Const(J.Concat(B.ofArray([cG,J.TextNode(((((bT.Curried(function(cI,cJ,cK,cL){return cI("To "+r.toSafe(cJ)+" click on <"+r.toSafe(cK)+" Popup> or <"+r.toSafe(cL)+" Redirect>.");},4))(a.id))(cH))(cH))(cH))])));}},d.policyType().get_View());},d.agentO().get_View());},d.userO().get_View())));bZ=w.Map2(function(cA,cB){return cA!=null&&cB==null;},d.agentO().get_View(),d.userO().get_View());b0=w.Map2(function(cA,cB){return cA!=null&&cB==null;},d.agentO().get_View(),d.userO().get_View());b1=w.Map2(function(cA,cB){return cA!=null&&cB!=null;},d.agentO().get_View(),d.userO().get_View());b2=w.Map(function(cA){return cA!=null;},d.agentO().get_View());d.createOnStartB().Get()&&!d.editingB().Get()?(cr(),b_(),(((bT.Curried3(function(cA,cB,cC){return cA("Preamble updateState ENTERING STATE "+h.p$1(cB)+", user = "+r.prettyPrint(cC));}))(function(cA){bU.log(cA);}))(d.preambleState().Get()))(d.userO().Get()!=null),b3=function(cA){var cB,cC,cD;while(true){cB=cy(cA);cC=cB[0];cD=cB[1];if(cD==null&&cC.$!==11)cA=cC;else return[cC,cD];}}(d.preambleState().Get()),b4=b3[1],d.preambleState().Set(b3[0]),X.Start((b5=null,X.Delay(function(){return X.Combine(X.While(function(){return!o.Equals(d.preambleState().Get(),e.Parse(d.storage().getItem("preambleState")));},X.Delay(function(){return X.Bind(X.Sleep(50),function(){return X.Return(null);});})),X.Delay(function(){(((bT.Curried3(function(cA,cB,cC){return cA("Preamble updateState EXITING STATE "+h.p$1(cB)+" = "+r.toSafe(cC));}))(function(cA){bU.log(cA);}))(d.preambleState().Get()))(d.storage().getItem("preambleState"));b4==null?void 0:b4.$0();return X.Zero();}));})),null)):void 0;b6=d.preambleState().Get().$!==11&&d.createOnStartB().Get()&&!d.editingB().Get();b7=J.Element("div",[],[J.Element("h1",[],[J.TextNode((function(cA){return function(cB){return cA("Msal.js "+r.toSafe(cB)+" (Microsoft authentication library) & Azure AD B2C");};}(a.id))(d.version()))]),J.Element("br",[],[]),J.Element("table",[],[J.Element("tbody",[],[ci(null,J.Button("Create Agent",[cg()],cr),null,cq("Create on Start",d.createOnStartB())),ci(null,J.Button("Edit",[ch()],function(){if(d.refreshBeforeB().Get()){d.editingB().Set(true);self.location.reload();}else d.agentO().Set(null);}),null,cq("Refresh before Edit",d.refreshBeforeB()))])]),J.Element("br",[],[]),J.Element("table",[_0.Create("style","width: 95%")],[J.Element("tbody",[],[cj("preamble state",J.Concat([cm(C.Empty,d.preambleState(),d.preambleStates()),J.TextNode("Refresh (F5) to update state")])),cl("App Id",d.applicationId()),cl("tenant Name",d.tenantName()),cl("ref/state",d.ref()),cl("extra query parameters",d.extraQueryParms()),cl("go Inside link",d.goInsideLink()),ck(J.Concat(B.ofArray([cq("Force login dialog",d.forceLoginB()),cp(I.SignIn,bZ,ct)])),d.signInPolicy()),ck(cp(I.SignUp,b0,cu),d.signUpPolicy()),ck(cp(I.EditProfile,b1,cv),d.editProfilePolicy()),ck(cp(I.ResetPassword,b2,cw),d.resetPasswordPolicy()),J.Element("tr",[],[]),cj("policy type",cm(B.ofArray([cg()]),d.policyType(),y.policies())),cl("Authority",d.authority()),ck(J.Button("Scopes",[cf(b1)],function(){var cA;X.Start((cA=null,X.Delay(function(){var cB;cB=d.agentO().Get();return cB!=null&&cB.$==1?X.Bind(A.AsAsync(cB.$0.acquireTokenSilent(cb())),function(cC){((function(cD){return function(cE){return cD("Preamble actObtainToken "+i.p(cE));};}(function(cD){bU.log(cD);}))(cC));return X.Zero();}):X.Zero();})),null);}),d.scopes())])]),J.Element("br",[],[]),J.Element("div",[],[J.Button("Logout",[ch()],ce)]),bX,J.Element("div",[],[co("Popup",false,function(){cc(function(cA){return function(cB){return cA.loginPopup({$:1,$0:cB});};});})]),J.Element("div",[],[co("Redirect",false,cd)]),J.Element("br",[],[]),J.Element("b",[],[J.TextNode("Token: ")]),J.TextView(d.token().get_View()),J.Element("br",[],[]),J.Element("div",[],[J.Button("Check User",[ch()],b_)]),J.Element("div",[],[J.Button("Get Token",[ch()],function(){function cA(cC){bU.log(cC);}function cB(cC){return X.Return(cC);}X.Start(X.Bind(cz(),function(cC){return cB(cA(cC));}),null);})]),J.Element("h5",[],[J.TextNode("User: ")]),J.BindView(a.id,(b8=w.get_Do(),w.Bind(function(cA){var cB;function cC(cE){return cE[0];}function cD(cE){return"idToken"!==cE;}return cA!=null&&cA.$==1?(cB=cA.$0,w.Const(J.Concat(B.ofArray([cn(function(cE){return cD(cC(cE));},cB),J.Element("h4",[],[J.TextNode("idToken")]),cn(function(){return true;},cB.idToken)])))):w.Const(J.get_Empty());},d.userO().get_View()))),J.Element("a",[_0.Create("href","https://gist.github.com/amieres/bc8e39f2e1e6e54fd1dfaeeae24ad304")],[J.TextNode("gist")])]);!b6?(b9=self.document.body,_4.LoadLocalTemplates(""),J.Run(b9,b7)):void 0;};d.main=function(){j.$cctor();return j.main;};e=d.PreambleState=bT.Class({toString:function(){return(function(bX){return function(bY){return bX(h.p$1(bY));};}(a.id))(this);}},null,e);e.Parse=function(bX){var bY;bY=P.Replace(bX," ","");return bY==="GoToSignIn"?e.GoToSignIn:bY==="GoingToSignIn"?e.GoingToSignIn:bY==="GoToSignUp"?e.GoToSignUp:bY==="GoingToSignUp"?e.GoingToSignUp:bY==="GoToEditProfile"?e.GoToEditProfile:bY==="GoToResetPassword"?e.GoToResetPassword:bY==="WentToSignIn"?e.WentToSignIn:bY==="WentToSignUp"?e.WentToSignUp:bY==="WentToEditProfile"?e.WentToEditProfile:bY==="WentToResetPassword"?e.WentToResetPassword:bY==="WentInside"?e.WentInside:e.InPreamble;};e.GoToSignIn=new e({$:0});e.GoingToSignIn=new e({$:1});e.GoToSignUp=new e({$:2});e.GoingToSignUp=new e({$:3});e.GoToEditProfile=new e({$:4});e.GoToResetPassword=new e({$:5});e.WentToSignIn=new e({$:6});e.WentToSignUp=new e({$:7});e.WentToEditProfile=new e({$:8});e.WentToResetPassword=new e({$:9});e.WentInside=new e({$:10});e.InPreamble=new e({$:11});g.FailWith=function(bX){throw new _7(bX);};g.KeyValue=function(bX){return[bX.K,bX.V];};h.p$1=function(bX){return bX.$==11?"InPreamble":bX.$==10?"WentInside":bX.$==9?"WentToResetPassword":bX.$==8?"WentToEditProfile":bX.$==7?"WentToSignUp":bX.$==6?"WentToSignIn":bX.$==5?"GoToResetPassword":bX.$==4?"GoToEditProfile":bX.$==3?"GoingToSignUp":bX.$==2?"GoToSignUp":bX.$==1?"GoingToSignIn":"GoToSignIn";};i.p=function(bX){return"{"+("accessToken = "+r.prettyPrint(bX.accessToken))+"; "+("account = "+r.prettyPrint(bX.account))+"; "+("accountState = "+r.prettyPrint(bX.accountState))+"; "+("expiresOn = "+r.prettyPrint(bX.expiresOn))+"; "+("idToken = "+r.prettyPrint(bX.idToken))+"; "+("scopes = "+r.prettyPrint(bX.scopes))+"; "+("tenantId = "+r.prettyPrint(bX.tenantId))+"; "+("tokenType = "+r.prettyPrint(bX.tokenType))+"; "+("uniqueId = "+r.prettyPrint(bX.uniqueId))+"}";};i.p$1=function(bX){return"{"+("errorCode = "+r.prettyPrint(bX.errorCode))+"; "+("errorMessage = "+r.prettyPrint(bX.errorMessage))+"; "+("message = "+r.prettyPrint(bX.message))+"; "+("name = "+r.prettyPrint(bX.name))+"; "+("stack = "+h.p$2(bX.stack))+"}";};h.p$2=function(bX){return bX==null?"null":"Some "+r.prettyPrint(bX.$0);};h.p=function(bX){return bX.$==3?"ResetPassword":bX.$==2?"EditProfile":bX.$==1?"SignUp":"SignIn";};j.$cctor=function(){var bX,bY,bZ,b0,b1;j.$cctor=a.ignore;function b2(b8){return P.concat("\n",b8);}function b3(b8){return N.splitByChar("\n",b8);}function b4(b8){var b9,b_;return Q.array(b8,{$:1,$0:0},{$:1,$0:(b9=0,(b_=p.length(b8)-2,o.Compare(b9,b_)===1?b9:b_))});}function b5(b8){return P.concat("\n",b8);}function b6(b8){return a.String;}function b7(b8){return a.String;}j.rtn=function(b8){return[b8];};j.unindentStr=function(b8){return b2(N.unindent(b8));};j.skipLastLine=(bX=function(b8){return b4(b3(b8));},function(b8){return b5(bX(b8));});j.policies=B.ofArray([I.SignIn,I.SignUp,I.EditProfile,I.ResetPassword]);j.preambleStates=B.ofArray([e.GoToSignIn,e.GoingToSignIn,e.GoToSignUp,e.GoingToSignUp,e.GoToEditProfile,e.GoToResetPassword,e.WentToSignIn,e.WentToSignUp,e.WentToEditProfile,e.WentToResetPassword,e.WentInside,e.InPreamble]);j.version="1.0.0";j.storage=self.localStorage;d.replaceQueryParameters();j.refreshBeforeB=d.storedVarB("refreshBefore",false);j.createOnStartB=d.storedVarB("createOnStart",true);j.forceLoginB=d.storedVarB("forceLogin",false);j.editingB=d.storedVarB("Editing",false);j.applicationId=d.storedVar("applicationId","faf95af2-18b5-4895-9663-18f7feb95def");j.tenantName=d.storedVar("tenantName","prozper");j.ref=d.storedVar("ref","");j.extraQueryParms=d.storedVar("extraQueryParms","mkt=es-us");j.signInPolicy=d.storedVar("signInPolicy","B2C_1_SignIn");j.signUpPolicy=d.storedVar("signUpPolicy","B2C_1_Registrarse");j.editProfilePolicy=d.storedVar("editProfilePolicy","B2C_1_EditarPerfil");j.resetPasswordPolicy=d.storedVar("resetPasswordPolicy","B2C_1_PasswordReset");j.policyTypeS=d.storedVar("policyType","SignIn");j.goInsideLink=d.storedVar("goInsideLink","");j.scopes=d.storedVar("scopes","https://prozper.onmicrosoft.com/faf95af2-18b5-4895-9663-18f7feb95def/user_impersonation");j.preambleStateS=d.storedVar("preambleState","InPreamble");j.policyType=u.Lens(d.policyTypeS(),I.Parse,function(b8,b9){return(b6(b8))(b9);});j.preambleState=u.Lens(d.preambleStateS(),e.Parse,function(b8,b9){return(b7(b8))(b9);});j.policyNameW=(bY=w.get_Do(),w.Bind(function(b8){return w.Bind(function(b9){return w.Const(b9);},b8.$==1?d.signUpPolicy().get_View():b8.$==2?d.editProfilePolicy().get_View():b8.$==3?d.resetPasswordPolicy().get_View():d.signInPolicy().get_View());},d.policyType().get_View()));j.authority=u.Create$1("");j.token=u.Create$1("");j.userO=u.Create$1(null);j.authorityW=(bZ=w.get_Do(),w.Bind(function(b8){return w.Bind(function(b9){return w.Const(((((bT.Curried(function(b_,b$,ca,cb){return b_("https://"+r.toSafe(b$)+".b2clogin.com/tfp/"+r.toSafe(ca)+".onmicrosoft.com/"+r.toSafe(cb));},4))(a.id))(b8))(b8))(b9));},d.policyNameW());},d.tenantName().get_View()));w.Sink(function(b8){d.authority().Set(b8);},d.authorityW());j.agentO=u.Create$1(null);j.main=self.location.search!==""?self.location.replace(p.get(P.SplitChars(self.location.href,["?"],0),0)):(b0=J.Element("script",[_0.Create("src",(function(b8){return function(b9){return b8("https://secure.aadcdn.microsoftonline-p.com/lib/"+r.toSafe(b9)+"/js/msal.min.js");};}(a.id))(d.version())),_0.OnAfterRenderImpl(function(){var b8;X.Start((b8=null,X.Delay(function(){return X.Combine(X.While(function(){return!self.Msal;},X.Delay(function(){return X.Bind(X.Sleep(50),function(){return X.Return(null);});})),X.Delay(function(){d.ui();return X.Zero();}));})),null);})],[]),(b1=self.document.head,(_4.LoadLocalTemplates(""),J.Run(b1,b0))));};n.GetFields=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push([b0,bX[b0]]);return bY;};n.GetFieldValues=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push(bX[b0]);return bY;};o.Equals=function(bX,bY){var bZ,b0,b1,b2;if(bX===bY)return true;else{bZ=typeof bX;if(bZ=="object"){if(bX===null||bX===void 0||bY===null||bY===void 0)return false;else if("Equals"in bX)return bX.Equals(bY);else if(bX instanceof a.Array&&bY instanceof a.Array)return o.arrayEquals(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)return o.dateEquals(bX,bY);else{b0=[true];for(var b3 in bX)if(function(b4){b0[0]=!bX.hasOwnProperty(b4)||bY.hasOwnProperty(b4)&&o.Equals(bX[b4],bY[b4]);return!b0[0];}(b3))break;if(b0[0]){for(var b4 in bY)if(function(b5){b0[0]=!bY.hasOwnProperty(b5)||bX.hasOwnProperty(b5);return!b0[0];}(b4))break;}return b0[0];}}else return bZ=="function"&&("$Func"in bX?bX.$Func===bY.$Func&&bX.$Target===bY.$Target:"$Invokes"in bX&&"$Invokes"in bY&&o.arrayEquals(bX.$Invokes,bY.$Invokes));}};o.arrayEquals=function(bX,bY){var bZ,b0;if(p.length(bX)===p.length(bY)){bZ=true;b0=0;while(bZ&&b0<p.length(bX)){!o.Equals(p.get(bX,b0),p.get(bY,b0))?bZ=false:void 0;b0=b0+1;}return bZ;}else return false;};o.dateEquals=function(bX,bY){return bX.getTime()===bY.getTime();};o.Compare=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bX===bY)return 0;else{b0=typeof bX;switch(b0=="function"?1:b0=="boolean"?2:b0=="number"?2:b0=="string"?2:b0=="object"?3:0){case 0:return typeof bY=="undefined"?0:-1;case 1:return g.FailWith("Cannot compare function values.");case 2:return bX<bY?-1:1;case 3:if(bX===null)b1=-1;else if(bY===null)b1=1;else if("CompareTo"in bX)b1=bX.CompareTo(bY);else if("CompareTo0"in bX)b1=bX.CompareTo0(bY);else if(bX instanceof a.Array&&bY instanceof a.Array)b1=o.compareArrays(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)b1=o.compareDates(bX,bY);else{b2=[0];for(var b5 in bX)if(function(b6){return!bX.hasOwnProperty(b6)?false:!bY.hasOwnProperty(b6)?(b2[0]=1,true):(b2[0]=o.Compare(bX[b6],bY[b6]),b2[0]!==0);}(b5))break;if(b2[0]===0){for(var b6 in bY)if(function(b7){return!bY.hasOwnProperty(b7)?false:!bX.hasOwnProperty(b7)&&(b2[0]=-1,true);}(b6))break;}b1=b2[0];}return b1;}}};o.compareArrays=function(bX,bY){var bZ,b0;if(p.length(bX)<p.length(bY))return -1;else if(p.length(bX)>p.length(bY))return 1;else{bZ=0;b0=0;while(bZ===0&&b0<p.length(bX)){bZ=o.Compare(p.get(bX,b0),p.get(bY,b0));b0=b0+1;}return bZ;}};o.compareDates=function(bX,bY){return o.Compare(bX.getTime(),bY.getTime());};o.Hash=function(bX){var bY;bY=typeof bX;return bY=="function"?0:bY=="boolean"?bX?1:0:bY=="number"?bX:bY=="string"?o.hashString(bX):bY=="object"?bX==null?0:bX instanceof a.Array?o.hashArray(bX):o.hashObject(bX):0;};o.hashString=function(bX){var bY,bZ,b0;if(bX===null)return 0;else{bY=5381;for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY=o.hashMix(bY,bX[bZ].charCodeAt());return bY;}};o.hashArray=function(bX){var bY,bZ,b0;bY=-34948909;for(bZ=0,b0=p.length(bX)-1;bZ<=b0;bZ++)bY=o.hashMix(bY,o.Hash(p.get(bX,bZ)));return bY;};o.hashObject=function(bX){var bY,bZ;if("GetHashCode"in bX)return bX.GetHashCode();else{bY=[0];for(var b0 in bX)if(function(b1){bY[0]=o.hashMix(o.hashMix(bY[0],o.hashString(b1)),o.Hash(bX[b1]));return false;}(b0))break;return bY[0];}};o.hashMix=function(bX,bY){return(bX<<5)+bX+bY;};p.map=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bY.length);for(b0=0,b1=bY.length-1;b0<=b1;b0++)bZ[b0]=bX(bY[b0]);return bZ;};p.choose=function(bX,bY){var bZ,b0,b1,b2;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++){b2=bX(bY[b0]);b2==null?void 0:bZ.push(b2.$0);}return bZ;};p.ofList=function(bX){var bY,bZ;bZ=[];bY=bX;while(!(bY.$==0)){bZ.push(B.head(bY));bY=B.tail(bY);}return bZ;};p.ofSeq=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX.slice();else if(bX instanceof C)return p.ofList(bX);else{bY=[];bZ=R.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};p.filter=function(bX,bY){var bZ,b0,b1;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++)if(bX(bY[b0]))bZ.push(bY[b0]);return bZ;};p.exists=function(bX,bY){var bZ,b0,b1,b2;bZ=false;b0=0;b2=p.length(bY);while(!bZ&&b0<b2)if(bX(bY[b0]))bZ=true;else b0=b0+1;return bZ;};p.tryPick=function(bX,bY){var bZ,b0,b1;bZ=null;b0=0;while(b0<bY.length&&bZ==null){b1=bX(bY[b0]);b1!=null&&b1.$==1?bZ=b1:void 0;b0=b0+1;}return bZ;};p.tryFindIndex=function(bX,bY){var bZ,b0;bZ=null;b0=0;while(b0<bY.length&&bZ==null){bX(bY[b0])?bZ={$:1,$0:b0}:void 0;b0=b0+1;}return bZ;};p.foldBack=function(bX,bY,bZ){var b0,b1,b2,b3,b4;b0=bZ;b2=bY.length;for(b3=1,b4=b2;b3<=b4;b3++)b0=bX(bY[b2-b3],b0);return b0;};p.iter=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bX(bY[bZ]);};p.concat=function(bX){return a.Array.prototype.concat.apply([],p.ofSeq(bX));};p.pick=function(bX,bY){var bZ;bZ=p.tryPick(bX,bY);return bZ==null?g.FailWith("KeyNotFoundException"):bZ.$0;};p.create=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY;return bZ;};p.init=function(bX,bY){var bZ,b0,b1;bX<0?g.FailWith("Negative size given."):null;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY(b0);return bZ;};p.forall=function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=p.length(bY);while(bZ&&b0<b2)if(bX(bY[b0]))b0=b0+1;else bZ=false;return bZ;};p.get=function(bX,bY){p.checkBounds(bX,bY);return bX[bY];};p.checkBounds=function(bX,bY){if(bY<0||bY>=bX.length)g.FailWith("Index was outside the bounds of the array.");};p.length=function(bX){return bX.dims===2?bX.length*bX.length:bX.length;};p.set=function(bX,bY,bZ){p.checkBounds(bX,bY);bX[bY]=bZ;};q.iter=function(bX,bY){var bZ;bZ=R.Get(bY);try{while(bZ.MoveNext())bX(bZ.Current());}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};q.delay=function(bX){return{GetEnumerator:function(){return R.Get(bX());}};};q.filter=function(bX,bY){return{GetEnumerator:function(){var bZ;bZ=R.Get(bY);return new _1.New(null,null,function(b0){var b1,b2,b3;b1=bZ.MoveNext();b2=bZ.Current();b3=false;while(b1)if(bX(b2)){b0.c=b2;b3=true;b1=false;}else if(bZ.MoveNext())b2=bZ.Current();else b1=false;return b3;},function(){bZ.Dispose();});}};};q.map=function(bX,bY){return{GetEnumerator:function(){var bZ;bZ=R.Get(bY);return new _1.New(null,null,function(b0){return bZ.MoveNext()&&(b0.c=bX(bZ.Current()),true);},function(){bZ.Dispose();});}};};q.tryFind=function(bX,bY){var bZ,b0,b1;bZ=R.Get(bY);try{b0=null;while(b0==null&&bZ.MoveNext()){b1=bZ.Current();bX(b1)?b0={$:1,$0:b1}:void 0;}return b0;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};q.tryFindIndex=function(bX,bY){var bZ,b0,b1;bZ=R.Get(bY);try{b0=true;b1=0;while(b0&&bZ.MoveNext())if(bX(bZ.Current()))b0=false;else b1=b1+1;return b0?null:{$:1,$0:b1};}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};q.choose=function(bX,bY){return q.collect(function(bZ){var b0;b0=bX(bZ);return b0==null?C.Empty:B.ofArray([b0.$0]);},bY);};q.append=function(bX,bY){return{GetEnumerator:function(){var bZ,b0;bZ=R.Get(bX);b0=[true];return new _1.New(bZ,null,function(b1){var b2;return b1.s.MoveNext()?(b1.c=b1.s.Current(),true):(b2=b1.s,!o.Equals(b2,null)?b2.Dispose():void 0,b1.s=null,b0[0]&&(b0[0]=false,b1.s=R.Get(bY),b1.s.MoveNext()?(b1.c=b1.s.Current(),true):(b1.s.Dispose(),b1.s=null,false)));},function(b1){var b2;b2=b1.s;!o.Equals(b2,null)?b2.Dispose():void 0;});}};};q.collect=function(bX,bY){return q.concat(q.map(bX,bY));};q.head=function(bX){var bY;bY=R.Get(bX);try{return bY.MoveNext()?bY.Current():q.insufficient();}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};q.mapi=function(bX,bY){return q.map2(bX,q.initInfinite(a.id),bY);};q.concat=function(bX){return{GetEnumerator:function(){var bY;bY=R.Get(bX);return new _1.New(null,null,function(bZ){var b0;while(true){b0=bZ.s;if(o.Equals(b0,null)){if(bY.MoveNext()){bZ.s=R.Get(bY.Current());bZ=bZ;}else{bY.Dispose();return false;}}else if(b0.MoveNext()){bZ.c=b0.Current();return true;}else{bZ.Dispose();bZ.s=null;bZ=bZ;}}},function(bZ){var b0;b0=bZ.s;!o.Equals(b0,null)?b0.Dispose():void 0;!o.Equals(bY,null)?bY.Dispose():void 0;});}};};q.findIndex=function(bX,bY){var bZ;bZ=q.tryFindIndex(bX,bY);return bZ==null?g.FailWith("KeyNotFoundException"):bZ.$0;};q.map2=function(bX,bY,bZ){return{GetEnumerator:function(){var b0,b1;b0=R.Get(bY);b1=R.Get(bZ);return new _1.New(null,null,function(b2){return b0.MoveNext()&&b1.MoveNext()&&(b2.c=bX(b0.Current(),b1.Current()),true);},function(){b0.Dispose();b1.Dispose();});}};};q.initInfinite=function(bX){return{GetEnumerator:function(){return new _1.New(0,null,function(bY){bY.c=bX(bY.s);bY.s=bY.s+1;return true;},void 0);}};};q.forall2=function(bX,bY,bZ){return!q.exists2(function(b0,b1){return!bX(b0,b1);},bY,bZ);};q.compareWith=function(bX,bY,bZ){var b0,b1,b2,b3,b4;b0=R.Get(bY);try{b2=R.Get(bZ);try{b3=0;b4=true;while(b4&&b3===0)if(b0.MoveNext())b3=b2.MoveNext()?bX(b0.Current(),b2.Current()):1;else if(b2.MoveNext())b3=-1;else b4=false;b1=b3;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return b1;}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};q.fold=function(bX,bY,bZ){var b0,b1;b0=bY;b1=R.Get(bZ);try{while(b1.MoveNext())b0=bX(b0,b1.Current());return b0;}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}};q.exists2=function(bX,bY,bZ){var b0,b1,b2,b3;b0=R.Get(bY);try{b2=R.Get(bZ);try{b3=false;while(!b3&&b0.MoveNext()&&b2.MoveNext())b3=bX(b0.Current(),b2.Current());b1=b3;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return b1;}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};q.nth=function(bX,bY){var bZ,b0;if(bX<0)g.FailWith("negative index requested");bZ=-1;b0=R.Get(bY);try{while(bZ<bX){!b0.MoveNext()?q.insufficient():void 0;bZ=bZ+1;}return b0.Current();}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};q.max=function(bX){var bY,bZ,b0;bY=R.Get(bX);try{if(!bY.MoveNext())q.seqEmpty();bZ=bY.Current();while(bY.MoveNext()){b0=bY.Current();o.Compare(b0,bZ)===1?bZ=b0:void 0;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};q.unfold=function(bX,bY){return{GetEnumerator:function(){return new _1.New(bY,null,function(bZ){var b0;b0=bX(bZ.s);return b0==null?false:(bZ.c=b0.$0[0],bZ.s=b0.$0[1],true);},void 0);}};};q.seqEmpty=function(){return g.FailWith("The input sequence was empty.");};r.toSafe=function(bX){return bX==null?"":bX;};r.prettyPrint=function(bX){var bY,bZ;function b0(b1,b2){return b1+" = "+r.prettyPrint(b2);}return bX===null?"null":(bY=typeof bX,bY=="string"?"\""+bX+"\"":bY=="object"?bX instanceof a.Array?"[|"+P.concat("; ",p.map(r.prettyPrint,bX))+"|]":(bZ=a.String(bX),bZ==="[object Object]"?"{"+P.concat("; ",p.map(function(b1){return b0(b1[0],b1[1]);},n.GetFields(bX)))+"}":bZ):a.String(bX));};s=f.Obj=bT.Class({Equals:function(bX){return this===bX;},GetHashCode:function(){return -1;}},null,s);s.New=bT.Ctor(function(){},s);u=t.Var$1=bT.Class({},s,u);u.Create$1=function(bX){return new S.New(false,T.New({$:2,$0:bX,$1:[]}),bX);};u.Lens=function(bX,bY,bZ){var b0,b1,b2;b0=V.Id();b1=w.Map(bY,bX.get_View());b2=new v({Get:function(){return bY(bX.Get());},Set:function(b3){return bX.Update(function(b4){return bZ(b4,b3);});},SetFinal:function(b3){return this.Set(b3);},Update:function(b3){return bX.Update(function(b4){return bZ(b4,b3(bY(b4)));});},UpdateMaybe:function(b3){return bX.UpdateMaybe(function(b4){var b5;b5=b3(bY(b4));return b5==null?null:{$:1,$0:bZ(b4,b5.$0)};});},get_View:function(){return b1;},get_Id:function(){return b0;}});v.New.call(b2);return b2;};v=t.Var=bT.Class({},s,v);v.New=bT.Ctor(function(){s.New.call(this);},v);w.Sink=function(bX,bY){function bZ(){T.WhenRun(bY(),bX,function(){X.scheduler().Fork(bZ);});}X.scheduler().Fork(bZ);};w.Map=function(bX,bY){return w.CreateLazy(function(){return T.Map(bX,bY());});};w.Const=function(bX){var bY;bY=T.New({$:0,$0:bX});return function(){return bY;};};w.get_Do=function(){return F.B;};w.Map2=function(bX,bY,bZ){return w.CreateLazy(function(){return T.Map2(bX,bY(),bZ());});};w.GetAsync=function(bX){return X.FromContinuations(function(bY){return w.Get(bY,bX);});};w.CreateLazy=function(bX){var bY;bY={c:null,o:bX};return function(){var bZ,b0;bZ=bY.c;return bZ===null?(bZ=bY.o(),bY.c=bZ,(b0=bZ.s,b0!=null&&b0.$==0)?bY.o=null:T.WhenObsoleteRun(bZ,function(){bY.c=null;}),bZ):bZ;};};w.Bind=function(bX,bY){return w.Join(w.Map(bX,bY));};w.Get=function(bX,bY){var bZ;function b0(){T.WhenRun(bY(),function(b1){if(!bZ[0]){bZ[0]=true;bX(b1);}},function(){if(!bZ[0])b0();});}bZ=[false];b0();};w.Join=function(bX){return w.CreateLazy(function(){return T.Join(bX());});};w.Map2Unit=function(bX,bY){return w.CreateLazy(function(){return T.Map2Unit(bX(),bY());});};z.New$1=function(bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7){return O.newPojoOpt([y.op_EqualsEqualsGreater("account",bX),y.op_EqualsEqualsGreater("authority",bY),y.op_EqualsEqualsGreater("claimsRequest",bZ),y.op_EqualsEqualsGreater("correlationId",b0),y.op_EqualsEqualsGreater("extraQueryParameters",b1),y.op_EqualsEqualsGreater("extraScopesToConsent",b2),y.op_EqualsEqualsGreater("loginHint",b3),y.op_EqualsEqualsGreater("prompt",b4),y.op_EqualsEqualsGreater("scopes",b5),y.op_EqualsEqualsGreater("sid",b6),y.op_EqualsEqualsGreater("state",b7)]);};A.AsAsync=function(bX){return X.FromContinuations(function(bY,bZ){bX.then(bY,function(b0){return bZ(A.unwrapExn(b0));});});};A.unwrapExn=function(bX){return bX instanceof _7?bX:new _8.New(bX);};B.ofArray=function(bX){var bY,bZ,b0;bY=C.Empty;for(bZ=p.length(bX)-1,b0=0;bZ>=b0;bZ--)bY=new C({$:1,$0:p.get(bX,bZ),$1:bY});return bY;};B.ofSeq=function(bX){var bY,bZ,b0,b1,b2,b3;if(bX instanceof C)return bX;else if(bX instanceof a.Array)return B.ofArray(bX);else{bY=R.Get(bX);try{b0=bY.MoveNext();if(!b0)bZ=C.Empty;else{b2=new C({$:1});b1=b2;while(b0){b1.$0=bY.Current();bY.MoveNext()?b1=(b3=new C({$:1}),b1.$1=b3,b3):b0=false;}b1.$1=C.Empty;bZ=b2;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}}};B.mapi=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bY.$==0)return bY;else{b3=new C({$:1});bZ=b3;b0=bY;b1=0;b2=true;while(b2){bZ.$0=bX(b1,b0.$0);b0=b0.$1;b0.$==0?b2=false:(bZ=(b4=new C({$:1}),bZ.$1=b4,b4),b1=b1+1);}bZ.$1=C.Empty;return b3;}};B.head=function(bX){return bX.$==1?bX.$0:B.listEmpty();};B.tail=function(bX){return bX.$==1?bX.$1:B.listEmpty();};B.listEmpty=function(){return g.FailWith("The input list was empty.");};C=B.T=bT.Class({get_Item:function(bX){return q.nth(bX,this);},GetEnumerator:function(){return new _1.New(this,null,function(bX){var bY;bY=bX.s;return bY.$==0?false:(bX.c=bY.$0,bX.s=bY.$1,true);},void 0);},GetEnumerator0:function(){return R.Get(this);}},null,C);C.Empty=new C({$:0});E=D.attr=bT.Class({},s,E);F.B={$:0};G.New$1=function(bX,bY,bZ,b0){return O.newPojoOpt([y.op_EqualsEqualsGreater("auth",bX),y.op_EqualsEqualsGreater("cache",bY),y.op_EqualsEqualsGreater("system",bZ),y.op_EqualsEqualsGreater("framework",b0)]);};H.New$1=function(bX,bY,bZ,b0,b1,b2){return O.newPojoOpt([y.op_MinusMinusGreater("clientId",bX),y.op_EqualsEqualsGreater("authority",bY),y.op_EqualsEqualsGreater("validateAuthority",bZ),y.op_EqualsEqualsGreater("redirectUri",b0),y.op_EqualsEqualsGreater("postLogoutRedirectUri",b1),y.op_EqualsEqualsGreater("navigateToLoginRequestUrl",b2)]);};I=y.Policy=bT.Class({toString:function(){return P.ReplaceChar(M["String.get_toUnderscore"]((function(bX){return function(bY){return bX(h.p(bY));};}(a.id))(this)),"_"," ");}},null,I);I.SignIn=new I({$:0});I.SignUp=new I({$:1});I.EditProfile=new I({$:2});I.ResetPassword=new I({$:3});I.Parse=function(bX){var bY;bY=P.Replace(bX," ","");return bY==="SignUp"?I.SignUp:bY==="EditProfile"?I.EditProfile:bY==="ResetPassword"?I.ResetPassword:I.SignIn;};J=t.Doc=bT.Class({},s,J);J.Concat=function(bX){var bY;bY=_2.ofSeqNonCopying(bX);return _2.TreeReduce(J.get_Empty(),J.Append,bY);};J.get_Empty=function(){return J.Mk(null,w.Const());};J.TextNode=function(bX){return J.Mk({$:5,$0:$.CreateText(bX)},w.Const());};J.Input=function(bX,bY){return J.InputInternal("input",function(){return q.append(bX,[Z.Value(bY)]);});};J.Select=function(bX,bY,bZ,b0){return J.SelectImpl(bX,bY,function(b1){b1[0]=bZ;return J.Concat(B.mapi(function(b2,b3){return J.Element("option",B.ofArray([_0.Create("value",a.String(b2))]),B.ofArray([J.TextNode(bY(b3))]));},bZ));},b0);};J.Button=function(bX,bY,bZ){var b0;b0=_0.Concat(bY);return bh.New(J.Clickable("button",bZ),b0,J.TextNode(bX));};J.BindView=function(bX,bY){return J.EmbedView(w.Map(bX,bY));};J.CheckBox=function(bX,bY){return J.InputInternal("input",function(){return q.append(bX,[_0.Create("type","checkbox"),Z.Checked(bY)]);});};J.Append=function(bX,bY){return J.Mk({$:0,$0:bX.docNode,$1:bY.docNode},w.Map2Unit(bX.updates,bY.updates));};J.TextView=function(bX){var bY;bY=ba.CreateTextNode();return J.Mk({$:4,$0:bY},w.Map(function(bZ){ba.UpdateTextNode(bY,bZ);},bX));};J.Mk=function(bX,bY){return new J.New(bX,bY);};J.Run=function(bX,bY){ba.LinkElement(bX,bY.docNode);J.RunInPlace(false,bX,bY);};J.Element=function(bX,bY,bZ){var b0,b1;b0=_0.Concat(bY);b1=J.Concat(bZ);return bh.New($.CreateElement(bX),b0,b1);};J.InputInternal=function(bX,bY){var bZ;bZ=$.CreateElement(bX);return bh.New(bZ,_0.Concat(bY(bZ)),J.get_Empty());};J.SelectImpl=function(bX,bY,bZ,b0){var b1,b2,b3,b4;function b5(b_){return b_.selectedIndex;}function b6(b_,b$){b_.selectedIndex=b$;}function b7(b_){var b$;b$=b5(b_);return b1[0].get_Item(b$);}function b8(b_){return q.findIndex(function(b$){return o.Equals(b_,b$);},b1[0]);}function b9(b_,b$){return b6(b_,b8(b$));}b1=[C.Empty];b2=$.CreateElement("select");b3=Z.DynamicCustom(function(b_){return function(b$){return b9(b_,b$);};},b0.get_View());b2.addEventListener("change",function(){b0.UpdateMaybe(function(b_){var b$;b$=b7(b2);return o.Equals(b_,b$)?null:{$:1,$0:b$};});},false);return bh.New(b2,(b4=_0.Append(b3,_0.Concat(bX)),_0.Append(Z.OnAfterRender(function(b_){b9(b_,b0.Get());}),b4)),bZ(b1));};J.Clickable=function(bX,bY){var bZ;bZ=$.CreateElement(bX);bZ.addEventListener("click",function(b0){b0.preventDefault();return bY();},false);return bZ;};J.EmbedView=function(bX){var bY;bY=ba.CreateEmbedNode();return J.Mk({$:2,$0:bY},w.Map(a.ignore,w.Bind(function(bZ){ba.UpdateEmbedNode(bY,bZ.docNode);return bZ.updates;},bX)));};J.RunInPlace=function(bX,bY,bZ){var b0;b0=ba.CreateRunState(bY,bZ.docNode);w.Sink(bn.get_UseAnimations()||bo.BatchUpdatesEnabled()?bp.StartProcessor(ba.PerformAnimatedUpdate(bX,b0,bZ.docNode)):function(){ba.PerformSyncUpdate(bX,b0,bZ.docNode);},bZ.updates);};J.New=bT.Ctor(function(bX,bY){s.New.call(this);this.docNode=bX;this.updates=bY;},J);y.policies=function(){j.$cctor();return j.policies;};y.op_EqualsEqualsGreater=function(bX,bY){return[bX,bY==null?null:{$:1,$0:bY.$0}];};y.op_MinusMinusGreater=function(bX,bY){return[bX,{$:1,$0:bY}];};K.NewFromSeq=function(bX){var bY,bZ,b0;bY={};bZ=R.Get(bX);try{while(bZ.MoveNext()){b0=bZ.Current();bY[b0[0]]=b0[1];}}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}return bY;};N.splitInTwoO=function(bX,bY){var bZ;bZ=bY.indexOf(bX);return bZ===-1?null:{$:1,$0:[M["String.Left"](bY,bZ),bY.substring(bZ+bX.length)]};};N.unindent=function(bX){var bY,bZ,b0,b1;bY=P.SplitChars(bX,["\n"],0);bZ=(b0=q.tryFindIndex(function(b2){return" "!==b2;},(b1=q.tryFind(function(b2){return P.Trim(b2)!=="";},bY),b1==null?"":b1.$0)),b0==null?0:b0.$0);return q.filter(function(b2){return!P.StartsWith(b2,"# 1 ");},q.map(function(b2){return b2.length<=bZ?"":b2.substring(bZ);},bY));};N.splitByChar=function(bX,bY){return P.SplitChars(bY,[bX],0);};O.newPojo=function(bX){var bY,bZ;function b0(b2,b3){return function(b4){return O.addProp(b2,b3,b4);};}function b1(b2){}bY={};q.iter((bZ=function(b2){return(function(b3){return b0(b3[0],b3[1]);}(b2))(bY);},function(b2){return b1(bZ(b2));}),bX);return bY;};O.newPojoOpt=function(bX){function bY(bZ,b0){return b0==null?null:{$:1,$0:[bZ,b0.$0]};}return O.newPojo(q.choose(function(bZ){return bY(bZ[0],bZ[1]);},bX));};O.addProp=function(bX,bY,bZ){bZ[bX]=bY;return bZ;};P.Replace=function(bX,bY,bZ){function b0(b1){var b2,b3,b4;b2=b1.indexOf(bY);return b2!==-1?(b3=P.ReplaceOnce(b1,bY,bZ),(b4=b2+bZ.length,P.Substring(b3,0,b2+bZ.length)+b0(b3.substring(b4)))):b1;}return b0(bX);};P.concat=function(bX,bY){return p.ofSeq(bY).join(bX);};P.SplitChars=function(bX,bY,bZ){return P.Split(bX,new a.RegExp("["+P.RegexEscape(bY.join(""))+"]"),bZ);};P.Trim=function(bX){return bX.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};P.ReplaceOnce=function(bX,bY,bZ){return bX.replace(bY,bZ);};P.Split=function(bX,bY,bZ){return bZ===1?p.filter(function(b0){return b0!=="";},P.SplitWith(bX,bY)):P.SplitWith(bX,bY);};P.RegexEscape=function(bX){return bX.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};P.Substring=function(bX,bY,bZ){return bX.substr(bY,bZ);};P.StartsWith=function(bX,bY){return bX.substring(0,bY.length)==bY;};P.SplitWith=function(bX,bY){return bX.split(bY);};P.ReplaceChar=function(bX,bY,bZ){return P.Replace(bX,bY,bZ);};Q.array=function(bX,bY,bZ){return bY==null?bZ!=null&&bZ.$==1?bX.slice(0,bZ.$0+1):[]:bZ==null?bX.slice(bY.$0):bX.slice(bY.$0,bZ.$0+1);};Q.string=function(bX,bY,bZ){return bY==null?bZ!=null&&bZ.$==1?bX.slice(0,bZ.$0+1):"":bZ==null?bX.slice(bY.$0):bX.slice(bY.$0,bZ.$0+1);};R.Get=function(bX){return bX instanceof a.Array?R.ArrayEnumerator(bX):o.Equals(typeof bX,"string")?R.StringEnumerator(bX):bX.GetEnumerator();};R.ArrayEnumerator=function(bX){return new _1.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<p.length(bX)&&(bY.c=p.get(bX,bZ),bY.s=bZ+1,true);},void 0);};R.StringEnumerator=function(bX){return new _1.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<bX.length&&(bY.c=bX[bZ],bY.s=bZ+1,true);},void 0);};R.Get0=function(bX){return bX instanceof a.Array?R.ArrayEnumerator(bX):o.Equals(typeof bX,"string")?R.StringEnumerator(bX):"GetEnumerator0"in bX?bX.GetEnumerator0():bX.GetEnumerator();};S=t.ConcreteVar=bT.Class({get_View:function(){return this.view;},Set:function(bX){if(this.isConst)(function(bY){return bY("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bY){bU.log(bY);}));else{T.Obsolete(this.snap);this.current=bX;this.snap=T.New({$:2,$0:bX,$1:[]});}},Get:function(){return this.current;},Update:function(bX){this.Set(bX(this.Get()));},UpdateMaybe:function(bX){var bY;bY=bX(this.Get());bY!=null&&bY.$==1?this.Set(bY.$0):void 0;}},v,S);S.New=bT.Ctor(function(bX,bY,bZ){var b0;b0=this;v.New.call(this);this.isConst=bX;this.current=bZ;this.snap=bY;this.view=function(){return b0.snap;};this.id=V.Int();},S);T.WhenRun=function(bX,bY,bZ){var b0;b0=bX.s;b0==null?bZ():b0!=null&&b0.$==2?(b0.$1.push(bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),b0.$1.push(bZ)):bY(b0.$0);};T.Map=function(bX,bY){var bZ,b0;bZ=bY.s;return bZ!=null&&bZ.$==0?T.New({$:0,$0:bX(bZ.$0)}):(b0=T.New({$:3,$0:[],$1:[]}),(T.When(bY,function(b1){T.MarkDone(b0,bY,bX(b1));},b0),b0));};T.Map2=function(bX,bY,bZ){var b0,b1,b2;function b3(b4){var b5,b6,b7;if(!(b5=b2.s,b5!=null&&b5.$==0||b5!=null&&b5.$==2)){b6=T.ValueAndForever(bY);b7=T.ValueAndForever(bZ);b6!=null&&b6.$==1?b7!=null&&b7.$==1?b6.$0[1]&&b7.$0[1]?T.MarkForever(b2,bX(b6.$0[0],b7.$0[0])):T.MarkReady(b2,bX(b6.$0[0],b7.$0[0])):void 0:void 0;}}b0=bY.s;b1=bZ.s;return b0!=null&&b0.$==0?b1!=null&&b1.$==0?T.New({$:0,$0:bX(b0.$0,b1.$0)}):T.Map2Opt1(bX,b0.$0,bZ):b1!=null&&b1.$==0?T.Map2Opt2(bX,b1.$0,bY):(b2=T.New({$:3,$0:[],$1:[]}),(T.When(bY,b3,b2),T.When(bZ,b3,b2),b2));};T.WhenObsoleteRun=function(bX,bY){var bZ;bZ=bX.s;bZ==null?bY():bZ!=null&&bZ.$==2?bZ.$1.push(bY):bZ!=null&&bZ.$==3?bZ.$1.push(bY):void 0;};T.When=function(bX,bY,bZ){var b0;b0=bX.s;b0==null?T.Obsolete(bZ):b0!=null&&b0.$==2?(T.EnqueueSafe(b0.$1,bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),T.EnqueueSafe(b0.$1,bZ)):bY(b0.$0);};T.MarkDone=function(bX,bY,bZ){var b0;if(b0=bY.s,b0!=null&&b0.$==0)T.MarkForever(bX,bZ);else T.MarkReady(bX,bZ);};T.Map2Opt1=function(bX,bY,bZ){return T.Map(function(b0){return bX(bY,b0);},bZ);};T.Map2Opt2=function(bX,bY,bZ){return T.Map(function(b0){return bX(b0,bY);},bZ);};T.ValueAndForever=function(bX){var bY;bY=bX.s;return bY!=null&&bY.$==0?{$:1,$0:[bY.$0,true]}:bY!=null&&bY.$==2?{$:1,$0:[bY.$0,false]}:null;};T.MarkForever=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:0,$0:bY};b0=bZ.$0;for(b1=0,b2=p.length(b0)-1;b1<=b2;b1++)(p.get(b0,b1))(bY);}else void 0;};T.MarkReady=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:2,$0:bY,$1:bZ.$1};b0=bZ.$0;for(b1=0,b2=p.length(b0)-1;b1<=b2;b1++)(p.get(b0,b1))(bY);}else void 0;};T.EnqueueSafe=function(bX,bY){var bZ,b0,b1,b2;bX.push(bY);if(bX.length%20===0){bZ=bX.slice(0);bF.Clear(bX);for(b0=0,b1=p.length(bZ)-1;b0<=b1;b0++){b2=p.get(bZ,b0);typeof b2=="object"?function(b3){if(b3.s)bX.push(b3);}(b2):function(b3){bX.push(b3);}(b2);}}else void 0;};T.Join=function(bX){var bY;bY=T.New({$:3,$0:[],$1:[]});T.When(bX,function(bZ){var b0;b0=bZ();T.When(b0,function(b1){var b2,b3;if((b2=b0.s,b2!=null&&b2.$==0)&&(b3=bX.s,b3!=null&&b3.$==0))T.MarkForever(bY,b1);else T.MarkReady(bY,b1);},bY);},bY);return bY;};T.Map2Unit=function(bX,bY){var bZ,b0,b1;function b2(){var b3,b4,b5;if(!(b3=b1.s,b3!=null&&b3.$==0||b3!=null&&b3.$==2)){b4=T.ValueAndForever(bX);b5=T.ValueAndForever(bY);b4!=null&&b4.$==1?b5!=null&&b5.$==1?b4.$0[1]&&b5.$0[1]?T.MarkForever(b1,null):T.MarkReady(b1,null):void 0:void 0;}}bZ=bX.s;b0=bY.s;return bZ!=null&&bZ.$==0?b0!=null&&b0.$==0?T.New({$:0,$0:null}):bY:b0!=null&&b0.$==0?bX:(b1=T.New({$:3,$0:[],$1:[]}),(T.When(bX,b2,b1),T.When(bY,b2,b1),b1));};T.Copy=function(bX){var bY,bZ,b0;bY=bX.s;return bY==null?bX:bY!=null&&bY.$==2?(bZ=T.New({$:2,$0:bY.$0,$1:[]}),(T.WhenObsolete(bX,bZ),bZ)):bY!=null&&bY.$==3?(b0=T.New({$:3,$0:[],$1:[]}),(T.When(bX,function(b1){T.MarkDone(b0,bX,b1);},b0),b0)):bX;};T.WhenObsolete=function(bX,bY){var bZ;bZ=bX.s;bZ==null?T.Obsolete(bY):bZ!=null&&bZ.$==2?T.EnqueueSafe(bZ.$1,bY):bZ!=null&&bZ.$==3?T.EnqueueSafe(bZ.$1,bY):void 0;};V.Id=function(){V.set_counter(V.counter()+1);return"uid"+a.String(V.counter());};V.Int=function(){V.set_counter(V.counter()+1);return V.counter();};V.set_counter=function(bX){bd.$cctor();bd.counter=bX;};V.counter=function(){bd.$cctor();return bd.counter;};X.Delay=function(bX){return function(bY){try{(bX(null))(bY);}catch(bZ){bY.k({$:1,$0:bZ});}};};X.Zero=function(){_6.$cctor();return _6.Zero;};X.Bind=function(bX,bY){return X.checkCancel(function(bZ){bX(_5.New(function(b0){var b1;if(b0.$==0){b1=b0.$0;X.scheduler().Fork(function(){try{(bY(b1))(bZ);}catch(b2){bZ.k({$:1,$0:b2});}});}else X.scheduler().Fork(function(){bZ.k(b0);});},bZ.ct));});};X.Start=function(bX,bY){var bZ,b0;bZ=(b0=(X.defCTS())[0],bY==null?b0:bY.$0);X.scheduler().Fork(function(){if(!bZ.c)bX(_5.New(function(b1){if(b1.$==1)X.UncaughtAsyncError(b1.$0);},bZ));});};X.TryWith=function(bX,bY){return function(bZ){bX(_5.New(function(b0){if(b0.$==0)bZ.k({$:0,$0:b0.$0});else if(b0.$==1)try{(bY(b0.$0))(bZ);}catch(b1){bZ.k(b0);}else bZ.k(b0);},bZ.ct));};};X.Return=function(bX){return function(bY){bY.k({$:0,$0:bX});};};X.FromContinuations=function(bX){return function(bY){var bZ;function b0(b1){if(bZ[0])g.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bZ[0]=true;X.scheduler().Fork(b1);}}bZ=[false];bX(function(b1){b0(function(){bY.k({$:0,$0:b1});});},function(b1){b0(function(){bY.k({$:1,$0:b1});});},function(b1){b0(function(){bY.k({$:2,$0:b1});});});};};X.Combine=function(bX,bY){return X.Bind(bX,function(){return bY;});};X.While=function(bX,bY){return bX()?X.Bind(bY,function(){return X.While(bX,bY);}):X.Return();};X.Sleep=function(bX){return function(bY){var bZ,b0;bZ=void 0;b0=void 0;bZ=a.setTimeout(function(){b0.Dispose();X.scheduler().Fork(function(){bY.k({$:0,$0:null});});},bX);b0=X.Register(bY.ct,function(){a.clearTimeout(bZ);X.scheduler().Fork(function(){X.cancel(bY);});});};};X.checkCancel=function(bX){return function(bY){if(bY.ct.c)X.cancel(bY);else bX(bY);};};X.defCTS=function(){_6.$cctor();return _6.defCTS;};X.UncaughtAsyncError=function(bX){bU.log("WebSharper: Uncaught asynchronous exception",bX);};X.Register=function(bX,bY){var bZ;return bX===X.noneCT()?{Dispose:function(){return null;}}:(bZ=bX.r.push(bY)-1,{Dispose:function(){return p.set(bX.r,bZ,a.ignore);}});};X.cancel=function(bX){bX.k({$:2,$0:new bq.New(bX.ct)});};X.scheduler=function(){_6.$cctor();return _6.scheduler;};X.noneCT=function(){_6.$cctor();return _6.noneCT;};Y=y.Account=bT.Class({},s,Y);Z.DynamicPred=function(bX,bY,bZ){function b0(b1,b2){return b2[0]?$.SetAttr(b1,bX,b2[1]):$.RemoveAttr(b1,bX);}return _.Dynamic(w.Map2(function(b1,b2){return[b1,b2];},bY,bZ),function(b1){return function(b2){return b0(b1,b2);};});};Z.Value=function(bX){function bY(bZ){return{$:1,$0:bZ};}return Z.CustomValue(bX,a.id,function(bZ){return bY(a.id(bZ));});};Z.Checked=function(bX){function bY(bZ,b0){return!o.Equals(bX.Get(),bZ.checked)?bX.Set(bZ.checked):null;}return _0.Concat([Z.DynamicProp("checked",bX.get_View()),Z.Handler("change",function(bZ){return function(b0){return bY(bZ,b0);};})]);};Z.CustomValue=function(bX,bY,bZ){return Z.CustomVar(bX,function(b0,b1){b0.value=bY(b1);},function(b0){return bZ(b0.value);});};Z.OnAfterRender=function(bX){return new _0({$:4,$0:bX});};Z.DynamicCustom=function(bX,bY){return _.Dynamic(bY,bX);};Z.DynamicProp=function(bX,bY){return _.Dynamic(bY,function(bZ){return function(b0){bZ[bX]=b0;};});};Z.Handler=function(bX,bY){return _.Static(function(bZ){bZ.addEventListener(bX,function(b0){return(bY(bZ))(b0);},false);});};Z.CustomVar=function(bX,bY,bZ){function b0(b2,b3){return bX.UpdateMaybe(function(b4){var b5,b6;b5=bZ(b2);return b5!=null&&b5.$==1&&(!o.Equals(b5.$0,b4)&&(b6=[b5,b5.$0],true))?b6[0]:null;});}function b1(b2,b3){var b4,b5;b4=bZ(b2);return b4!=null&&b4.$==1&&(o.Equals(b4.$0,b3)&&(b5=b4.$0,true))?null:bY(b2,b3);}return _0.Concat([Z.Handler("change",function(b2){return function(b3){return b0(b2,b3);};}),Z.Handler("input",function(b2){return function(b3){return b0(b2,b3);};}),Z.Handler("keypress",function(b2){return function(b3){return b0(b2,b3);};}),Z.DynamicCustom(function(b2){return function(b3){return b1(b2,b3);};},bX.get_View())]);};_0=t.AttrProxy=bT.Class({},null,_0);_0.Create=function(bX,bY){return _.Static(function(bZ){$.SetAttr(bZ,bX,bY);});};_0.OnAfterRenderImpl=function(bX){return new _0({$:4,$0:bX});};_0.Concat=function(bX){var bY;bY=_2.ofSeqNonCopying(bX);return _2.TreeReduce(_.EmptyAttr(),_0.Append,bY);};_0.Append=function(bX,bY){return _.AppendTree(bX,bY);};_1=R.T=bT.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},s,_1);_1.New=bT.Ctor(function(bX,bY,bZ,b0){s.New.call(this);this.s=bX;this.c=bY;this.n=bZ;this.d=b0;},_1);_2.ofSeqNonCopying=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX;else if(bX instanceof C)return p.ofList(bX);else if(bX===null)return[];else{bY=[];bZ=R.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};_2.TreeReduce=function(bX,bY,bZ){var b0;function b1(b2,b3){var b4,b5;return b3<=0?bX:b3===1&&(b2>=0&&b2<b0)?p.get(bZ,b2):(b5=b3/2>>0,bY(b1(b2,b5),b1(b2+b5,b3-b5)));}b0=p.length(bZ);return b1(0,b0);};_2.MapTreeReduce=function(bX,bY,bZ,b0){var b1;function b2(b3,b4){var b5,b6;return b4<=0?bY:b4===1&&(b3>=0&&b3<b1)?bX(p.get(b0,b3)):(b6=b4/2>>0,bZ(b2(b3,b6),b2(b3+b6,b4-b6)));}b1=p.length(b0);return b2(0,b1);};_4.LoadLocalTemplates=function(bX){!_4.LocalTemplatesLoaded()?(_4.set_LocalTemplatesLoaded(true),_4.LoadNestedTemplates(self.document.body,"")):void 0;_4.LoadedTemplates().set_Item(bX,_4.LoadedTemplateFile(""));};_4.LocalTemplatesLoaded=function(){bl.$cctor();return bl.LocalTemplatesLoaded;};_4.set_LocalTemplatesLoaded=function(bX){bl.$cctor();bl.LocalTemplatesLoaded=bX;};_4.LoadNestedTemplates=function(bX,bY){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb;function bZ(cc){var cd,ce;if(!b0.ContainsKey(cc)){cd=(ce=null,[b1.TryGetValue(cc,{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);cd[0]?(cb.Add(cc),b1.Remove(cc),_4.PrepareTemplateStrict(bY,{$:1,$0:cc},cd[1][0],{$:1,$0:cd[1][1]},{$:1,$0:bZ})):bU.warn(cb.Contains(cc)?"Encountered loop when instantiating "+cc:"Local template does not exist: "+cc);}}b0=_4.LoadedTemplateFile(bY);b1=new bc.New$5();b2=bX.querySelectorAll("[ws-template]");for(b3=0,b4=b2.length-1;b3<=b4;b3++){b5=b2[b3];b6=b5.getAttribute("ws-template").toLowerCase();b5.removeAttribute("ws-template");b1.set_Item(b6,[[b5],_4.FakeRootSingle(b5)]);}b7=bX.querySelectorAll("[ws-children-template]");for(b8=0,b9=b7.length-1;b8<=b9;b8++){b_=b7[b8];b$=b_.getAttribute("ws-children-template").toLowerCase();b_.removeAttribute("ws-children-template");b1.set_Item(b$,(ca=$.ChildrenArray(b_),[ca,_4.FakeRoot(ca)]));}cb=new bm.New$3();while(b1.count>0)bZ(q.head(b1.get_Keys()));};_4.LoadedTemplates=function(){bl.$cctor();return bl.LoadedTemplates;};_4.LoadedTemplateFile=function(bX){var bY,bZ,b0;bY=(bZ=null,[_4.LoadedTemplates().TryGetValue(bX,{get:function(){return bZ;},set:function(b1){bZ=b1;}}),bZ]);return bY[0]?bY[1]:(b0=new bc.New$5(),(_4.LoadedTemplates().set_Item(bX,b0),b0));};_4.FakeRootSingle=function(bX){var bY,bZ,b0;bX.removeAttribute("ws-template");bY=bX.getAttribute("ws-replace");bY===null?void 0:(bX.removeAttribute("ws-replace"),bZ=bX.parentNode,o.Equals(bZ,null)?void 0:(b0=self.document.createElement(bX.tagName),b0.setAttribute("ws-replace",bY),bZ.replaceChild(b0,bX)));return _4.FakeRoot([bX]);};_4.FakeRoot=function(bX){var bY,bZ,b0;bY=self.document.createElement("div");for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY.appendChild(p.get(bX,bZ));return bY;};_4.PrepareTemplateStrict=function(bX,bY,bZ,b0,b1){var b2,b3;function b4(b9,b_){var b$,ca,cb,cc,cd,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz;function ce(cA){}while(true)switch(b9){case 0:if(b_!==null){b$=b_.nextSibling;if(o.Equals(b_.nodeType,L.TEXT_NODE))by.convertTextNode(b_);else if(o.Equals(b_.nodeType,L.ELEMENT_NODE))b6(b_);b_=b$;}else return null;break;case 1:cf=Q.string(b_.nodeName,{$:1,$0:3},null).toLowerCase();cg=(ca=cf.indexOf("."),ca===-1?[bX,cf]:[Q.string(cf,null,{$:1,$0:ca-1}),Q.string(cf,{$:1,$0:ca+1},null)]);ch=cg[1];ci=cg[0];if(ci!==""&&!_4.LoadedTemplates().ContainsKey(ci))return by.failNotLoaded(ch);else{if(ci===""&&b1!=null)b1.$0(ch);cj=_4.LoadedTemplates().get_Item(ci);if(!cj.ContainsKey(ch))return by.failNotLoaded(ch);else{ck=cj.get_Item(ch);cl=ck.cloneNode(true);cm=new bm.New$3();cn=new bc.New$5();co=b_.attributes;for(cp=0,cq=co.length-1;cp<=cq;cp++){cr=co.item(cp).name.toLowerCase();cn.set_Item(cr,(cs=co.item(cp).nodeValue,cs===""?cr:cs.toLowerCase()));!cm.Add(cr)?bU.warn("Hole mapped twice",cr):void 0;}for(ct=0,cu=b_.childNodes.length-1;ct<=cu;ct++){cv=b_.childNodes[ct];o.Equals(cv.nodeType,L.ELEMENT_NODE)?!cm.Add(cv.nodeName.toLowerCase())?bU.warn("Hole filled twice",ch):void 0:void 0;}cw=b_.childNodes.length===1&&o.Equals(b_.firstChild.nodeType,L.TEXT_NODE);if(cw){cc=by.fillTextHole(cl,b_.firstChild.textContent,ch);((function(cA){return function(cB){if(cB!=null)cA(cB.$0);};}((cd=function(cA){return function(cB){return cA.Add(cB);};}(cm),function(cA){return ce(cd(cA));})))(cc));}by.removeHolesExcept(cl,cm);if(!cw){for(cx=0,cy=b_.childNodes.length-1;cx<=cy;cx++){cz=b_.childNodes[cx];o.Equals(cz.nodeType,L.ELEMENT_NODE)?cz.hasAttributes()?by.fillInstanceAttrs(cl,cz):b5(cl,cz):void 0;}}by.mapHoles(cl,cn);by.fill(cl,b_.parentNode,b_);b_.parentNode.removeChild(b_);return;}}break;}}function b5(b9,b_){var b$,cb,cc;function ca(cd,ce){var cf,cg,ch;if(cb==="title"&&b_.hasChildNodes()){cf=bV.parseHTML(b_.textContent);b_.removeChild(b_.firstChild);for(cg=0,ch=cf.length-1;cg<=ch;cg++)b_.appendChild(p.get(cf,cg));}else null;b6(b_);return by.fill(b_,cd,ce);}cb=b_.nodeName.toLowerCase();$.IterSelector(b9,"[ws-attr-holes]",function(cd){var ce,cf,cg,ch,ci;ce=P.SplitChars(cd.getAttribute("ws-attr-holes"),[" "],1);for(cf=0,cg=ce.length-1;cf<=cg;cf++){ch=p.get(ce,cf);cd.setAttribute(ch,(ci=new a.RegExp("\\${"+cb+"}","ig"),cd.getAttribute(ch).replace(ci,b_.textContent)));}});cc=b9.querySelector("[ws-hole="+cb+"]");if(o.Equals(cc,null)){b$=b9.querySelector("[ws-replace="+cb+"]");return o.Equals(b$,null)?null:(ca(b$.parentNode,b$),void b$.parentNode.removeChild(b$));}else{while(cc.hasChildNodes())cc.removeChild(cc.lastChild);cc.removeAttribute("ws-hole");return ca(cc,null);}}function b6(b9){if(P.StartsWith(b9.nodeName.toLowerCase(),"ws-"))b8(b9);else{by.convertAttrs(b9);b7(b9.firstChild);}}function b7(b9){return b4(0,b9);}function b8(b9){return b4(1,b9);}b2=b0==null?_4.FakeRoot(bZ):b0.$0;b3=(bY==null?"":bY.$0).toLowerCase();_4.LoadedTemplateFile(bX).set_Item(b3,b2);p.length(bZ)>0?(function(b9){var b_,b$,ca,cb;while(true){b_=b9.querySelector("[ws-template]");if(o.Equals(b_,null)){b$=b9.querySelector("[ws-children-template]");if(o.Equals(b$,null))return null;else{ca=b$.getAttribute("ws-children-template");b$.removeAttribute("ws-children-template");_4.PrepareTemplateStrict(bX,{$:1,$0:ca},$.ChildrenArray(b$),null,null);b9=b9;}}else{cb=b_.getAttribute("ws-template");(_4.PrepareSingleTemplate(bX,{$:1,$0:cb},b_))(null);b9=b9;}}}(b2),b7(p.get(bZ,0))):void 0;};_4.PrepareSingleTemplate=function(bX,bY,bZ){var b0,b1,b2;b0=_4.FakeRootSingle(bZ);b1=[bZ];b2={$:1,$0:b0};return function(b3){_4.PrepareTemplateStrict(bX,bY,b1,b2,b3);};};_4.TextHoleRE=function(){bl.$cctor();return bl.TextHoleRE;};M["String.Left"]=function(bX,bY){return bY<0?M["String.Substring2"](bX,0,bX.length+bY):M["String.Substring2"](bX,0,bY);};M["String.Substring2"]=function(bX,bY,bZ){var b0,b1;while(true){if(bZ<=0)return"";else if(bY<0){b0=bY;bY=0;bZ=bZ+b0;}else return bY>=bX.length?"":P.Substring(bX,bY,(b1=bX.length-bY,o.Compare(bZ,b1)===-1?bZ:b1));}};M["String.get_toUnderscore"]=function(bX,bY){return p.ofSeq(q.collect(a.id,q.mapi(function(bZ,b0){return bZ>0&&br.IsUpper(b0)?B.ofArray(["_",b0]):B.ofArray([b0]);},bX))).join("");};T.Obsolete=function(bX){var bY,bZ,b0,b1,b2;bZ=bX.s;if(bZ==null||(bZ!=null&&bZ.$==2?(bY=bZ.$1,false):bZ!=null&&bZ.$==3?(bY=bZ.$1,false):true))void 0;else{bX.s=null;for(b0=0,b1=p.length(bY)-1;b0<=b1;b0++){b2=p.get(bY,b0);typeof b2=="object"?function(b3){T.Obsolete(b3);}(b2):b2();}}};T.New=function(bX){return{s:bX};};_5.New=function(bX,bY){return{k:bX,ct:bY};};_6.$cctor=function(){_6.$cctor=a.ignore;_6.noneCT=_9.New(false,[]);_6.scheduler=new be.New();_6.defCTS=[new bf.New()];_6.Zero=X.Return();_6.GetCT=function(bX){bX.k({$:0,$0:bX.ct});};};_8=m.NonStandardPromiseRejectionException=bT.Class({},_7,_8);_8.New=bT.Ctor(function(bX){this.message="Promise rejected";W.setPrototypeOf(this,_8.prototype);this.reason=bX;},_8);_9.New=function(bX,bY){return{c:bX,r:bY};};_.Dynamic=function(bX,bY){return new _0({$:1,$0:new bg.New(bX,bY)});};_.Static=function(bX){return new _0({$:3,$0:bX});};_.AppendTree=function(bX,bY){var bZ;return bX===null?bY:bY===null?bX:(bZ=new _0({$:2,$0:bX,$1:bY}),(_.SetFlags(bZ,_.Flags(bX)|_.Flags(bY)),bZ));};_.Updates=function(bX){return _2.MapTreeReduce(function(bY){return bY.NChanged();},w.Const(),w.Map2Unit,bX.DynNodes);};_.EmptyAttr=function(){bG.$cctor();return bG.EmptyAttr;};_.SetFlags=function(bX,bY){bX.flags=bY;};_.Flags=function(bX){return bX!==null&&bX.hasOwnProperty("flags")?bX.flags:0;};_.Insert=function(bX,bY){var bZ,b0,b1;function b2(b3){if(!(b3===null))if(b3!=null&&b3.$==1)bZ.push(b3.$0);else if(b3!=null&&b3.$==2){b2(b3.$0);b2(b3.$1);}else if(b3!=null&&b3.$==3)b3.$0(bX);else if(b3!=null&&b3.$==4)b0.push(b3.$0);}bZ=[];b0=[];b2(bY);b1=bZ.slice(0);return bw.New(bX,_.Flags(bY),b1,b0.length===0?null:{$:1,$0:function(b3){q.iter(function(b4){b4(b3);},b0);}});};_.HasExitAnim=function(bX){var bY;bY=2;return(bX.DynFlags&bY)===bY;};_.GetExitAnim=function(bX){return _.GetAnim(bX,function(bY,bZ){return bY.NGetExitAnim(bZ);});};_.HasEnterAnim=function(bX){var bY;bY=1;return(bX.DynFlags&bY)===bY;};_.GetEnterAnim=function(bX){return _.GetAnim(bX,function(bY,bZ){return bY.NGetEnterAnim(bZ);});};_.HasChangeAnim=function(bX){var bY;bY=4;return(bX.DynFlags&bY)===bY;};_.GetChangeAnim=function(bX){return _.GetAnim(bX,function(bY,bZ){return bY.NGetChangeAnim(bZ);});};_.GetAnim=function(bX,bY){return bn.Concat(p.map(function(bZ){return bY(bZ,bX.DynElem);},bX.DynNodes));};_.Sync=function(bX,bY){p.iter(function(bZ){bZ.NSync(bX);},bY.DynNodes);};$.SetAttr=function(bX,bY,bZ){bX.setAttribute(bY,bZ);};$.RemoveAttr=function(bX,bY){bX.removeAttribute(bY);};$.CreateText=function(bX){return $.Doc().createTextNode(bX);};$.CreateElement=function(bX){return $.Doc().createElement(bX);};$.Doc=function(){bs.$cctor();return bs.Doc;};$.ChildrenArray=function(bX){var bY,bZ,b0;bY=[];for(bZ=0,b0=bX.childNodes.length-1;bZ<=b0;bZ++)bY.push(bX.childNodes[bZ]);return bY;};$.IterSelector=function(bX,bY,bZ){var b0,b1,b2;b0=bX.querySelectorAll(bY);for(b1=0,b2=b0.length-1;b1<=b2;b1++)bZ(b0[b1]);};$.InsertAt=function(bX,bY,bZ){var b0;if(!(bZ.parentNode===bX&&bY===(b0=bZ.nextSibling,o.Equals(b0,null)?null:b0)))bX.insertBefore(bZ,bY);};$.RemoveNode=function(bX,bY){if(bY.parentNode===bX)bX.removeChild(bY);};w=t.View=bT.Class({},null,w);ba.CreateTextNode=function(){return{Text:$.CreateText(""),Dirty:false,Value:""};};ba.UpdateTextNode=function(bX,bY){bX.Value=bY;bX.Dirty=true;};ba.LinkElement=function(bX,bY){ba.InsertDoc(bX,bY,null);};ba.CreateEmbedNode=function(){return{Current:null,Dirty:false};};ba.UpdateEmbedNode=function(bX,bY){bX.Current=bY;bX.Dirty=true;};ba.InsertDoc=function(bX,bY,bZ){var b0;return bY!=null&&bY.$==1?ba.InsertNode(bX,bY.$0.El,bZ):bY!=null&&bY.$==2?(b0=bY.$0,(b0.Dirty=false,ba.InsertDoc(bX,b0.Current,bZ))):bY==null?bZ:bY!=null&&bY.$==4?ba.InsertNode(bX,bY.$0.Text,bZ):bY!=null&&bY.$==5?ba.InsertNode(bX,bY.$0,bZ):bY!=null&&bY.$==6?p.foldBack(function(b1,b2){return b1==null||b1.constructor===W?ba.InsertDoc(bX,b1,b2):ba.InsertNode(bX,b1,b2);},bY.$0.Els,bZ):ba.InsertDoc(bX,bY.$0,ba.InsertDoc(bX,bY.$1,bZ));};ba.CreateRunState=function(bX,bY){return bB.New(bC.get_Empty(),ba.CreateElemNode(bX,_.EmptyAttr(),bY));};ba.PerformAnimatedUpdate=function(bX,bY,bZ){var b0;return bn.get_UseAnimations()?(b0=null,X.Delay(function(){var b1,b2,b3;b1=bC.FindAll(bZ);b2=ba.ComputeChangeAnim(bY,b1);b3=ba.ComputeEnterAnim(bY,b1);return X.Bind(bn.Play(bn.Append(b2,ba.ComputeExitAnim(bY,b1))),function(){return X.Bind(ba.SyncElemNodesNextFrame(bX,bY),function(){return X.Bind(bn.Play(b3),function(){bY.PreviousNodes=b1;return X.Return(null);});});});})):ba.SyncElemNodesNextFrame(bX,bY);};ba.PerformSyncUpdate=function(bX,bY,bZ){var b0;b0=bC.FindAll(bZ);ba.SyncElemNode(bX,bY.Top);bY.PreviousNodes=b0;};ba.CreateElemNode=function(bX,bY,bZ){var b0;ba.LinkElement(bX,bZ);b0=_.Insert(bX,bY);return bj.New(b0,bZ,null,bX,V.Int(),bT.GetOptional(b0.OnAfterRender));};ba.InsertNode=function(bX,bY,bZ){$.InsertAt(bX,bZ,bY);return bY;};ba.SyncElemNodesNextFrame=function(bX,bY){function bZ(b0){a.requestAnimationFrame(function(){ba.SyncElemNode(bX,bY.Top);b0();});}return bo.BatchUpdatesEnabled()?X.FromContinuations(function(b0,b1,b2){return bZ.apply(null,[b0,b1,b2]);}):(ba.SyncElemNode(bX,bY.Top),X.Return(null));};ba.ComputeExitAnim=function(bX,bY){return bn.Concat(p.map(function(bZ){return _.GetExitAnim(bZ.Attr);},bC.ToArray(bC.Except(bY,bC.Filter(function(bZ){return _.HasExitAnim(bZ.Attr);},bX.PreviousNodes)))));};ba.ComputeEnterAnim=function(bX,bY){return bn.Concat(p.map(function(bZ){return _.GetEnterAnim(bZ.Attr);},bC.ToArray(bC.Except(bX.PreviousNodes,bC.Filter(function(bZ){return _.HasEnterAnim(bZ.Attr);},bY)))));};ba.ComputeChangeAnim=function(bX,bY){var bZ;function b0(b1){return _.HasChangeAnim(b1.Attr);}bZ=function(b1){return bC.Filter(b0,b1);};return bn.Concat(p.map(function(b1){return _.GetChangeAnim(b1.Attr);},bC.ToArray(bC.Intersect(bZ(bX.PreviousNodes),bZ(bY)))));};ba.SyncElemNode=function(bX,bY){!bX?ba.SyncElement(bY):void 0;ba.Sync(bY.Children);ba.AfterRender(bY);};ba.SyncElement=function(bX){function bY(bZ){function b0(b1){var b2,b3;return b1!=null&&b1.$==0?b0(b1.$0)||b0(b1.$1):b1!=null&&b1.$==2?(b2=b1.$0,b2.Dirty||b0(b2.Current)):b1!=null&&b1.$==6&&(b3=b1.$0,b3.Dirty||p.exists(bY,b3.Holes));}return b0(bZ.Children);}_.Sync(bX.El,bX.Attr);bY(bX)?ba.DoSyncElement(bX):void 0;};ba.Sync=function(bX){var bY,bZ;if(bX!=null&&bX.$==1)ba.SyncElemNode(false,bX.$0);else if(bX!=null&&bX.$==2)ba.Sync(bX.$0.Current);else if(bX==null);else if(bX!=null&&bX.$==5);else if(bX!=null&&bX.$==4){bY=bX.$0;bY.Dirty?(bY.Text.nodeValue=bY.Value,bY.Dirty=false):void 0;}else if(bX!=null&&bX.$==6){bZ=bX.$0;p.iter(function(b0){ba.SyncElemNode(false,b0);},bZ.Holes);p.iter(function(b0){_.Sync(b0[0],b0[1]);},bZ.Attrs);ba.AfterRender(bZ);}else{ba.Sync(bX.$0);ba.Sync(bX.$1);}};ba.AfterRender=function(bX){var bY;bY=bT.GetOptional(bX.Render);bY!=null&&bY.$==1?(bY.$0(bX.El),bT.SetOptional(bX,"Render",null)):void 0;};ba.DoSyncElement=function(bX){var bY,bZ,b0;function b1(b2,b3){var b4,b5;return b2!=null&&b2.$==1?b2.$0.El:b2!=null&&b2.$==2?(b4=b2.$0,b4.Dirty?(b4.Dirty=false,ba.InsertDoc(bY,b4.Current,b3)):b1(b4.Current,b3)):b2==null?b3:b2!=null&&b2.$==4?b2.$0.Text:b2!=null&&b2.$==5?b2.$0:b2!=null&&b2.$==6?(b5=b2.$0,(b5.Dirty?b5.Dirty=false:void 0,p.foldBack(function(b6,b7){return b6==null||b6.constructor===W?b1(b6,b7):b6;},b5.Els,b3))):b1(b2.$0,b1(b2.$1,b3));}bY=bX.El;bN.Iter((bZ=bX.El,function(b2){$.RemoveNode(bZ,b2);}),bN.Except(bN.DocChildren(bX),bN.Children(bX.El,bT.GetOptional(bX.Delimiters))));b1(bX.Children,(b0=bT.GetOptional(bX.Delimiters),b0!=null&&b0.$==1?b0.$0[1]:null));};bc=bb.Dictionary=bT.Class({set_Item:function(bX,bY){this.set(bX,bY);},ContainsKey:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?false:p.exists(function(b0){return bY.equals.apply(null,[(g.KeyValue(b0))[0],bX]);},bZ);},TryGetValue:function(bX,bY){var bZ,b0,b1;bZ=this;b0=this.data[this.hash(bX)];return b0==null?false:(b1=p.tryPick(function(b2){var b3;b3=g.KeyValue(b2);return bZ.equals.apply(null,[b3[0],bX])?{$:1,$0:b3[1]}:null;},b0),b1!=null&&b1.$==1&&(bY.set(b1.$0),true));},Remove:function(bX){return this.remove(bX);},get_Keys:function(){return new bz.New(this);},set:function(bX,bY){var bZ,b0,b1,b2;bZ=this;b0=this.hash(bX);b1=this.data[b0];b1==null?(this.count=this.count+1,this.data[b0]=new a.Array({K:bX,V:bY})):(b2=p.tryFindIndex(function(b3){return bZ.equals.apply(null,[(g.KeyValue(b3))[0],bX]);},b1),b2==null?(this.count=this.count+1,b1.push({K:bX,V:bY})):b1[b2.$0]={K:bX,V:bY});},remove:function(bX){var bY,bZ,b0,b1;bY=this;bZ=this.hash(bX);b0=this.data[bZ];return b0==null?false:(b1=p.filter(function(b2){return!bY.equals.apply(null,[(g.KeyValue(b2))[0],bX]);},b0),p.length(b1)<b0.length&&(this.count=this.count-1,this.data[bZ]=b1,true));},get_Item:function(bX){return this.get(bX);},get:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?bx.notPresent():p.pick(function(b0){var b1;b1=g.KeyValue(b0);return bY.equals.apply(null,[b1[0],bX])?{$:1,$0:b1[1]}:null;},bZ);},GetEnumerator:function(){return R.Get0(this);},GetEnumerator0:function(){return R.Get0(p.concat(n.GetFieldValues(this.data)));}},s,bc);bc.New$5=bT.Ctor(function(){bc.New$6.call(this,[],o.Equals,o.Hash);},bc);bc.New$6=bT.Ctor(function(bX,bY,bZ){var b0,b1;s.New.call(this);this.equals=bY;this.hash=bZ;this.count=0;this.data=[];b0=R.Get(bX);try{while(b0.MoveNext()){b1=b0.Current();this.set(b1.K,b1.V);}}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},bc);bd.$cctor=function(){bd.$cctor=a.ignore;bd.counter=0;};be=X.Scheduler=bT.Class({Fork:function(bX){var bY;bY=this;this.robin.push(bX);this.idle?(this.idle=false,a.setTimeout(function(){bY.tick();},0)):void 0;},tick:function(){var bX,bY,bZ;bY=this;bZ=bW.now();bX=true;while(bX)if(this.robin.length===0){this.idle=true;bX=false;}else{(this.robin.shift())();bW.now()-bZ>40?(a.setTimeout(function(){bY.tick();},0),bX=false):void 0;}}},s,be);be.New=bT.Ctor(function(){s.New.call(this);this.idle=true;this.robin=[];},be);bf=f.CancellationTokenSource=bT.Class({},s,bf);bf.New=bT.Ctor(function(){s.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bf);bg=t.DynamicAttrNode=bT.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bX){return bn.get_Empty();},NGetEnterAnim:function(bX){return bn.get_Empty();},NGetChangeAnim:function(bX){return bn.get_Empty();},NSync:function(bX){if(this.dirty){(this.push(bX))(this.value);this.dirty=false;}}},s,bg);bg.New=bT.Ctor(function(bX,bY){var bZ;bZ=this;s.New.call(this);this.push=bY;this.value=void 0;this.dirty=false;this.updates=w.Map(function(b0){bZ.value=b0;bZ.dirty=true;},bX);},bg);bh=t.Elt=bT.Class({},J,bh);bh.New=function(bX,bY,bZ){var b0,b1;b0=ba.CreateElemNode(bX,bY,bZ.docNode);b1=bt.Create(bZ.updates);return new bh.New$1({$:1,$0:b0},w.Map2Unit(_.Updates(b0.Attr),b1.v),bX,b1);};bh.New$1=bT.Ctor(function(bX,bY,bZ,b0){J.New.call(this,bX,bY);this.docNode$1=bX;this.updates$1=bY;this.elt=bZ;this.rvUpdates=b0;},bh);bi=bb.FSharpMap=bT.Class({Equals:function(bX){return this.get_Count()===bX.get_Count()&&q.forall2(o.Equals,this,bX);},get_Count:function(){var bX;bX=this.tree;return bX==null?0:bX.Count;},GetEnumerator$1:function(){return R.Get(q.map(function(bX){return{K:bX.Key,V:bX.Value};},bJ.Enumerate(false,this.tree)));},GetHashCode:function(){return o.Hash(p.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},CompareTo0:function(bX){return q.compareWith(o.Compare,this,bX);},GetEnumerator0:function(){return this.GetEnumerator$1();}},s,bi);bj=t.DocElemNode=bT.Class({Equals:function(bX){return this.ElKey===bX.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bj);bj.New=function(bX,bY,bZ,b0,b1,b2){var b3;return new bj((b3={Attr:bX,Children:bY,El:b0,ElKey:b1},(bT.SetOptional(b3,"Delimiters",bZ),bT.SetOptional(b3,"Render",b2),b3)));};bl.$cctor=function(){bl.$cctor=a.ignore;bl.LoadedTemplates=new bc.New$5();bl.LocalTemplatesLoaded=false;bl.TextHoleRE="\\${([^}]+)}";};bm=bb.HashSet=bT.Class({Add:function(bX){return this.add(bX);},Contains:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrContains(bX,bY);},add:function(bX){var bY,bZ;bY=this.hash(bX);bZ=this.data[bY];return bZ==null?(this.data[bY]=[bX],this.count=this.count+1,true):this.arrContains(bX,bZ)?false:(bZ.push(bX),this.count=this.count+1,true);},arrContains:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX]))bZ=false;else b0=b0+1;return!bZ;},ExceptWith:function(bX){var bY;bY=R.Get(bX);try{while(bY.MoveNext())this.Remove(bY.Current());}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bX){var bY,bZ,b0,b1;bY=0;bZ=bM.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++)p.set(bX,b0,bZ[b0]);},IntersectWith:function(bX){var bY,bZ,b0,b1,b2;bY=new bm.New$4(bX,this.equals,this.hash);bZ=bM.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];!bY.Contains(b2)?this.Remove(b2):void 0;}},Remove:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrRemove(bX,bY)&&(this.count=this.count-1,true);},arrRemove:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX])){bY.splice.apply(bY,[b0,1]);bZ=false;}else b0=b0+1;return!bZ;},GetEnumerator:function(){return R.Get(bM.concat(this.data));},GetEnumerator0:function(){return R.Get(bM.concat(this.data));}},s,bm);bm.New$3=bT.Ctor(function(){bm.New$4.call(this,[],o.Equals,o.Hash);},bm);bm.New$4=bT.Ctor(function(bX,bY,bZ){var b0;s.New.call(this);this.equals=bY;this.hash=bZ;this.data=[];this.count=0;b0=R.Get(bX);try{while(b0.MoveNext())this.add(b0.Current());}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},bm);bm.New$2=bT.Ctor(function(bX){bm.New$4.call(this,bX,o.Equals,o.Hash);},bm);bn.get_UseAnimations=function(){return bD.UseAnimations();};bn.Play=function(bX){var bY;bY=null;return X.Delay(function(){return X.Bind(bn.Run(a.ignore,bD.Actions(bX)),function(){bD.Finalize(bX);return X.Return(null);});});};bn.Append=function(bX,bY){return{$:0,$0:bI.Append(bX.$0,bY.$0)};};bn.Run=function(bX,bY){var bZ;function b0(b1){function b2(b3,b4){var b5;b5=b4-b3;bY.Compute(b5);bX();return b5<=bZ?void a.requestAnimationFrame(function(b6){b2(b3,b6);}):b1();}a.requestAnimationFrame(function(b3){b2(b3,b3);});}bZ=bY.Duration;return bZ===0?X.Zero():X.FromContinuations(function(b1,b2,b3){return b0.apply(null,[b1,b2,b3]);});};bn.Concat=function(bX){return{$:0,$0:bI.Concat(q.map(bD.List,bX))};};bn.get_Empty=function(){return{$:0,$0:bI.Empty()};};bo.BatchUpdatesEnabled=function(){bE.$cctor();return bE.BatchUpdatesEnabled;};bp.StartProcessor=function(bX){var bY;function bZ(){var b0;b0=null;return X.Delay(function(){return X.Bind(bX,function(){var b1;b1=bY[0];return b1===1?(bY[0]=0,X.Zero()):b1===2?(bY[0]=1,bZ()):X.Zero();});});}bY=[0];return function(){var b0;b0=bY[0];b0===0?(bY[0]=1,X.Start(bZ(),null)):b0===1?bY[0]=2:void 0;};};bq=f.OperationCanceledException=bT.Class({},_7,bq);bq.New=bT.Ctor(function(bX){bq.New$1.call(this,"The operation was canceled.",null,bX);},bq);bq.New$1=bT.Ctor(function(bX,bY,bZ){this.message=bX;this.inner=bY;W.setPrototypeOf(this,bq.prototype);this.ct=bZ;},bq);br.IsUpper=function(bX){return bX>="A"&&bX<="Z";};bs.$cctor=function(){bs.$cctor=a.ignore;bs.Doc=self.document;};bt=t.Updates=bT.Class({},null,bt);bt.Create=function(bX){var bY;bY=null;bY=bt.New(bX,null,function(){var bZ;bZ=bY.s;return bZ===null?(bZ=T.Copy(bY.c()),bY.s=bZ,T.WhenObsoleteRun(bZ,function(){bY.s=null;}),bZ):bZ;});return bY;};bt.New=function(bX,bY,bZ){return new bt({c:bX,s:bY,v:bZ});};bu=bb.Pair=bT.Class({Equals:function(bX){return o.Equals(this.Key,bX.Key);},GetHashCode:function(){return o.Hash(this.Key);},CompareTo0:function(bX){return o.Compare(this.Key,bX.Key);}},null,bu);bw.New=function(bX,bY,bZ,b0){var b1;b1={DynElem:bX,DynFlags:bY,DynNodes:bZ};bT.SetOptional(b1,"OnAfterRender",b0);return b1;};bx.notPresent=function(){return g.FailWith("The given key was not present in the dictionary.");};by.convertTextNode=function(bX){var bY,bZ,b0,b1,b2,b3;bY=null;bZ=0;b1=bX.textContent;b2=new a.RegExp(_4.TextHoleRE(),"g");while(bY=b2.exec(b1),bY!==null){bX.parentNode.insertBefore(self.document.createTextNode(Q.string(b1,{$:1,$0:bZ},{$:1,$0:b2.lastIndex-p.get(bY,0).length-1})),bX);bZ=b2.lastIndex;b3=self.document.createElement("span");b3.setAttribute("ws-replace",p.get(bY,1).toLowerCase());bX.parentNode.insertBefore(b3,bX);}b2.lastIndex=0;bX.textContent=Q.string(b1,{$:1,$0:bZ},null);};by.failNotLoaded=function(bX){bU.warn("Instantiating non-loaded template",bX);};by.fillTextHole=function(bX,bY,bZ){var b0;b0=bX.querySelector("[ws-replace]");return o.Equals(b0,null)?(bU.warn("Filling non-existent text hole",bZ),null):(b0.parentNode.replaceChild(new a.Text(bY),b0),{$:1,$0:b0.getAttribute("ws-replace")});};by.removeHolesExcept=function(bX,bY){function bZ(b0){$.IterSelector(bX,"["+b0+"]",function(b1){if(!bY.Contains(b1.getAttribute(b0)))b1.removeAttribute(b0);});}bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");$.IterSelector(bX,"[ws-hole]",function(b0){if(!bY.Contains(b0.getAttribute("ws-hole"))){b0.removeAttribute("ws-hole");while(b0.hasChildNodes())b0.removeChild(b0.lastChild);}});$.IterSelector(bX,"[ws-replace]",function(b0){if(!bY.Contains(b0.getAttribute("ws-replace")))b0.parentNode.removeChild(b0);});$.IterSelector(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",P.concat(" ",p.filter(function(b1){return bY.Contains(p.get(P.SplitChars(b1,[":"],1),1));},P.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});$.IterSelector(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3,b4,b5;b1=P.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++){b4=p.get(b1,b2);b0.setAttribute(b4,(b5=new a.RegExp(_4.TextHoleRE(),"g"),b0.getAttribute(b4).replace(b5,function(b6,b7){return bY.Contains(b7)?b6:"";})));}});};by.fillInstanceAttrs=function(bX,bY){var bZ,b0,b1,b2,b3;by.convertAttrs(bY);bZ=bY.nodeName.toLowerCase();b0=bX.querySelector("[ws-attr="+bZ+"]");if(o.Equals(b0,null))bU.warn("Filling non-existent attr hole",bZ);else{b0.removeAttribute("ws-attr");for(b1=0,b2=bY.attributes.length-1;b1<=b2;b1++){b3=bY.attributes.item(b1);b3.name==="class"&&b0.hasAttribute("class")?b0.setAttribute("class",b0.getAttribute("class")+" "+b3.nodeValue):b0.setAttribute(b3.name,b3.nodeValue);}}};by.mapHoles=function(bX,bY){function bZ(b0){$.IterSelector(bX,"["+b0+"]",function(b1){var b2,b3;b2=(b3=null,[bY.TryGetValue(b1.getAttribute(b0).toLowerCase(),{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]);b2[0]?b1.setAttribute(b0,b2[1]):void 0;});}bZ("ws-hole");bZ("ws-replace");bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");$.IterSelector(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",P.concat(" ",p.map(function(b1){var b2,b3,b4;b2=P.SplitChars(b1,[":"],1);b3=(b4=null,[bY.TryGetValue(p.get(b2,1),{get:function(){return b4;},set:function(b5){b4=b5;}}),b4]);return b3[0]?p.get(b2,0)+":"+b3[1]:b1;},P.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});$.IterSelector(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3;b1=P.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++)(function(){var b4;function b5(b6,b7){var b8;b8=g.KeyValue(b7);return b6.replace(new a.RegExp("\\${"+b8[0]+"}","ig"),"${"+b8[1]+"}");}b4=p.get(b1,b2);return b0.setAttribute(b4,(((bT.Curried3(q.fold))(b5))(b0.getAttribute(b4)))(bY));}());});};by.fill=function(bX,bY,bZ){while(true)if(bX.hasChildNodes())bZ=bY.insertBefore(bX.lastChild,bZ);else return null;};by.convertAttrs=function(bX){var bZ,b0,b1,b2,b3,b4,b5,b6;function bY(b7){var b8;b8=bX.getAttribute(b7);b8===null?void 0:bX.setAttribute(b7,b8.toLowerCase());}bZ=bX.attributes;b0=[];b1=[];b2=[];for(b3=0,b4=bZ.length-1;b3<=b4;b3++){b5=bZ.item(b3);P.StartsWith(b5.nodeName,"ws-on")&&b5.nodeName!=="ws-onafterrender"&&b5.nodeName!=="ws-on"?(b0.push(b5.nodeName),b1.push(Q.string(b5.nodeName,{$:1,$0:"ws-on".length},null)+":"+b5.nodeValue.toLowerCase())):!P.StartsWith(b5.nodeName,"ws-")&&(new a.RegExp(_4.TextHoleRE())).test(b5.nodeValue)?(b5.nodeValue=(b6=new a.RegExp(_4.TextHoleRE(),"g"),b5.nodeValue.replace(b6,function(b7,b8){return"${"+b8.toLowerCase()+"}";})),b2.push(b5.nodeName)):void 0;}!(b1.length==0)?bX.setAttribute("ws-on",P.concat(" ",b1)):void 0;!(b2.length==0)?bX.setAttribute("ws-attr-holes",P.concat(" ",b2)):void 0;bY("ws-hole");bY("ws-replace");bY("ws-attr");bY("ws-onafterrender");bY("ws-var");p.iter(function(b7){bX.removeAttribute(b7);},b0);};q.insufficient=function(){return g.FailWith("The input sequence has an insufficient number of elements.");};bz=bb.KeyCollection=bT.Class({GetEnumerator$1:function(){return R.Get(q.map(function(bX){return bX.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},s,bz);bz.New=bT.Ctor(function(bX){s.New.call(this);this.d=bX;},bz);bB.New=function(bX,bY){return{PreviousNodes:bX,Top:bY};};bC.get_Empty=function(){return{$:0,$0:new bm.New$3()};};bC.FindAll=function(bX){var bY;function bZ(b1){if(b1!=null&&b1.$==0){bZ(b1.$0);bZ(b1.$1);}else if(b1!=null&&b1.$==1)b0(b1.$0);else if(b1!=null&&b1.$==2)bZ(b1.$0.Current);else if(b1!=null&&b1.$==6)p.iter(b0,b1.$0.Holes);}function b0(b1){bY.push(b1);bZ(b1.Children);}bY=[];bZ(bX);return{$:0,$0:new bm.New$2(bY)};};bC.Filter=function(bX,bY){return{$:0,$0:bL.Filter(bX,bY.$0)};};bC.Except=function(bX,bY){return{$:0,$0:bL.Except(bX.$0,bY.$0)};};bC.ToArray=function(bX){return bL.ToArray(bX.$0);};bC.Intersect=function(bX,bY){return{$:0,$0:bL.Intersect(bX.$0,bY.$0)};};bD.UseAnimations=function(){bH.$cctor();return bH.UseAnimations;};bD.Actions=function(bX){return bD.ConcatActions(p.choose(function(bY){return bY.$==1?{$:1,$0:bY.$0}:null;},bI.ToArray(bX.$0)));};bD.Finalize=function(bX){p.iter(function(bY){if(bY.$==0)bY.$0();},bI.ToArray(bX.$0));};bD.ConcatActions=function(bX){var bY,bZ,b0,b1;bY=_2.ofSeqNonCopying(bX);bZ=p.length(bY);return bZ===0?bD.Const():bZ===1?p.get(bY,0):(b0=q.max(q.map(function(b2){return b2.Duration;},bY)),(b1=p.map(function(b2){return bD.Prolong(b0,b2);},bY),bD.Def(b0,function(b2){p.iter(function(b3){b3.Compute(b2);},b1);})));};bD.List=function(bX){return bX.$0;};bD.Const=function(bX){return bD.Def(0,function(){return bX;});};bD.Def=function(bX,bY){return{Compute:bY,Duration:bX};};bD.Prolong=function(bX,bY){var bZ,b0,b1;bZ=bY.Compute;b0=bY.Duration;b1=bO.Create(function(){return bY.Compute(bY.Duration);});return{Compute:function(b2){return b2>=b0?b1.f():bZ(b2);},Duration:bX};};bE.$cctor=function(){bE.$cctor=a.ignore;bE.BatchUpdatesEnabled=true;};bF.Clear=function(bX){bX.splice(0,p.length(bX));};bG.$cctor=function(){bG.$cctor=a.ignore;bG.EmptyAttr=null;};bH.$cctor=function(){bH.$cctor=a.ignore;bH.CubicInOut=bK.Custom(function(bX){var bY;bY=bX*bX;return 3*bY-2*(bY*bX);});bH.UseAnimations=true;};bI.Append=function(bX,bY){return bX.$==0?bY:bY.$==0?bX:{$:2,$0:bX,$1:bY};};bI.ToArray=function(bX){var bY;function bZ(b0){if(b0.$==1)bY.push(b0.$0);else if(b0.$==2){bZ(b0.$0);bZ(b0.$1);}else if(b0.$==3)p.iter(function(b1){bY.push(b1);},b0.$0);}bY=[];bZ(bX);return bY.slice(0);};bI.Concat=function(bX){var bY;bY=_2.ofSeqNonCopying(bX);return _2.TreeReduce(bI.Empty(),bI.Append,bY);};bI.Empty=function(){bP.$cctor();return bP.Empty;};bJ.Enumerate=function(bX,bY){function bZ(b0,b1){var b2;while(true)if(b0==null)return b1.$==1?{$:1,$0:[b1.$0[0],[b1.$0[1],b1.$1]]}:null;else if(bX){b2=b0;b0=b2.Right;b1=new C({$:1,$0:[b2.Node,b2.Left],$1:b1});}else{b2=b0;b0=b2.Left;b1=new C({$:1,$0:[b2.Node,b2.Right],$1:b1});}}return q.unfold(function(b0){return bZ(b0[0],b0[1]);},[bY,C.Empty]);};bK=t.Easing=bT.Class({},s,bK);bK.Custom=function(bX){return new bK.New(bX);};bK.New=bT.Ctor(function(bX){s.New.call(this);this.transformTime=bX;},bK);bL.Filter=function(bX,bY){return new bm.New$2(p.filter(bX,bL.ToArray(bY)));};bL.Except=function(bX,bY){var bZ;bZ=new bm.New$2(bL.ToArray(bY));bZ.ExceptWith(bL.ToArray(bX));return bZ;};bL.ToArray=function(bX){var bY;bY=p.create(bX.get_Count(),void 0);bX.CopyTo(bY);return bY;};bL.Intersect=function(bX,bY){var bZ;bZ=new bm.New$2(bL.ToArray(bX));bZ.IntersectWith(bL.ToArray(bY));return bZ;};bM.concat=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push.apply(bY,bX[b0]);return bY;};bN.Children=function(bX,bY){var bZ,b0,b1;if(bY!=null&&bY.$==1){b1=[];bZ=bY.$0[0].nextSibling;while(bZ!==bY.$0[1]){b1.push(bZ);bZ=bZ.nextSibling;}return{$:0,$0:b1};}else return{$:0,$0:p.init(bX.childNodes.length,(b0=bX.childNodes,function(b2){return b0[b2];}))};};bN.Except=function(bX,bY){var bZ;bZ=bX.$0;return{$:0,$0:p.filter(function(b0){return p.forall(function(b1){return!(b0===b1);},bZ);},bY.$0)};};bN.Iter=function(bX,bY){p.iter(bX,bY.$0);};bN.DocChildren=function(bX){var bY;function bZ(b0){if(b0!=null&&b0.$==2)bZ(b0.$0.Current);else if(b0!=null&&b0.$==1)bY.push(b0.$0.El);else if(b0==null);else if(b0!=null&&b0.$==5)bY.push(b0.$0);else if(b0!=null&&b0.$==4)bY.push(b0.$0.Text);else if(b0!=null&&b0.$==6)p.iter(function(b1){if(b1==null||b1.constructor===W)bZ(b1);else bY.push(b1);},b0.$0.Els);else{bZ(b0.$0);bZ(b0.$1);}}bY=[];bZ(bX.Children);return{$:0,$0:_2.ofSeqNonCopying(bY)};};bO.Create=function(bX){return bR.New(false,bX,bO.forceLazy);};bO.forceLazy=function(){var bX;bX=this.v();this.c=true;this.v=bX;this.f=bO.cachedLazy;return bX;};bO.cachedLazy=function(){return this.v;};bP.$cctor=function(){bP.$cctor=a.ignore;bP.Empty={$:0};};bR.New=function(bX,bY,bZ){return{c:bX,v:bY,f:bZ};};bT.OnLoad(function(){d.main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
//# sourceMappingURL=MsalPreamble.min.map
